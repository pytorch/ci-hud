{"version":3,"sources":["Jenkins.js","AsOf.js","Summarize.js","ComputerDisplay.js","QueueDisplay.js","BuildHistoryDisplay.js","groups/index.js","groups/pytorch.js","groups/vision.js","groups/audio.js","groups/text.js","groups/pytorch-lightning.js","GitHubStatusDisplay.js","PerfHistoryDisplay.js","AuthorizeGitHub.js","utils.js","pr/TestReportRenderer.js","pr/logs.js","pr/CircleCICard.js","PrDisplay.js","JobCorrelationHeatmap.js","GitHubActionsDisplay.js","GitHubOverview.js","SevReporter.js","Links.js","App.js","index.js"],"names":["jenkins","s","url","options","a","undefined","axios","get","params","then","response","r","catch","error","data","urls","requests","map","err","all","result","this","v","AsOf","props","updateStatus","currentTime","updateTime","interval","connectedIn","timeString","Date","toLocaleTimeString","className","summarize_job","job","replace","summarize_date","timestamp","date","toLocaleDateString","toLocaleString","hour","minute","hour12","month","day","weekday","summarize_ago","today","seconds","hours","Math","floor","minutes","time","String","seconds2time","summarize_url","m","RegExp","exec","centsPerHour","osx","master","packet","rocm","centsToDollars","x","style","currency","ComputerDisplay","state","computer","update","setInterval","bind","clearInterval","setState","tree","Map","forEach","c","k","n","node","displayName","test","assignedLabels","some","l","name","classify_node","busy","total","offline","idle","set","totalCost","perCost","rows","entries","sort","kv","cost","busy_nodes","filter","executors","length","currentExecutable","b","running_rows","executable","href","running_map","task","cumulative_time","delta_ago","colSpan","Component","QueueDisplay","items","queue","why_map","q","why","summarize_why","why_rows","why_v","textAlign","paddingRight","task_map","task_rows","slice","task_v","width","textOverflow","maxWidth","overflow","size","jobs_on_pr","binary_and_smoke_tests_on_pr","is_success","is_failure","getJobName","subBuild","baseJobName","jobName","BuildHistoryDisplay","initialState","prefs_str","localStorage","getItem","prefs","JSON","parse","builds","known_jobs","showStale","username","showNotifications","Notification","permission","requestPermission","prevProps","setItem","stringify","get_github_commit_statuses","collect_known_jobs_set","compareFun","y","sx","e","startsWith","sy","topBuild","subBuilds","go","build","_class","known_jobs_set","add","add_jobs","jobs","index","commitId","job_name","github_commit_statuses","hasOwnProperty","duration","status","build_url","commit","i","changeSet","push","batch_get","request","depth","allBuilds","Set","props_mode","mode","Object","keys","endsWith","includes","found","values","sb_map","collect_jobs_from_github_status","still_unknown_set","consecutive_failure_count","sb","has","count","delete","key","body","known_jobs_head","durationScale","d3","rangeRound","domain","seen_prs","unknownCost","inProgressCost","status_cols","j","cell","dur","parse_duration","this_cost","ceil","perf_report","cellHref","link","target","alt","role","color","aria-label","is_aborted","is_pending","overlay","mouseLeaveDelay","placement","destroyTooltipOnHide","fontFamily","padding","renderPullRequestNumber","comment","match","renderCauses","defaultCause","actions","action","causes","cause","shortDescription","pull_link","pull_id","isRebuild","isPullRequest","upstreamProject","author","desc","stale","find","parameters","param","value","getPullParams","title","number","getPushedBy","reverse","msg","whenString","height","type","checked","onChange","htmlFor","backgroundColor","position","zIndex","pytorch","regex","vision","audio","text","isMobile","navigator","userAgent","array_move","arr","old_index","new_index","splice","is_skipped","is_infra_failure","computeConsecutiveFailureCount","failure_window","getJenkinsJobName","NameFilterForm","jobNameFilter","defaultValue","onSubmit","_","preventDefault","id","marginLeft","fetchedBuilds","fetchError","lastUpdateDate","showGroups","groupJobs","branch","jenkins_data","commitIdxMap","idx","buildCommitId","buildIdx","fromEntries","user","repo","jsonUrl","commits","build_map","message","headline","sha","addJenkinsResults","headers","Boolean","nameMatches","isDockerJob","isGCJob","isCIFlowShouldRunJob","isGenerateTestMatrixJob","groups","console","group","obj","assign","getGroups","jobNames","findGroup","groupIsExpanded","groupIsFailing","result_icon","visibleJobs","shouldShowJob","groupedVisibleJobsMap","groupedVisibleJobs","groupName","groupBaseIndex","findIndex","jobIndex","toggleGroup","pop","shownGroup","visibleJobsHeaders","header","icon","headerClass","onClick","onAuxClick","cursor","decoratedBuildUrl","ghaRegex","item","toLowerCase","allOk","aggregateStatus","fontWeight","keepParent","split","paddingLeft","loadingInfo","margin","lastUpdate","fontSize","objToStrMap","strMap","ROUND_PRECISION","round_float","mean","round","PerfHistoryDisplay","url_prefix","indexes","log","run","relpath","standard_benchmark","benchmark_index","benchmark","build_benchmark_mean","build_benchmark_index","prev_mean","visible_jobs","visible_jobs_head","pytorch_version","delta","colkey","prev_delta","AuthorizeGitHub","loggedin","URL","window","location","code","searchParams","errorMsg","fetch","json","token","alert","lastRedirect","removeItem","display","formatBytes","MB","toFixed","GB","parseXml","xml","arrayTags","dom","DOMParser","parseFromString","ActiveXObject","Error","async","loadXML","parseError","reason","srcText","parseNode","xmlNode","nodeName","jsonNode","existing","Array","isArray","indexOf","attributes","attribute","nodeValue","textContent","childNodes","trim","asyncAll","functions","invoked","f","Promise","github_graphql_raw","query","pat","method","Authorization","Accept","github","graphql","graphql_raw","raw","s3","prefix","bucket","URLSearchParams","delimiter","TestSuite","highlight","nodeRef","current","children","highlightElement","language","React","createRef","tcase","testcase","failure","content","join","fileinfo","file","line","Card","marginTop","Body","classname","ref","TestSummary","showDetail","toggle","iconStyle","showSuites","suiteDetail","info","filename","classes","stats","passed","totals","skipped","classStats","Title","marginBottom","cases","files","TestReportRenderer","updateFailure","toString","testReportZip","arrayBuffer","innerFilename","buf","reports","Uint8Array","inner","unzipSync","strFromU8","suites","testsuite","testsuites","suite","failures","testInfo","numErrors","errors","numFailures","getStatus","results","summary","filterLog","negativeRegexes","lines","newLog","include","registerLogLanguage","monaco","groupRanges","languages","register","setMonarchTokensProvider","tokenizer","root","editor","defineTheme","base","inherit","rules","foreground","fontStyle","registerFoldingRangeProvider","provideFoldingRanges","model","context","CircleCICard","buildMatch","targetUrl","showSteps","buildId","errorMessage","prevState","hasError","steps","step","shown","output_url","replaceAll","circle_yml","logLevel","toUpperCase","SUCCESS","FAILURE","FAILED","TIMEDOUT","NEUTRAL","CANCELLED","logText","totalLines","existingEditor","setValue","revealLine","ButtonGroup","radio","ToggleButton","variant","defaultLanguage","theme","beforeMount","scrollBeyondLastLine","lineNumbersMinChars","folding","onMount","getAction","loading","stepsElement","statusIcon","renderStatusIcon","renderLogViewer","PREVIEW_BASE_URL","getCommitQuery","hash","PrDisplay","pr_number","commit_hash","error_message","runs","checkRuns","nodes","check","databaseId","prompt","isPr","pr_result","pr","repository","pullRequest","object","history","workflow_runs","checkSuites","workflowRun","artifacts","workflow","mergeStatuses","conclusion","statuses","contexts","promises","s3_artifacts","prefixes","extractItem","ListBucketResult","prefixItem","Prefix","contents","python","cpp","runIsPassing","marginRight","paddingBottom","subject","messageHeadline","commitUrl","oid","comments","diff","login","messageBody","findDiffInComments","maxHeight","starts","ends","lineNumber","ranges","min","start","end","kind","FoldingRangeKind","Imports","isShowing","getGroupRanges","checkName","s3Artifacts","checks","testResultArtifacts","artifactsByName","artifact","Key","renderResultsButton","artifactDetails","artifactName","getArtifactName","parseInt","Size","showReport","render","element","detailsUrl","args","expired","size_in_bytes","extra","renderArtifact","counts","cards","show","isExpanded","card","Triage","run_index","renderChecks","checksData","concat","renderGitHubArtifacts","renderS3Artifacts","artifactsElement","checksElement","renderGroups","displayRuns","used","renderTitle","renderDiff","renderBody","renderDocPreviewButton","JobCorrelationHeatmap","all_jobs","passes","seen_names","correlationMatrix","addFailure","failure1","failure2","job_names","fullMatrix","name1","row","name2","cache","job_index","allSettled","correlations","correlateJobs","defaultTooltipTemplate","background","label","el","document","getElementById","innerHTML","usageStatistics","xAxis","formatter","yAxis","tooltip","template","tooltipTemplate","categories","series","Chart","heatmapChart","GitHubActionsDisplay","actions_statuses","dates","last_updated","data_series","lineChart","COLORS","BranchDisplay","repos","canvas","ctx","getContext","beginPath","colors","success","neutral","cancelled","pending","queued","unknown","fill","fillStyle","fillRect","resp","byName","jobsByName","commitStatuses","border","borderRadius","gridTemplateRows","GitHubOverview","CommonPrefixes","folders","Contents","s3ListBucket","users","flat","branches","repoName","branchMatch","branchName","flexWrap","sevs","search","issue","existingSevs","renderedSevs","sev","renderSev","Links","showMore","more","Link","to","trigger","Status","AuthorizeGithubRoute","LogoutGitHub","Redirect","Build","Build1","RouteNotFound","BuildRoute","Route","exact","path","component","Build1Route","TorchBenchRoute","App","basename","Switch","segment","ReactDOM"],"mappings":"oQA2EeA,EADC,IAnEhB,mFACE,SAAIC,GACF,MAAO,kCAAoCA,EAAI,cAFnD,kBAIE,SAAKA,GACH,MAAO,kCAAoCA,IAL/C,wDAQE,WAAUC,EAAKC,GAAf,eAAAC,EAAA,kEACkBC,IAAZF,IAAuBA,EAAU,IADvC,SAGQG,IACHC,IAAIL,EAAK,CAAEM,OAAQL,IACnBM,MAAK,SAACC,GACLC,EAAID,KAELE,OAAM,SAACC,OARZ,UAWmB,qBAANF,EAXb,yCAYWA,EAAEG,MAZb,gCAcW,MAdX,2CARF,uHA0BE,WAAgBC,EAAMZ,GAAtB,iBAAAC,EAAA,kEACkBC,IAAZF,IAAuBA,EAAU,IAEjCa,EAAWD,EAAKE,KAAI,SAACf,GACvB,OAAOI,IAAMC,IAAIL,EAAK,CAAEM,OAAQL,IAAWM,MACzC,SAACC,GAAD,MAAe,CAAEA,eACjB,SAACQ,GAAD,MAAU,CAAEA,aANlB,SAUQZ,IACHa,IAAIH,GACJP,MAAK,SAACC,GACLC,EAAID,KAELE,OAAM,SAACC,OAfZ,UAkBmB,qBAANF,EAlBb,yCAmBWA,EAAEM,KAAI,SAACG,GACZ,OAAIA,EAAOV,SACFU,EAAOV,SAASI,KAElB,SAvBb,gCA0BW,MA1BX,2CA1BF,sHAwDE,WAAeX,GAAf,SAAAC,EAAA,+EACSiB,KAAKd,IAAIc,KAAKnB,IAAI,YAAaC,IADxC,gDAxDF,iHA2DE,WAAYA,GAAZ,SAAAC,EAAA,+EACSiB,KAAKd,IAAIc,KAAKnB,IAAI,SAAUC,IADrC,gDA3DF,+GA8DE,WAAUmB,EAAGnB,GAAb,SAAAC,EAAA,+EACSiB,KAAKd,IAAIc,KAAKnB,IAAI,OAASoB,GAAInB,IADxC,gDA9DF,iE,OCAe,SAASoB,EAAKC,GAC3B,IAAMC,EACJD,EAAME,YAAcF,EAAMG,WAAaH,EAAMI,SAC3C,eAEA,eAAC,WAAD,2BAAwBJ,EAAMK,YAA9B,QAEEC,EACJN,EAAMG,WAAa,IAAII,KAAK,KAAO,EACjC,cAAC,WAAD,sBAEA,eAAC,WAAD,oBACSP,EAAMG,WAAWK,qBAD1B,KACkDP,KAGtD,OAAO,uBAAMQ,UAAWR,EAAjB,cAAiCK,EAAjC,OCjBF,SAASI,EAAcC,GAC5B,OAAOA,EACJC,QAAQ,YAAa,IACrBA,QAAQ,YAAa,IACrBA,QAAQ,aAAc,IACtBA,QAAQ,mBAAoB,IAC5BA,QAAQ,kBAAmB,IAC3BA,QAAQ,OAAQ,IAGd,SAASC,EAAeC,GAC7B,IAAMC,EAAO,IAAIR,KAAKO,GAEtB,OADc,IAAIP,MACRS,uBAAyBD,EAAKC,qBAC/BD,EAAKE,eAAe,QAAS,CAClCC,KAAM,UACNC,OAAQ,UACRC,QAAQ,IAGHL,EAAKE,eAAe,QAAS,CAClCI,MAAO,QACPC,IAAK,UACLC,QAAS,UA2BR,SAASC,EAAcV,GAC5B,IAAMC,EAAO,IAAIR,KAAKO,GAChBW,EAAQ,IAAIlB,KAClB,OAxBK,SAAsBmB,GAC3B,IAAIC,EAAQC,KAAKC,MAAMH,EAAU,MAC7BI,EAAUF,KAAKC,OAAOH,EAAkB,KAARC,GAAgB,IACpDD,EAAUA,EAAkB,KAARC,EAAyB,GAAVG,EACnC,IAAIC,EAAO,GAcX,OAZc,IAAVJ,IACFI,EAAOJ,EAAQ,KAED,IAAZG,GAA0B,KAATC,IAEnBA,IADAD,EAAUA,EAAU,IAAe,KAATC,EAAc,IAAMD,EAAUE,OAAOF,IAC7C,KAEP,KAATC,EACFA,EAAOL,EAAU,IAEjBK,GAAQL,EAAU,GAAK,IAAMA,EAAUM,OAAON,GAEzCK,EAMAE,CAAaL,KAAKC,OAAOJ,EAAQV,GAAQ,MAO3C,SAASmB,EAAcxD,GAC5B,IAAIyD,EACJ,OAGmB,QAFhBA,EAAIC,OACH,gEACAC,KAAK3D,IAEkByD,EAAE,GAVdvB,QAAQ,WAAY,IAUA,IAAMF,EAAcyB,EAAE,IAKhD,QAFNA,EAAIC,OAAO,mDAAmDC,KAC7D3D,IAGKyD,EAAE,GAEJzD,EAIF,IAAM4D,EAAe,CAC1B,YAAa,GACb,eAAgB,GAChB,YAAa,IACb,eAAgB,IAChB,iBAAkB,IAClB,mBAAoB,GACpB,UAAW,GACX,UAAW,IACXC,IAAK,MAAQ,GAAK,GAClBC,OAAQ,GACRC,OAAQ,GACRC,KAAM,EACN,SAAU,KAGL,SAASC,EAAeC,GAC7B,YAAU/D,IAAN+D,EAAwB,KAGpBA,EAAI,KAAK3B,eAAe,QAAS,CACvC4B,MAAO,WACPC,SAAU,Q,IC5FOC,E,kDACnB,WAAY/C,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACXC,SAAU,GACV/C,YAAa,IAAIK,KACjBJ,WAAY,IAAII,KAAK,GACrBF,YAAa,GANE,E,qDASnB,WACER,KAAKqD,SACLrD,KAAKO,SAAW+C,YAAYtD,KAAKqD,OAAOE,KAAKvD,MAAOA,KAAKG,MAAMI,Y,kCAEjE,WACEiD,cAAcxD,KAAKO,Y,2DAErB,8BAAAxB,EAAA,6DACQsB,EAAc,IAAIK,KACxBV,KAAKyD,SAAS,CAAEpD,YAAaA,IAF/B,SAGqB1B,EAAQyE,SAAS,CAClCM,KAAM,sZAcK3C,QAAQ,OAAQ,MAlB/B,QAGQtB,EAHR,QAoBOa,WAAa,IAAII,KACtBjB,EAAKe,YAAcf,EAAKa,WAAaD,EACrCL,KAAKyD,SAAShE,GAtBhB,gD,0EAwBA,WA8CE,IAAMG,EAAM,IAAI+D,IAChB3D,KAAKmD,MAAMC,SAASQ,SAAQ,SAACC,GAC3B,IAAMC,EA/CR,SAAuBC,GACrB,IAAMC,EAAOD,EAAEE,YACf,MAAI,mBAAmBC,KAAKF,GACnB,YAEL,oBAAoBE,KAAKF,GACpB,eAEL,oBAAoBE,KAAKF,GACvBD,EAAEI,eAAeC,MAAK,SAACC,GAAD,MAAkB,WAAXA,EAAEC,QAC1B,eAEA,YAGP,qBAAqBJ,KAAKF,GACrB,iBAEL,wBAAwBE,KAAKF,GACxB,mBAEL,gCAAgCE,KAAKF,GAChC,MAEL,+BAA+BE,KAAKF,GAC/B,UAEL,+BAA+BE,KAAKF,GAC/B,UAEL,iCAAiCE,KAAKF,GACjC,MAEL,4BAA4BE,KAAKF,GAC5B,SAEL,2BAA2BE,KAAKF,GAC3B,OAEL,yBAAyBE,KAAKF,GACzB,SAEFA,EAKGO,CAAcV,GACpB5D,EAAIL,EAAIV,IAAI4E,QACN9E,IAANiB,IAAiBA,EAAI,CAAEuE,KAAM,EAAGC,MAAO,IACtCZ,EAAEa,UACLzE,EAAEwE,QACGZ,EAAEc,MAAM1E,EAAEuE,QAEjB5E,EAAIgF,IAAId,EAAG7D,MAGb,IAAI4E,EAAY,EAChBjF,EAAIgE,SAAQ,SAAC3D,EAAG6D,GACd,IAAMgB,EAAUrC,EAAaqB,QACb9E,IAAZ8F,IACF7E,EAAE4E,UAAYC,EAAU7E,EAAEwE,MAC1BI,GAAa5E,EAAE4E,cAInB,IAAME,EAAO,YAAInF,EAAIoF,WAAWC,OAAOrF,KAAI,SAACsF,GAC1C,IAAMC,EAAOrC,EAAeoC,EAAG,GAAGL,WAClC,OACE,+BACE,6BAAKK,EAAG,KACR,+BACGA,EAAG,GAAGV,KADT,MACkBU,EAAG,GAAGT,SAExB,qBAAI7D,UAAU,SAAd,UAAwBuE,EAAxB,WALOD,EAAG,OAUVE,EAAapF,KAAKmD,MAAMC,SAASiC,QACrC,SAACxB,GAAD,OACGA,EAAEc,MACe,WAAlBd,EAAEI,aACFJ,EAAEyB,UAAUC,OAAS,GACrB1B,EAAEyB,UAAU,GAAGE,qBAEnBJ,EAAWH,MACT,SAAClG,EAAG0G,GAAJ,OACE1G,EAAEuG,UAAU,GAAGE,kBAAkBvE,UACjCwE,EAAEH,UAAU,GAAGE,kBAAkBvE,aAErC,IAAMyE,EAAeN,EAAWxF,KAAI,SAACiE,GACnC,IAAM8B,EAAa9B,EAAEyB,UAAU,GAAGE,kBAClC,OACE,+BACE,oBAAI5E,UAAU,YAAd,SAA2Be,EAAcgE,EAAW1E,aACpD,6BACE,mBAAG2E,KAAMD,EAAW9G,IAApB,SAA0BwD,EAAcsD,EAAW9G,WAH9CgF,EAAEI,gBAST4B,EAAc,IAAIlC,IAiCxB,OAhCAyB,EAAWxB,SAAQ,SAACC,GAClB,IAAM8B,EAAa9B,EAAEyB,UAAU,GAAGE,kBAC5BM,EAAOzD,EAAcsD,EAAW9G,KAClCoB,EAAI4F,EAAY3G,IAAI4G,QACd9G,IAANiB,IACFA,EAAI,CAAEwE,MAAO,EAAGsB,gBAAiB,GACjCF,EAAYjB,IAAIkB,EAAM7F,IAExBA,EAAEwE,QAOFxE,EAAE8F,iBALF,SAAmB9E,GACjB,IAAMC,EAAO,IAAIR,KAAKO,GAEtB,OADc,IAAIP,KACFQ,GAAQ,IAEL8E,CAAUL,EAAW1E,cAkB1C,gCACE,2CACY,IACV,cAACf,EAAD,CACEK,SAAUP,KAAKG,MAAMI,SACrBF,YAAaL,KAAKmD,MAAM9C,YACxBC,WAAYN,KAAKmD,MAAM7C,WACvBE,YAAaR,KAAKmD,MAAM3C,iBAG5B,gCACE,gCACE,+BACE,6BACE,kCACE,gCAAQuE,IACR,gCACE,+BACE,uBACA,qBAAInE,UAAU,SAASqF,QAAQ,IAA/B,UACGnD,EAA2B,GAAZ+B,EAAiB,IADnC,mBAOR,oBAAIjE,UAAU,aAAd,SACE,gCACE,gCAAQ8E,sB,GA/MmBQ,aCLxBC,E,kDACnB,WAAYhG,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACXiD,MAAO,GACP/F,YAAa,IAAIK,KACjBJ,WAAY,IAAII,KAAK,GACrBF,YAAa,GANE,E,qDASnB,WACER,KAAKqD,SACLrD,KAAKO,SAAW+C,YAAYtD,KAAKqD,OAAOE,KAAKvD,MAAOA,KAAKG,MAAMI,Y,kCAEjE,WACEiD,cAAcxD,KAAKO,Y,2DAErB,8BAAAxB,EAAA,6DACQsB,EAAc,IAAIK,KACxBV,KAAKyD,SAAS,CAAEpD,YAAaA,IAF/B,SAGqB1B,EAAQ0H,QAH7B,QAGQ5G,EAHR,QAIOa,WAAa,IAAII,KACtBjB,EAAKe,YAAcf,EAAKa,WAAaD,EACrCL,KAAKyD,SAAShE,GANhB,gD,0EAQA,WAkBE,IAAM6G,EAAU,IAAI3C,IACpB3D,KAAKmD,MAAMiD,MAAMxC,SAAQ,SAAC2C,GACxB,IAAMC,EAnBR,SAAuBA,GACrB,OAAOA,EACJzF,QAAQ,0CAA2C,SACnDA,QAAQ,sBAAuB,oBAC/BA,QAAQ,oBAAqB,oBAC7BA,QAAQ,uBAAwB,aAChCA,QAAQ,cAAe,iBACvBA,QAAQ,cAAe,aACvBA,QAAQ,iBAAkB,gBAC1BA,QAAQ,eAAgB,eACxBA,QAAQ,eAAgB,eACxBA,QAAQ,qBAAsB,aAC9BA,QAAQ,sBAAuB,kBAC/BA,QAAQ,gCAAiC,eACzCA,QAAQ,gCAAiC,eAKhC0F,CAAcF,EAAEC,KACxBvG,EAAIqG,EAAQpH,IAAIsH,QACVxH,IAANiB,IACFA,EAAI,CAAEwE,MAAO,GACb6B,EAAQ1B,IAAI4B,EAAKvG,IAEnBA,EAAEwE,WAGJ,IAAMiC,EAAW,YAAIJ,EAAQtB,WAAWC,OAAOrF,KAAI,SAAC+G,GAClD,IAAMH,EAAMG,EAAM,GACZ1G,EAAI0G,EAAM,GAChB,OACE,+BACE,oBAAI3D,MAAO,CAAE4D,UAAW,QAASC,aAAc,IAA/C,SAAsD5G,EAAEwE,QACxD,6BAAK+B,MAFEA,MAOPM,EAAW,IAAInD,IACrB3D,KAAKmD,MAAMiD,MAAMxC,SAAQ,SAAC2C,GACxB,IAAMT,EAAOzD,EAAckE,EAAET,KAAKjH,KAC9BoB,EAAI6G,EAAS5H,IAAI4G,QACX9G,IAANiB,IACFA,EAAI,CAAEwE,MAAO,GACbqC,EAASlC,IAAIkB,EAAM7F,IAErBA,EAAEwE,WAGJ,IACMsC,EAAY,YAAID,EAAS9B,WAC5BC,MAAK,SAAClG,EAAG0G,GAAJ,OAAUA,EAAE,GAAGhB,MAAQ1F,EAAE,GAAG0F,SACjCuC,MAAM,EAHY,IAIlBpH,KAAI,SAACqH,GACJ,IAAMnB,EAAOmB,EAAO,GACdhH,EAAIgH,EAAO,GACjB,OACE,+BACE,oBAAIjE,MAAO,CAAE4D,UAAW,QAASC,aAAc,IAA/C,SAAsD5G,EAAEwE,QACxD,6BAAKqB,MAFEA,MAOf,OACE,gCACE,uCACQ,IACN,cAAC5F,EAAD,CACEK,SAAUP,KAAKG,MAAMI,SACrBC,YAAaR,KAAKmD,MAAM3C,YACxBH,YAAaL,KAAKmD,MAAM9C,YACxBC,WAAYN,KAAKmD,MAAM7C,gBAG3B,gCACE,gCACE,+BACE,oBACE4G,MAAO,IACPlE,MAAO,CACLmE,aAAc,OACdC,SAAU,IACVC,SAAU,UALd,SAQE,gCACE,gCAAQX,QAGZ,oBAAI9F,UAAU,aAAasG,MAAO,IAAlC,SACE,gCACE,kCACGH,EACD,+BACE,uBACA,6BAAKD,EAASQ,KA/CX,GA+CiC,MAAQ,6B,GA3HxBpB,a,yCCQtCqB,EAAa,CACf,IACA,QACA,oCACA,2CACA,mCACA,8BAEA,+BACA,wCACA,uCACA,oCACA,iDAEA,6BACA,2CACA,mCACA,4CACA,4CACA,4CACA,gCACA,0CACA,kDAEA,+CACA,6CACA,kDACA,gCAEA,iCACA,+BACA,0BACA,yCACA,gEACA,uEACA,kCACA,iCAEA,kDAEA,wCAEA,0BACA,wBAGEC,EAA+B,CACjC,qDACA,sDACA,+CACA,mCACA,mCACA,sCACA,oDACA,qDACA,8CACA,oEACA,mEACA,yEACA,yEAKF,SAASC,EAAW1H,GAClB,MAAkB,YAAXA,GAAmC,YAAXA,EAGjC,SAAS2H,EAAW3H,GAElB,MACa,YAAXA,GACW,YAAXA,GACW,UAAXA,GACW,cAAXA,EAYJ,SAAS4H,EAAWC,GAClB,IAAMC,EAAcD,EAASE,QAC7B,MAAI,gBAAgB5D,KAAK0D,EAAS/I,KACzB,UAAYgJ,EAEZA,E,IAgDUE,E,kDACnB,WAAY5H,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,EAAK6E,eAFD,E,gDAInB,WACE,IAAMC,EAAYC,aAAaC,QAAQ,SACnCC,EAAQ,GAOZ,OANIH,IACFG,EAAQC,KAAKC,MAAML,IAEf,cAAeG,IAAQA,EAAK,WAAgB,GAC5C,aAAcA,IAAQA,EAAK,SAAe,IAC1C,sBAAuBA,IAAQA,EAAK,mBAAwB,GAC3D,CACLG,OAAQ,GACRC,WAAY,GACZnI,YAAa,IAAIK,KACjBJ,WAAY,IAAII,KAAK,GACrB+H,UAAWL,EAAMK,UACjBC,SAAUN,EAAMM,SAChBC,kBAAmBP,EAAMO,qB,+BAG7B,WACE3I,KAAKqD,SACLrD,KAAKO,SAAW+C,YAAYtD,KAAKqD,OAAOE,KAAKvD,MAAOA,KAAKG,MAAMI,UAC3DP,KAAKmD,MAAMwF,mBAAiD,YAA5BC,aAAaC,YAC/CD,aAAaE,sB,gCAGjB,SAAmBC,GACjBb,aAAac,QACX,QACAX,KAAKY,UAAU,CACbN,kBAAmB3I,KAAKmD,MAAMwF,kBAC9BF,UAAWzI,KAAKmD,MAAMsF,UACtBC,SAAU1I,KAAKmD,MAAMuF,YAGrB1I,KAAKG,MAAMW,MAAQiI,EAAUjI,MAC/Bd,KAAKyD,SAASzD,KAAKgI,gBACnBhI,KAAKqD,Y,2DAGT,qBAkDiB6F,EAlDjB,IA8FWC,EA9FX,EAmJWC,EAnJX,gBAAArK,EAAA,6DAmJWqK,EAnJX,SAmJsBrG,EAAGsG,GACrB,IAAMC,EAAK/B,EAAWnD,MAAK,SAACmF,GAAD,OAAO1I,EAAckC,GAAGyG,WAAWD,MACxDE,EAAKlC,EAAWnD,MAAK,SAACmF,GAAD,OAAO1I,EAAcwI,GAAGG,WAAWD,MAC9D,OAAID,EAAKG,EAAW,EACXH,EAAKG,GACL1G,EAAIsG,GADa,EAEjBtG,EAAIsG,EAAU,EACX,GA5DLF,EA9FX,SA8FkCO,GAY9BA,EAASC,UAAU/F,SAXnB,SAASgG,EAAGhC,GAERA,EAASiC,OAEP,qDADFjC,EAASiC,MAAMC,OAGflC,EAASiC,MAAMF,UAAU/F,QAAQgG,GAEjCG,EAAeC,IAAIrC,EAAWC,QAvGtC,oCAAA7I,EAAA,MAkDE,qBAIWkL,EAJX,mBAAAlL,EAAA,sDAIWkL,EAJX,SAIoBC,EAAMC,GACtB,IAAIC,EAAWzK,EAASwK,GAAOC,SAC/B,GAAIF,EACF,IAAK,IAAIG,KAAYH,EAAM,CACzB,IAAIpJ,EAAMoJ,EAAKG,GACVC,EAAuBF,GAAUG,eAAeF,KACnDC,EAAuBF,GAAUC,GAAY,CAC3CG,SAAU,IACVzK,OAAQe,EAAI2J,OACZ5L,IAAKiC,EAAI4J,cAZfJ,EAAyB,GACzB3K,EAAW,GAFjB,cAoBuBF,EAAK8I,QApB5B,IAoBE,2BACE,IADSoC,EAAuB,QACvBC,EAAI,EAAGA,EAAID,EAAOE,UAAUzE,MAAMb,OAAQqF,IAC7CR,EAAWO,EAAOE,UAAUzE,MAAMwE,GAAGR,SACpCE,EAAuBC,eAAeH,KACzCE,EAAuBF,GAAY,IAErCzK,EAASmL,KAAK,CACZjM,IACE,sDACAuL,EACA,QACFA,aA/BR,8CAmCsBzL,EAAQoM,UAC1BpL,EAASC,KAAI,SAACoL,GAAD,OAAaA,EAAQnM,QApCtC,qBAsCU+E,QAAQqG,GAtClB,kBAuCSK,GAvCT,6CAlDF,uBAkDiBpB,EAlDjB,2CACQ7I,EAAc,IAAIK,KACxBV,KAAKyD,SAAS,CAAEpD,YAAaA,IAF/B,SAaiB1B,EAAQmC,IAAId,KAAKG,MAAMW,IAAK,CACvC4C,KAAM,usBAoBI3C,QAAQ,OAAQ,MAlChC,OAaItB,EAbJ,sCAwCkB,EAxClB,UAyCiBd,EAAQmC,IAAId,KAAKG,MAAMW,IAAK,CAAEmK,MAD7B,IAxClB,QAyCIxL,EAzCJ,sBA2CEA,EAAKa,WAAa,IAAII,KACtBjB,EAAKe,YAAcf,EAAKa,WAAaD,OACdrB,IAAnBS,EAAKyL,YACPzL,EAAK8I,OAAS9I,EAAKyL,WA9CvB,UA2FsChC,IA3FtC,QA2FEzJ,EAAK6K,uBA3FP,OA6FQP,EAAiB,IAAIoB,IAgBR,YADbC,EAAapL,KAAKG,MAAMkL,OAE5B5L,EAAK8I,OAAO3E,QAAQuF,GAGlB1J,EAAK6K,wBACPgB,OAAOC,KAAK9L,EAAK6K,wBAAwB1G,SAAQ,SAAU+G,GACzD,IAAIT,EAAOzK,EAAK6K,uBAAuBK,GACvCW,OAAOC,KAAKrB,GAAMtG,SAAQ,SAAUyG,GAClC,GAAmB,WAAfe,EAAyB,CAE3B,IAAK,IAAIR,EAAI,EAAGA,EAAIpD,EAA6BjC,OAAQqF,IACvD,GAAIP,EAASmB,SAAShE,EAA6BoD,IAAK,CACtDb,EAAeC,IAAI,IAAMK,GACzB,MAIAA,EAASoB,SAAS,YAAcpB,EAASoB,SAAS,WAGpD1B,EAAeC,IAAI,IAAMK,QAG3B,GAAIA,EAASoB,SAAS,YAAcpB,EAASoB,SAAS,UAAW,CAE/D,IADA,IAAIC,GAAQ,EACHd,EAAI,EAAGA,EAAIpD,EAA6BjC,OAAQqF,IACvD,GAAIP,EAASmB,SAAShE,EAA6BoD,IAAK,CACtDc,GAAQ,EACR,MAGCA,GAAO3B,EAAeC,IAAI,IAAMK,UAgB/C5K,EAAK+I,WAAa,YAAIuB,EAAe4B,UAAU1G,KAAKmE,GAEpD3J,EAAK8I,OAAO3E,SAAQ,SAACiG,GACnB,IAAM+B,EAAS,IAAIjI,IADU,4CAqB7B,WAA+CkG,GAA/C,iBAAA9K,EAAA,sDACE,GAAI8K,EAAMgB,UAAUzE,MAAMb,OAAS,EACjC,IADqC,EAAD,WAElC,IAAI6E,EAAWP,EAAMgB,UAAUzE,MAAMwE,GAAGR,SACpC3K,EAAK6K,wBACPgB,OAAOC,KAAK9L,EAAK6K,uBAAuBF,IAAWxG,SACjD,SAAUyG,GACR,IAAIvJ,EAAMrB,EAAK6K,uBAAuBF,GAAUC,GAChDuB,EAAOhH,IAAI,IAAMyF,EAAU,CACzBG,SAAU1J,EAAI0J,SACdzK,OAAQe,EAAIf,OACZlB,IAAKiC,EAAIjC,UATV+L,EAAI,EAAGA,EAAIf,EAAMgB,UAAUzE,MAAMb,OAAQqF,IAAM,IAF5D,4CArB6B,sBAkBhBf,EAFFF,UAAU/F,SAXnB,SAASgG,EAAGhC,GAERA,EAASiC,OAEP,qDADFjC,EAASiC,MAAMC,OAGflC,EAASiC,MAAMF,UAAU/F,QAAQgG,GAEjCgC,EAAOhH,IAAI+C,EAAWC,GAAWA,MAbV,oCAwC7BiE,CAAgChC,GAChCA,EAAM+B,OAASA,KAaM,GACnB5L,KAAKG,MAAMW,IAAI2K,SAAS,WAAY,WACtC,IAAMK,EAAoB,IAAIX,IACxBY,EAA4B,IAAIpI,IACtClE,EAAK+I,WAAW5E,SAAQ,SAAC9C,GACX,qBAARA,GACQ,YAARA,IACAA,EAAI2K,SAAS,cACjBK,EAAkB9B,IAAIlJ,OAExB,IAAK,IAAI8J,EAAI,EAAGA,EAAInL,EAAK8I,OAAOhD,UAG1BqF,EAbe,KAcdkB,EAAkBxE,KAJesD,IAAK,CAK7BnL,EAAK8I,OAAOqC,GACLgB,OACdhI,SAAQ,SAACoI,EAAIlE,GAClB,GAAKgE,EAAkBG,IAAInE,GAEpB,GAAIJ,EAAWsE,EAAGjM,QAAS,CAChC,IAAImM,EAAQH,EAA0B7M,IAAI4I,IAAY,EACtDoE,IACAH,EAA0BnH,IAAIkD,EAASoE,QAC9BzE,EAAWuE,EAAGjM,SACvB+L,EAAkBK,OAAOrE,YAM/BiE,EAA0BnI,SAAQ,SAAC3D,EAAG6D,GAEhC7D,GAAK,GACP8L,EAA0BI,OAAOrI,MAIrCrE,EAAKsM,0BAA4BA,EAK7B,EAAK5I,MAAM4I,2BACb,EAAK5I,MAAM4I,0BAA0BnI,SAAQ,SAAC3D,EAAGmM,GAC1CL,EAA0BE,IAAIG,IAEjC,IAAIxD,aAAa,UAAO,EAAKzI,MAAMW,IAAK,CACtCuL,KAAMxL,EAAcuL,QAK5BL,EAA0BnI,SAAQ,SAAC3D,EAAGmM,GAGlC,EAAKjJ,MAAM4I,4BACV,EAAK5I,MAAM4I,0BAA0BE,IAAIG,IAG1C,IAAIxD,aAAa,UAAO,EAAKzI,MAAMW,IAAK,CACtCuL,KAAMxL,EAAcuL,QA5DY,GAmExCpM,KAAKyD,SAAShE,GAxRhB,iD,0EA2RA,WAAU,IAAD,OAiDP,IAAI8I,EAASvI,KAAKmD,MAAMoF,OACpBwD,EAA4B/L,KAAKmD,MAAM4I,0BAErCvD,EAAaxI,KAAKmD,MAAMqF,WACxB8D,EAAkB9D,EAAW5I,KAAI,SAACkI,GAAD,OACrC,oBAAIlH,UAAU,SAAd,SACE,sBACEA,WACG2G,EAAWnD,MAAK,SAACmF,GAAD,OAAO1I,EAAciH,GAAS0B,WAAWD,MACtD,YACA,sBACJ,KACCwC,EAA0BE,IAAInE,GAAW,iBAAmB,IANjE,UASGP,EAAWnD,MAAK,SAACmF,GAAD,OAAO1I,EAAciH,GAAS0B,WAAWD,MACtD,GACA,UACH1I,EAAciH,OAbSA,MAuBxByE,EAAgBC,gBAAiBC,WAAW,CAAC,EAF7B,MAGtBF,EAAcG,OAAO,CAAC,EAAGF,MAAOjE,GAAQ,SAAC9C,GAAD,OAAOA,EAAE+E,cAEjD,IAAMmC,EAAW,IAAIxB,IAEfpG,EAAOwD,EAAO3I,KAAI,SAACiK,GACvB,IAAM+B,EAAS/B,EAAM+B,OAkBrB,IAAIzG,EAAO,EACPyH,GAAc,EACdC,GAAiB,EACjBnB,GAAQ,EAENoB,EAActE,EAAW5I,KAAI,SAACkI,GAClC,IA1GiB/H,EArXKgN,EA+dhBf,EAAKJ,EAAO1M,IAAI4I,GAClBkF,EAAO,cAAC,WAAD,IACX,QAAWhO,IAAPgN,EAAkB,CACpBN,GAAQ,EACR,IAAMuB,EAAMC,IAAelB,EAAGxB,UAExBxG,EApeJ,yBADkB+I,EAqecpF,EAAWqE,IAne5C,YACQ,aAANe,EACF,YACE,OAAO7I,KAAK6I,GACjB,QAAQ7I,KAAK6I,IAAM,QAAQ7I,KAAK6I,GAC3B,UAEA,UAEA,SAAS7I,KAAK6I,GAChB,MAEP,SAAS7I,KAAK6I,IACd,UAAU7I,KAAK6I,IACf,UAAU7I,KAAK6I,IACf,UAAU7I,KAAK6I,GAEX,OAAO7I,KAAK6I,GACV,iBAAiB7I,KAAK6I,GACjB,iBACE,QAAQ7I,KAAK6I,GACf,YAEA,YAEA,QAAQ7I,KAAK6I,GAClB,QAAQ7I,KAAK6I,GACR,OAEA,eAGF,YAGJ,UAicKI,EAAY,EAQhB,GAPa,YAATnJ,EACF4I,GAAc,EAEdO,EAAYpL,KAAKqL,KAAM3K,EAAauB,GAAQiJ,EAAO,IAAO,GAAK,IAEjE9H,GAAQgI,EACHnB,EAAGjM,SAAQ8M,GAAiB,GACT,SAApB,EAAK1M,MAAMkL,KACb2B,EAtCN,SAAqBhB,EAAIjM,GACvB,OACE,eAAC,WAAD,WACE,sBACEa,UACE6G,EAAW1H,GAAU,cAAgB,mBAFzC,SAKGmN,IAAelB,EAAGxB,UAAY,MANnC,cAoCS6C,CAAYrB,EAAIA,EAAGjM,aACrB,GAAwB,SAApB,EAAKI,MAAMkL,KACpB2B,EACE,eAAC,WAAD,WACY,YAAThJ,EAAqB,IAAMmJ,EAD9B,kBAIG,CACL,IAAIG,EAAWtB,EAAGnN,IACd,eAAeqF,KAAKoJ,GAClBA,EAAS7B,SAAS,aACpB6B,GAAsB,YAGxBA,EAAW3O,EAAQ4O,KAAKD,EAAW,YAErCN,EACE,mBACEpH,KAAM0H,EACN1M,UAAU,OACV4M,OAAO,SACPC,IAAK9F,EAAWqE,GAJlB,UA3IWjM,EAiJIiM,EAAGjM,OAhJtB0H,EAAW1H,GAEX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,SAAWC,aAAW,SAAvD,eAIAlG,EAAW3H,GAEX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,OAASC,aAAW,SAArD,eA/YV,SAAoB7N,GAClB,MAAkB,YAAXA,GAAmC,cAAXA,EAkZvB8N,CAAW9N,GAEX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,QAAUC,aAAW,YAAtD,eAjZV,SAAoB7N,GAClB,OAAQA,GAAqB,YAAXA,EAoZV+N,CAAW/N,GAEX,sBACEa,UAAU,kBACV8M,KAAK,MACL1K,MAAO,CAAE2K,MAAO,aAChBC,aAAW,cAJb,eASG7N,MAwHL,OACE,cAAC,IAAD,CAEEgO,QAASjG,EACTkG,gBAAiB,EACjBC,UAAU,WACVC,sBAAsB,EALxB,SAOE,oBAEEtN,UAAU,YACVoC,MAAO,CACL4D,UAAW,QACXuH,WAAY,aACZC,QAAS,GANb,SASGpB,GARIlF,IAPFA,MAyBX,SAASuG,EAAwBC,GAC/B,IAAIhM,EAAIgM,EAAQC,MAAM,cACtB,OAAIjM,EAEA,cAAC,WAAD,UACE,oBACEsD,KAAM,2CAA6CtD,EAAE,GACrDkL,OAAO,SAFT,cAIIlL,EAAE,QAKL,cAAC,WAAD,IAsBT,SAASkM,EAAa3D,GACpB,IAAM4D,EAAe,6DACrB,YAA0BzP,IAAtB6L,EAAU6D,QAA8BD,EACrC5D,EAAU6D,QACdrJ,QAAO,SAACsJ,GAAD,YAA8B3P,IAAlB2P,EAAOC,UAC1BhP,KAAI,SAAC+O,EAAQ/D,GAAT,OACH+D,EAAOC,OAAOhP,KAAI,SAACiP,EAAOjE,GAAR,OAChB,+BAAaiE,EAAMC,iBAAnB,OAASlE,SA0CjB,IAoBImE,EACAC,EArBEC,EAAYpF,EAAM6E,QAAQtK,MAC9B,SAACuK,GAAD,YACoB3P,IAAlB2P,EAAOC,QACPD,EAAOC,OAAOxK,MACZ,SAACyK,GAAD,MAA4B,0CAAjBA,EAAM/E,aAGjBoF,EAAgBrF,EAAM6E,QAAQtK,MAClC,SAACuK,GAAD,YACoB3P,IAAlB2P,EAAOC,QACPD,EAAOC,OAAOxK,MACZ,SAACyK,GAAD,MACmB,2CAAjBA,EAAM/E,QACY,qCAAjB+E,EAAM/E,QACL,iBAAiB5F,KAAK2K,EAAMM,uBAIlCC,EAAS,GACTC,EAAO,GAMPC,GAAQ,EACZ,GAAIL,EACFI,EAAOb,EAAa3E,QACf,GAAIqF,EAAe,CACxB,IAAM/P,EAlDR,SAAuB0K,GACrB,IAAI8E,EAAS9E,EAAM6E,QAAQa,MACzB,SAACZ,GAAD,MAEE,sDADAA,EAAO7E,UAUX,YAPe9K,IAAX2P,IACFA,EAAS9E,EAAM6E,QAAQa,MACrB,SAACZ,GAAD,MAEE,gEADAA,EAAO7E,gBAIE9K,IAAX2P,EACK,IAAIhL,IAEN,IAAIA,IACTgL,EAAOa,WAAW5P,KAAI,SAAC6P,GAAD,MAAW,CAACA,EAAMnL,KAAMmL,EAAMC,WAiCvCC,CAAc9F,GACvB+F,EAAQzQ,EAAOD,IAAI,kBAKzB,GAJA6P,EAAY5P,EAAOD,IAAI,iBACvB8P,EAAU7P,EAAOD,IAAI,eACrBkQ,EAASjQ,EAAOD,IAAI,wBACpBmQ,EAAOO,EACHjD,EAASV,IAAI+C,GAAU,CAEzB,IAAK,EAAK7L,MAAMsF,UAAW,OAAO,cAAC,WAAD,GAAeoB,EAAMgG,QACvDP,GAAQ,EAEV,GAA4B,KAAxB,EAAKnM,MAAMuF,UAAmB,EAAKvF,MAAMuF,WAAa0G,EACxD,OAAO,cAAC,WAAD,GAAevF,EAAMgG,QAE9BlD,EAAS3C,IAAIgF,OACR,CACL,IAAMnE,EAAYhB,EAAMgB,UAGxBuE,EArFF,SAAqBvF,GACnB,IAAM8E,EAAS9E,EAAM6E,QAAQa,MAC3B,SAACZ,GAAD,MAA8B,6BAAlBA,EAAO7E,UAErB,QAAe9K,IAAX2P,EAAsB,MAAO,YACjC,IAAME,EAAQF,EAAOC,OAAOW,MAC1B,SAACV,GAAD,MAA4B,0CAAjBA,EAAM/E,UAEnB,QAAc9K,IAAV6P,EAAqB,MAAO,GAChC,IAAMN,EAAQM,EAAMC,iBAAiBP,MACnC,kCAEF,OAAc,OAAVA,EAAuBM,EAAMC,iBAC1BP,EAAM,GAwEJuB,CAAYjG,GAEnBwF,EAD6B,IAA3BxE,EAAUzE,MAAMb,OACXiJ,EAAa3E,GAEbgB,EAAUzE,MAAMY,QAAQ+I,UAAUnQ,KAxH7C,SAAsB+K,GACpB,OACE,gCACG0D,EAAwB1D,EAAO2D,SAAU,KAxBxB0B,EAyBFrF,EAAOqF,IAxBpBA,EAAIjP,QAAQ,cAAe,KAwBD,IAC7B,+BACE,mBACE6E,KACE,6CAA+C+E,EAAOP,SAExDoD,OAAO,SAJT,SAMG7C,EAAOP,SAASpD,MAAM,EAAG,SAVtB2D,EAAOP,UAvBrB,IAAwB4F,KAiJxB,IAAMC,EAAajP,EAAe6I,EAAM5I,WAExC,OAAKyK,EAKH,qBAAuB9K,UAAW0O,EAAQ,QAAU,GAApD,UACE,oBAAI1O,UAAU,YAAd,SACE,mBAAGgF,KAAMiE,EAAMhL,IAAK2O,OAAO,SAA3B,SACG3D,EAAMgG,WAGX,oBAAIjP,UAAU,YAAd,SACE,mBAAGgF,KAAMmJ,EAAWvB,OAAO,SAA3B,SACGwB,EAAU,IAAMA,EAAU,OAG/B,oBAAIpO,UAAU,YAAd,SAA2BqP,IAC1BnD,EACD,oBAAIlM,UAAU,wBAAd,SACGmB,KAAKC,MAAM6H,EAAMW,SAAW,IAAO,MAEtC,6BACE,qBAAKtD,MA5QS,IA4QagJ,OA3QZ,GA2Qf,SACE,sBACEtP,UAAU,MACVmC,EAAE,IACFsG,EAAE,IACFnC,MAAOqF,EAAc1C,EAAMW,UAC3B0F,OAjRW,SAqRjB,qBAAItP,UAAU,aAAaoC,MAAO,CAAE4D,UAAW,SAA/C,UACGiG,EAAiB,UAAO,GACxB/J,EAAeqC,GACfyH,EAAc,IAAM,MAEvB,oBAAIhM,UAAU,aAAd,SAA4BwO,IAC5B,oBAAIxO,UAAU,aAAd,SAA4ByO,MAjCrBxF,EAAMgG,QAJR,cAAC,WAAD,OA0CX,OACE,gCACE,+BACE,mBAAGjK,KAAMjH,EAAQ4O,KAAK,OAASvN,KAAKG,MAAMW,KAAM0M,OAAO,SAAvD,SACGxN,KAAKG,MAAMW,MACT,IAHP,UAIU,IACR,cAACZ,EAAD,CACEK,SAAUP,KAAKG,MAAMI,SACrBC,YAAaR,KAAKmD,MAAM3C,YACxBH,YAAaL,KAAKmD,MAAM9C,YACxBC,WAAYN,KAAKmD,MAAM7C,gBAG3B,qBAAK0C,MAAO,CAAE2K,MAAO,QAArB,6DAGA,8BACE,qBAAI/M,UAAU,OAAd,UACE,+BACE,uBACEuP,KAAK,WACL7L,KAAK,aACL8L,QAASpQ,KAAKmD,MAAMsF,UACpB4H,SAAU,SAAC9G,GACT,EAAK9F,SAAS,CAAEgF,UAAWc,EAAEiE,OAAO4C,aAGxC,uBAAOE,QAAQ,aAAf,yCAEF,+BACE,uBACEH,KAAK,OACL7L,KAAK,WACLoL,MAAO1P,KAAKmD,MAAMuF,SAClB2H,SAAU,SAAC9G,GACT,EAAK9F,SAAS,CAAEiF,SAAUa,EAAEiE,OAAOkC,WAGvC,uBACEY,QAAQ,WACRtN,MAAO,CACLuN,gBAAiB,QACjBC,SAAU,WACVC,OAAQ,GALZ,gDAWF,+BACE,uBACEN,KAAK,WACL7L,KAAK,qBACL8L,QAASpQ,KAAKmD,MAAMwF,kBACpB0H,SAAU,SAAC9G,GAAD,OACR,EAAK9F,SAAS,CAAEkF,kBAAmBY,EAAEiE,OAAO4C,aAGhD,wBAAOE,QAAQ,qBAAf,iDAE+B,WAA5B1H,aAAaC,WACZ,eAAC,WAAD,WACG,IACD,sFAKF,cAMV,wBAAOjI,UAAU,oBAAjB,UACE,gCACE,+BACE,oBAAIA,UAAU,YAAd,gBACA,oBAAIA,UAAU,YAAd,iBACA,oBAAIA,UAAU,YAAd,kBACC0L,EACD,oBAAI1L,UAAU,aAAaqF,QAAQ,IAAnC,2BAGA,oBAAIrF,UAAU,aAAd,kBACA,oBAAIA,UAAU,aAAd,kBACA,oBAAIA,UAAU,aAAd,8BAGJ,gCAAQmE,c,GA9wB+BmB,aCvJ3CtG,EAAM,CACV8Q,QCPoB,CACpB,CACEC,MAAO,OACPrM,KAAM,aAER,CACEqM,MAAO,qEACPrM,KAAM,iBAER,CACEqM,MAAO,wCACPrM,KAAM,wBAER,CACEqM,MACE,mKACFrM,KAAM,4BAER,CACEqM,MACE,uIACFrM,KAAM,UAER,CACEqM,MAAO,kCACPrM,KAAM,0BAER,CACEqM,MAAO,6BACPrM,KAAM,iCAER,CACEqM,MAAO,6BACPrM,KAAM,4BAER,CACEqM,MACE,4HACFrM,KAAM,YAER,CACEqM,MACE,2HACFrM,KAAM,QAER,CACEqM,MAAO,iEACPrM,KAAM,gEAER,CACEqM,MAAO,0DACPrM,KAAM,yDAER,CACEqM,MAAO,+DACPrM,KAAM,8DAER,CACEqM,MACE,sIACFrM,KAAM,4DAER,CACEqM,MAAO,sDACPrM,KAAM,2DAER,CACEqM,MAAO,wDACPrM,KAAM,uDAER,CACEqM,MAAO,sDACPrM,KAAM,qDAER,CACEqM,MAAO,sDACPrM,KAAM,qDAER,CACEqM,MAAO,iDACPrM,KAAM,gDAER,CACEqM,MAAO,yCACPrM,KAAM,wCAER,CACEqM,MAAO,mDACPrM,KAAM,kDAER,CACEqM,MAAO,8BACPrM,KAAM,6BAER,CACEqM,MAAO,8BACPrM,KAAM,6BAER,CACEqM,MAAO,gCACPrM,KAAM,+BAER,CACEqM,MAAO,0DACPrM,KAAM,SDhGRsM,OERoB,CACpB,CACED,MAAO,yBACPrM,KAAM,qBAER,CACEqM,MAAO,6BACPrM,KAAM,yBAER,CACEqM,MAAO,6BACPrM,KAAM,yBAER,CACEqM,MAAO,2BACPrM,KAAM,wBFNRuM,MGToB,CACpB,CACEF,MAAO,yBACPrM,KAAM,qBAER,CACEqM,MAAO,6BACPrM,KAAM,yBAER,CACEqM,MAAO,6BACPrM,KAAM,yBAER,CACEqM,MAAO,2BACPrM,KAAM,uBAER,CACEqM,MAAO,qCACPrM,KAAM,iCAER,CACEqM,MAAO,qCACPrM,KAAM,iCAER,CACEqM,MAAO,mCACPrM,KAAM,gCHjBRwM,KIVoB,CACpB,CACEH,MAAO,yBACPrM,KAAM,qBAER,CACEqM,MAAO,6BACPrM,KAAM,yBAER,CACEqM,MAAO,6BACPrM,KAAM,yBAER,CACEqM,MAAO,2BACPrM,KAAM,uBAER,CACEqM,MAAO,qCACPrM,KAAM,iCAER,CACEqM,MAAO,qCACPrM,KAAM,iCAER,CACEqM,MAAO,mCACPrM,KAAM,gCJhBR,oBKXoB,CACpB,CACEqM,MAAO,iBACPrM,KAAM,kBAER,CACEqM,MAAO,0BACPrM,KAAM,qB,+BCYV,SAASyM,IACP,MAAO,iEAAiE7M,KACtE8M,UAAUC,WAId,SAASC,EAAWC,EAAKC,EAAWC,GAClC,KAAOD,EAAY,GACjBA,GAAaD,EAAI5L,OAEnB,KAAO8L,EAAY,GACjBA,GAAaF,EAAI5L,OAEnB,GAAI8L,GAAaF,EAAI5L,OAEnB,IADA,IAAIzB,EAAIuN,EAAYF,EAAI5L,OAAS,EAC1BzB,KACLqN,EAAIrG,UAAK9L,GAGbmS,EAAIG,OAAOD,EAAW,EAAGF,EAAIG,OAAOF,EAAW,GAAG,IAGpD,SAAS3J,EAAW1H,GAClB,MAAkB,YAAXA,GAAmC,YAAXA,EAGjC,SAAS2H,EAAW3H,GAElB,MACa,YAAXA,GACW,YAAXA,GACW,UAAXA,GACW,cAAXA,EAIJ,SAAS8N,EAAW9N,GAClB,MAAkB,YAAXA,GAAmC,cAAXA,EAGjC,SAAS+N,EAAW/N,GAClB,OAAQA,GAAqB,YAAXA,EAGpB,SAASwR,EAAWxR,GAClB,MAAkB,YAAXA,EAGT,SAASyR,EAAiBzR,GACxB,MAAkB,wBAAXA,EAWT,SAAS0R,EAA+BhS,GAA4B,IAAtBiS,EAAqB,uDAAJ,GACvD5F,EAAoB,IAAIX,IACxBY,EAA4B,IAAIpI,IACtClE,EAAK+I,WAAW5E,SAAQ,SAAC9C,GACX,qBAARA,GACQ,YAARA,IACAA,EAAI2K,SAAS,cACjBK,EAAkB9B,IAAIlJ,OAExB,IAAK,IAAI8J,EAAI,EAAGA,EAAInL,EAAK8I,OAAOhD,UAG1BqF,EAAI8G,IACH5F,EAAkBxE,KAJesD,IAAK,CAK3C,IAAMf,EAAQpK,EAAK8I,OAAOqC,GACpBgB,EAAS/B,EAAM+B,OACrBA,EAAOhI,SAAQ,SAACoI,EAAIlE,GAClB,GAAKgE,EAAkBG,IAAInE,GAEpB,GAAIJ,EAAWsE,EAAGvB,QAAS,CAChC,IAAIyB,EAAQH,EAA0B7M,IAAI4I,IAAY,EACtDoE,IACAH,EAA0BnH,IAAIkD,EAASoE,QAC9BzE,EAAWuE,EAAGvB,SACvBqB,EAAkBK,OAAOrE,YAY/B,OANAiE,EAA0BnI,SAAQ,SAAC3D,EAAG6D,GAEhC7D,GAAK,GACP8L,EAA0BI,OAAOrI,MAG9BiI,EAGT,SAAS4F,EAAkB/J,GACzB,IAAMC,EAAcD,EAASE,QAC7B,MAAI,gBAAgB5D,KAAK0D,EAAS/I,KACzB,mBAAqBgJ,EAErB,YAAcA,E,IAInB+J,E,kDACJ,WAAYzR,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACX0O,cAAe1R,EAAM2R,cAAgB,GACrCC,SAAU5R,EAAM4R,UAAa,SAACC,MAJf,E,0CAOnB,WAAU,IAAD,OACP,OACE,uBACED,SAAU,SAACxI,GACTA,EAAE0I,iBACF,EAAK9O,MAAM4O,SAAS,EAAK5O,MAAM0O,gBAHnC,UAME,uBAAOvB,QAAQ,kBAAf,8BACA,uBACEH,KAAK,QACL7L,KAAK,kBACL4N,GAAG,kBACHxC,MAAO1P,KAAKmD,MAAM0O,cAClBxB,SAAU,SAAC9G,GACT,EAAK9F,SAAS,CAAEoO,cAAetI,EAAEiE,OAAOkC,WAG5C,uBAAO1M,MAAO,CAAEmP,WAAY,OAAShC,KAAK,SAAST,MAAM,c,GA1BpCxJ,aAgCR6B,G,kDACnB,WAAY5H,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,EAAK6E,eAFD,E,gDAInB,WACE,IAAMC,EAAYC,aAAaC,QAAQ,UACnCC,EAAQ,GACRH,IACFG,EAAQC,KAAKC,MAAML,IAEf,sBAAuBG,IAC3BA,EAAK,mBAAyB2I,KAC1B,cAAe3I,IAAQA,EAAK,WAAgB,GAClD,IAAIyJ,EAAgB7R,KAAKG,MAAM0R,eAAiB,GAChD,MAAO,CACLO,eAAe,EACfC,YAAY,EACZ9J,OAAQ,GACR+J,eAAgB,KAChB9J,WAAY,GACZ+J,WAAY,GACZlS,YAAa,IAAIK,KACjBJ,WAAY,IAAII,KAAK,GACrBiI,kBAAmBP,EAAMO,kBACzB6J,UAAoC,IAAzBX,EAActM,QAAe6C,EAAMoK,UAC9CX,cAAeA,K,+BAGnB,WACE7R,KAAKqD,SACLrD,KAAKO,SAAW+C,YAAYtD,KAAKqD,OAAOE,KAAKvD,MAAOA,KAAKG,MAAMI,WAE5DwQ,KACD/Q,KAAKmD,MAAMwF,mBACiB,YAA5BC,aAAaC,YAEbD,aAAaE,sB,gCAGjB,SAAmBC,GACjBb,aAAac,QACX,SACAX,KAAKY,UAAU,CACbN,kBAAmB3I,KAAKmD,MAAMwF,kBAC9B6J,UAAWxS,KAAKmD,MAAMqP,aAGtBxS,KAAKG,MAAMsS,SAAW1J,EAAU0J,SAClCzS,KAAKyD,SAASzD,KAAKgI,gBACnBhI,KAAKqD,Y,sEAGT,WAAwBkF,GAAxB,iBAAAxJ,EAAA,sEAU2BJ,EAAQmC,IAAR,kBAAuBd,KAAKG,MAAMsS,QAAU,CACnE/O,KAAM,+pBAoBI3C,QAAQ,OAAQ,MA/B9B,OAUM2R,EAVN,OAmCQC,EAAe,IAAIhP,IACzB4E,EAAO3E,SAAQ,SAACiG,EAAO+I,GACrBD,EAAa9I,EAAMqI,IAAMU,KAIvBF,GACFA,EAAanK,OAAO3E,SAAQ,SAAC8F,GAC3B,GAAwC,IAApCA,EAASmB,UAAUzE,MAAMb,OAA7B,CAGA,IAAMsN,EAAgBnJ,EAASmB,UAAUzE,MAAM,GAAGgE,SAClD,GAAMyI,KAAiBF,EAAvB,CAGA,IAAMG,EAAWH,EAAaE,GAkB9BnJ,EAASC,UAAU/F,SAjBnB,SAASgG,EAAGhC,GAERA,EAASiC,OAEP,qDADFjC,EAASiC,MAAMC,OAGflC,EAASiC,MAAMF,UAAU/F,QAAQgG,GAEjCrB,EAAOuK,GAAUlH,OAAOhH,IACtB+M,EAAkB/J,GAClB0D,OAAOyH,YAAY,CACjB,CAAC,SAAUnL,EAAS7H,QACpB,CAAC,YAAapB,EAAQ4O,KAAK3F,EAAS/I,IAAM,wBA/DxD,gD,kHAwEA,mEAAAE,EAAA,6DACQsB,EAAc,IAAIK,KACxBV,KAAKyD,SAAS,CAAEpD,YAAaA,IAEvBoS,EAASzS,KAAKG,MAAMsS,OACpBO,EAAOhT,KAAKG,MAAM6S,KAClBC,EAAOjT,KAAKG,MAAM8S,KAClBC,EAPR,uDAOkEF,EAPlE,YAO0EC,EAP1E,YAOkFR,EAAO1R,QACrF,IACA,KATJ,SAWMoS,EAAU,KAXhB,mBAaoBlU,IAAMC,IAAIgU,GAb9B,QAaIC,EAbJ,gEAeInT,KAAKyD,SAAS,CAAE4O,YAAY,IAfhC,2BAoBQ9J,EAAS,GApBjB,cAqBuB4K,EAAQ1T,MArB/B,IAqBE,2BAAmC,CAAxBkL,EAAwB,QAC3ByI,EAAY,IAAIzP,IADW,cAEfgH,EAAOT,MAFQ,IAEjC,2BAAWpJ,EAAoB,QAEd,aADX2J,EAAS3J,EAAI2J,UAEfA,EAAS,WAEI,WAAXA,IACFA,EAAS,WAEX2I,EAAUxO,IAAI9D,EAAIwD,KAAM,CACtBoG,UAAW5J,EAAIjC,IACf4L,OAAQA,IAZqB,8BAejClC,EAAOuC,KAAK,CACVsE,OAAQ,CACN1G,SAAUiC,EAAOyE,QAEnBiE,QAAS1I,EAAO2I,SAAW,KAAO3I,EAAO0B,KACzCT,OAAQwH,EACRlB,GAAIvH,EAAO4I,IACXtS,UAAW0J,EAAOzJ,KAClBrC,IAAI,sBAAD,OAAwBmB,KAAKG,MAAM6S,KAAnC,YAA2ChT,KAAKG,MAAM8S,KAAtD,mBAAqEtI,EAAO4I,QA5CrF,iCAgD0B,YAApBvT,KAAKG,MAAM8S,MAAiC,WAAXR,EAhDvC,kCAiDUzS,KAAKwT,kBAAkBjL,GAjDjC,SAoDQ9I,EAAO,IAERa,WAAa,IAAII,KACtBjB,EAAK6S,eAAiB,IAAI5R,KAAKyS,EAAQM,QAAQ,kBAC/ChU,EAAK2S,eAAgB,EACrB3S,EAAKe,YAAcf,EAAKa,WAAaD,EAE/B0J,EAAiB,IAAIoB,IAC3B5C,EAAO3E,SAAQ,SAACiG,GACdA,EAAM+B,OAAOhI,SAAQ,SAACoI,EAAI3B,GACxBN,EAAeC,IAAIK,SAIvB5K,EAAK+I,WAAa,YAAIuB,EAAe4B,UAAU1G,OAC/CxF,EAAK8I,OAASA,EAYU,YAApBvI,KAAKG,MAAM8S,OACbxT,EAAKsM,0BAA4B0F,EAA+BhS,GAK3DsR,MACC/Q,KAAKmD,MAAM4I,2BACb/L,KAAKmD,MAAM4I,0BAA0BnI,SAAQ,SAAC3D,EAAGmM,GAC1C3M,EAAKsM,0BAA0BE,IAAIG,IAEtC,IAAIxD,aAAa,UAAO,EAAKzI,MAAMW,IAAK,CACtCuL,KAAMxL,EAAcuL,QAK5B3M,EAAKsM,0BAA0BnI,SAAQ,SAAC3D,EAAGmM,GAGvC,EAAKjJ,MAAM4I,4BACV,EAAK5I,MAAM4I,0BAA0BE,IAAIG,IAG1C,IAAIxD,aAAa,UAAO,EAAKzI,MAAMW,IAAK,CACtCuL,KAAMxL,EAAcuL,UAO9BpM,KAAKyD,SAAShE,GA/GhB,0D,+EAkHA,SAAY6E,EAAMe,GAChB,GAAIf,EAAKmH,SAASpG,GAChB,OAAO,EAKT,IACE,IAAMsL,EAAQ,IAAIpO,OAAO8C,GACzB,OAAOqO,QAAQpP,EAAKiK,MAAMoC,IAC1B,SACA,OAAO,K,2BAIX,SAAcrM,GACZ,IAAMuN,EAAgB7R,KAAKmD,MAAM0O,cACjC,GAAIA,EAActM,OAAS,IAAMvF,KAAK2T,YAAYrP,EAAMuN,GACtD,OAAO,EAET,IAAM+B,EAActP,EAAKkF,WAAW,uBAC9BqK,EAAUvP,EAAKkF,WAAW,uBAC1BsK,EAAuBxP,EAAKkH,SAAS,qBACrCuI,EAA0BzP,EAAKkH,SAAS,wBAC9C,QACEoI,GACS,YAATtP,GACAuP,GACAC,GACAC,K,oBAIJ,WAAU,IAAD,SAEHC,ENnaO,SAAmBf,GAChC,IAAMlT,EAAS,GACf,IAAKH,EAAIqT,GAEP,OADAgB,QAAQzU,MAAR,6BAAoCyT,IAC7B,GAJ6B,oBAOlBrT,EAAIqT,IAPc,IAOtC,2BAA+B,CAAC,IAArBiB,EAAoB,QACzBC,EAAM,GACV7I,OAAO8I,OAAOD,EAAKD,GACnBnU,EAAO+K,KAAKqJ,IAVwB,8BAatC,OAAOpU,EMsZQsU,CAAUrU,KAAKG,MAAM8S,MAF3B,cAIae,GAJb,IAIP,2BAA4B,SACpBM,SAAW,IALZ,gCAQFtU,KAAKmD,MAAMqP,YACdwB,EAAS,IAGX,IAAMO,EAAY,SAACzM,GAAa,IAAD,gBACTkM,GADS,IAC7B,2BAA4B,CAAC,IAAlBE,EAAiB,QAC1B,GAAIpM,EAAQyG,MAAM2F,EAAMvD,OACtB,OAAOuD,GAHkB,gCAM7B,OAAO,MAGHM,EAAkB,SAACN,GAAW,IAAD,gBACR,EAAK/Q,MAAMoP,YADH,IACjC,2BAAgD,CAC9C,GAD8C,QAC/BjO,OAAS4P,EAAM5P,KAC5B,OAAO,GAHsB,gCAMjC,OAAO,GAGHmQ,EAAiB,SAACP,GAAW,IAAD,gBACVA,EAAMI,UADI,IAChC,2BAAsC,CAAC,IAA5BxM,EAA2B,QACpC,GACE,EAAK3E,MAAM4I,2BACX,EAAK5I,MAAM4I,0BAA0BE,IAAInE,GAEzC,OAAO,GANqB,gCAUhC,OAAO,GAGT,SAAS4M,EAAY3U,GACnB,OAAI0H,EAAW1H,GAEX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,SAAWC,aAAW,SAAvD,eAIA2D,EAAWxR,GAEX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,QAAUC,aAAW,UAAtD,eAIAlG,EAAW3H,GAEX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,OAASC,aAAW,SAArD,eAIAC,EAAW9N,GAEX,sBACE2N,KAAK,MACL1K,MAAO,CAAEmP,WAAY,OAAQxE,MAAO,QACpCC,aAAW,YAHb,SAKE,cAAC,IAAD,MAGFE,EAAW/N,GAEX,sBACEa,UAAU,kBACV8M,KAAK,MACL1K,MAAO,CAAE2K,MAAO,aAChBC,aAAW,cAJb,eASA4D,EAAiBzR,GAEjB,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,QAAUC,aAAW,SAAtD,eAIG7N,EAGT,IA5FO,EA4FHwI,EAASvI,KAAKmD,MAAMoF,OACpBwD,EAA4B/L,KAAKmD,MAAM4I,0BAErC4I,EAAc3U,KAAKmD,MAAMqF,WAAWnD,QAAO,SAACf,GAAD,OAC/C,EAAKsQ,cAActQ,MAhGd,cAmGSqQ,GAnGT,IAmGP,2BAA6B,SAClB,MApGJ,gCAwGP,IAxGO,EAwGDE,EAAwB,GAxGvB,cAyGeF,GAzGf,IAyGP,2BAAmC,CAAC,IAAzB7M,EAAwB,QAC7BoM,EAAQK,EAAUzM,IAEjBoM,GAASM,EAAgBN,GAE5BA,EAAQ,CACN5P,KAAMwD,EACNwM,SAAU,CAACxM,IAGboM,EAAMI,SAASxJ,KAAKhD,GAEtB+M,EAAsBX,EAAM5P,MAAQ4P,GArH/B,gCAyHP,IAAIY,EAAqB,GACzB,IAAK,IAAMC,KAAaF,EACtBC,EAAmBhK,KAAK,CACtBxG,KAAMyQ,EACNb,MAAOW,EAAsBE,KA7H1B,oBAiIa/U,KAAKmD,MAAMoP,YAjIxB,IAiIP,2BAA2C,CAAC,IAAjC2B,EAAgC,QAEzCY,EAAmBhK,KAAK,CACtBxG,KAAM4P,EAAM5P,KACZ4P,MAAOA,KArIJ,gCA0IPY,EAAmB7P,MAAK,SAAClG,EAAG0G,GAC1B,OAAI1G,EAAEuF,KAAOmB,EAAEnB,MACL,EAENvF,EAAEuF,KAAOmB,EAAEnB,KACN,EAEF,KAjJF,oBAsJatE,KAAKmD,MAAMoP,YAtJxB,yBAsJI2B,EAtJJ,QAuJDc,EAAiBF,EAAmBG,WACtC,SAACnU,GAAD,OAASA,EAAIwD,MAAQ4P,EAAM5P,QAE7B,GAAuB,OAAnB0Q,EAEF,OADAf,QAAQzU,MAAR,+BAAsC0U,EAAM5P,OAC5C,WA5JG,oBA+JiB4P,EAAMI,UA/JvB,yBA+JMxM,EA/JN,QAgKCoN,EAAWJ,EAAmBG,WAChC,SAACnU,GAAD,OAASA,EAAIwD,MAAQwD,KAEvB,GAAiB,OAAboN,EAEF,OADAjB,QAAQzU,MAAR,wBAA+BsI,EAA/B,qBAAmDoM,EAAM5P,OACzD,WAGA4M,EAAW4D,EAAoBI,EAD7BA,EAAWF,EAC4BA,EAEAA,EAAiB,IAX9D,2BAAsC,IA/JjC,kCAsJP,2BAA2C,IAtJpC,gCA8LP,IAfA,IAAMG,EAAc,SAACjB,GACnB,IAAI3B,EAAa,EAAKpP,MAAMoP,WAExBiC,EAAgBN,GAElB3B,EAAW6C,IACT7C,EAAW0C,WAAU,SAACI,GAAD,OAAgBA,EAAW/Q,OAAS4P,EAAM5P,SAGjEiO,EAAWzH,KAAKoJ,GAElB,EAAKzQ,SAAS,CAAE8O,WAAYA,KAGxB+C,EAAqB,GAC3B,MAAmBR,EAAnB,eAAuC,CAAlC,IAAMrV,EAAI,KACTqI,EAAUrI,EAAK6E,KACgB,IAA/B7E,EAAKyU,MAAMI,SAAS/O,SACtBuC,EAAUrI,EAAKyU,MAAMI,SAAS,IAEhC,IAAIiB,EACF,oBAAI3U,UAAU,SAAd,SACE,qBACEA,UACEmL,GACAA,EAA0BE,IAAInE,GAC1B,iBACA,GALR,SAQGjH,EAAciH,MATSA,GAc1BrI,EAAKyU,MAAMI,SAAS/O,OAAS,GAAI,WACnC,IAAM2O,EAAQzU,EAAKyU,MACfsB,EAAO,cAAC,IAAD,IAEPhB,EAAgBN,KAClBsB,EAAO,cAAC,IAAD,KAGT,IAAIC,EAAc,GACdhB,EAAeP,KACjBuB,EAAc,gBAGhBF,EACE,oBAAI3U,UAAU,SAAd,SACE,sBACE8U,QAAS,WACPP,EAAYjB,IAEdyB,WAAY,WACVR,EAAYjB,IAEdlR,MAAO,CAAE4S,OAAQ,WAPnB,UASE,sBAAM5S,MAAO,CAAE2K,MAAO,WAAtB,oBACA,sBAAM/M,UAAW6U,EAAjB,SAA+BvB,EAAM5P,OAVvC,IAUqDkR,MAX3B1N,GAdK,GA8BrCwN,EAAmBxK,KAAKyK,GAgD1B,IAAMM,EAAoB,SAAChX,GAEzB,IAAMiX,EAAW,IAAIvT,OACnB,uBACE,EAAKpC,MAAM6S,KACX,IACA,EAAK7S,MAAM8S,KACX,eAEJ,OAAIpU,EAAI0P,MAAMuH,GACLjX,EAAM,0BAERA,GAET0J,EAAO3E,SAAQ,SAACiG,GACdA,EAAM+B,OAAOhI,SAAQ,SAACmS,GAChBA,EAAKtL,SACPsL,EAAKtL,OAASsL,EAAKtL,OAAOuL,qBAIhC,IAAMjR,EAAOwD,EAAO3I,KAAI,SAACiK,GACvB,IACM+B,EAAS/B,EAAM+B,OAEfkB,EAAcgI,EAAmBlV,KAAI,SAACH,GAC1C,IAAIuN,EAAO,cAAC,WAAD,IACPlF,EAAUrI,EAAK6E,KAEnB,GAAI7E,EAAKyU,MAAMI,SAAS/O,OAAS,EAAG,CAElCuC,EAAO,iBAAarI,EAAKyU,MAAM5P,MAC/B,IAGMmG,EAhFZ,SAAyBP,GASvB,GAAmB,IADnBA,EAAOA,EAAK7E,QAAO,SAACtC,GAAD,YAAa/D,IAAN+D,MACjBwC,OAEP,OAAO,KAXoB,oBAcX2E,GAdW,IAc7B,2BAAwB,CAAC,IAAdpJ,EAAa,QACtB,GAAI4G,EAAW5G,EAAI2J,SAAW+G,EAAiB1Q,EAAI2J,QACjD,MAAO,WAhBkB,oDAoBXP,GApBW,IAoB7B,2BACE,GAAI4D,EADkB,QACHrD,QACjB,MAAO,UAtBkB,gCA0B7B,IA1B6B,EA0BzBwL,GAAQ,EA1BiB,cA2BX/L,GA3BW,IA2B7B,2BAAwB,CAAC,IAAdpJ,EAAa,QAGlB2G,EAAW3G,EAAI2J,SACf8G,EAAWzQ,EAAI2J,SACfoD,EAAW/M,EAAI2J,UAGjBwL,GAAQ,IAnCiB,gCAsC7B,OAAIA,EACK,UAGF,UAsCYC,CAHFzW,EAAKyU,MAAMI,SAAS1U,KAAI,SAACkI,GAAD,OACnC8D,EAAO1M,IAAI4I,OAGT2C,IACFuC,EACE,qBACEpM,UAAU,eACVoC,MAAO,CACLmT,WAAY,QAEdT,QAAS,WACPP,EAAY1V,EAAKyU,QAEnByB,WAAY,WACVR,EAAY1V,EAAKyU,QATrB,SAYGQ,EAAYjK,MAGT,OAEL,CAE8B,IAA/BhL,EAAKyU,MAAMI,SAAS/O,SACtBuC,EAAUrI,EAAKyU,MAAMI,SAAS,IAEhC,IAAMtI,EAAKJ,EAAO1M,IAAI4I,QACX9I,IAAPgN,KACM,EACRgB,EACE,qBAAKpM,UAAU,eAAf,SACE,mBACEgF,KAAMiQ,EAAkB7J,EAAGtB,WAC3B9J,UAAU,OACV4M,OAAO,SACPC,IAAK3F,EAJP,SAMG4M,EAAY1I,EAAGvB,aAO1B,OACE,cAAC,IAAD,CAEEsD,QAASjG,EACTkG,gBAAiB,EACjBC,UAAU,WACVC,qBAAsB,CAAEkI,YAAY,GALtC,SAOE,oBAAkBxV,UAAU,YAA5B,SACGoM,GADMlF,IANJA,MAiBX,IAJwBkI,EAoCpBZ,EAASvF,EAAMuF,OAAO1G,SAEpB2G,EACJ,gCACE,oBACErM,MAAO,CAAE2K,MAAO,WAChB/H,KAAI,kBAAa,EAAKzF,MAAM6S,KAAxB,YAAgC,EAAK7S,MAAM8S,KAA3C,YAAmDpJ,EAAMqI,IAF/D,WAxCoBlC,EA4CFnG,EAAMwJ,QA3CnBrD,EAAIjP,QAAQ,cAAe,KA2CCsV,MAAM,MAAM,GAAI,OAEjD,+BACE,mBACEzQ,KAAI,6BAAwB,EAAKzF,MAAM6S,KAAnC,YAA2C,EAAK7S,MAAM8S,KAAtD,mBAAqEpJ,EAAMqI,IAC/E1E,OAAO,SAFT,SAIG3D,EAAMqI,GAAGlL,MAAM,EAAG,SAZf6C,EAAMqI,IAuBZjC,EAAajP,EAAe6I,EAAM5I,WAOxC,OACE,qBAAmBL,UAA6B,GAAhD,UACE,oBAAIA,UAAU,YAAYgP,MAAO/F,EAAM5I,UAAvC,SACGgP,IAEFnD,EACD,oBACElM,UAAU,aACVoC,MAAO,CACLoE,SAAU,MACVD,aAAc,WACdE,SAAU,UALd,SAQG+H,IAEH,oBACExO,UAAU,aACVoC,MAAO,CAAEsT,YAAa,IAAKzP,aAAc,OAF3C,SAjF4B,SAACyH,GAC/B,IAAIhM,EAAIgM,EAAQC,MAAM,cACtB,OAAIjM,IAYJA,EAAIgM,EAAQC,MACV,wDAXE,cAAC,WAAD,UACE,oBACE3I,KAAI,6BAAwB,EAAKzF,MAAM6S,KAAnC,YAA2C,EAAK7S,MAAM8S,KAAtD,iBAAmE3Q,EAAE,IACzEkL,OAAO,SAFT,cAIIlL,EAAE,QAoBL,cAAC,WAAD,IAwDF+L,CAAwBxE,EAAMwJ,WAEjC,6BAAKhE,MArBExF,EAAMqI,OA0BfqE,GAAc,KACdvW,KAAKmD,MAAMkP,WACbkE,GACE,kHAEiB,IACf,mBAAG3Q,KAAK,gFAAR,mCAKK5F,KAAKmD,MAAMiP,eAAgC,GAAfrN,EAAKQ,OAC1CgR,GAAc,+DACJvW,KAAKmD,MAAMiP,gBACrBmE,GACE,qBAAKvT,MAAO,CAAEwT,OAAQ,QAAtB,SACE,cAAC,IAAD,CAAY5V,UAAU,iBAK5B,IAAI6V,GAAa,KASjB,OARIzW,KAAKmD,MAAMmP,iBACbmE,GACE,oBAAGzT,MAAO,CAAE0T,SAAU,SAAtB,0BACgB1W,KAAKmD,MAAMmP,eAAelR,qBAM5C,gCACE,+BACE,oBACEwE,KAAI,6BAAwB5F,KAAKG,MAAM6S,KAAnC,YAA2ChT,KAAKG,MAAM8S,KAAtD,oBAAsEjT,KAAKG,MAAMsS,QADvF,UAGGzS,KAAKG,MAAM6S,KAHd,IAGqBhT,KAAKG,MAAM8S,KAHhC,IAGuCjT,KAAKG,MAAMsS,UAC7C,IALP,aAMa,OAEZgE,GACD,8BACE,qBAAI7V,UAAU,OAAd,UACGmQ,IAAa,KACZ,+BACE,uBACEZ,KAAK,WACL7L,KAAK,qBACL8L,QAASpQ,KAAKmD,MAAMwF,kBACpB0H,SAAU,SAAC9G,GAAD,OACR,EAAK9F,SAAS,CAAEkF,kBAAmBY,EAAEiE,OAAO4C,aAGhD,wBAAOE,QAAQ,qBAAf,iDAEGtQ,KAAKmD,MAAMwF,mBACZC,cAC4B,WAA5BA,aAAaC,WACX,eAAC,WAAD,WACG,IACD,sFAKF,SAKPkI,IAAa,KAAO,uBACrB,+BACE,uBACEZ,KAAK,WACL7L,KAAK,aACL8L,QAASpQ,KAAKmD,MAAMqP,UACpBnC,SAAU,SAAC9G,GAAD,OAAO,EAAK9F,SAAS,CAAE+O,UAAWjJ,EAAEiE,OAAO4C,aAEvD,uBAAOE,QAAQ,aAAf,mCAEF,6BACE,cAAC,EAAD,CACEyB,SAAU,SAAC1M,GACT,EAAK5B,SAAS,CAAEoO,cAAexM,KAEjCyM,aAAc9R,KAAKG,MAAM0R,uBAKhC9M,EAAKQ,OAAS,EACb,wBAAO3E,UAAU,oBAAjB,UACE,gCACE,+BACE,oBAAIA,UAAU,YAAd,kBACC0U,EACD,oBAAI1U,UAAU,aAAd,kBACA,oBAAIA,UAAU,aAAd,iBACA,oBAAIA,UAAU,aAAd,8BAGJ,gCAAQmE,OAER,KAEHwR,U,GAt1BwCrQ,aCtJjD,SAASyQ,GAAYxC,GAEnB,IADA,IAAIyC,EAAS,IAAIjT,IACjB,MAAc2H,OAAOC,KAAK4I,GAA1B,eAAgC,CAA3B,IAAIrQ,EAAC,KACR8S,EAAOhS,IAAId,EAAGqQ,EAAIrQ,IAEpB,OAAO8S,EAIT,IACMC,GAAkB,IAExB,SAASC,GAAYC,GACnB,OAAOhV,KAAKiV,MAAMD,EAAOF,IAAmBA,G,IAGzBI,G,kDACnB,WAAY9W,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,EAAK6E,eAFD,E,gDAInB,WACE,MAAO,CACLO,OAAQ,GACRC,WAAY,GACZqJ,cAAe,M,+BAGnB,WACE7R,KAAKqD,W,gCAEP,SAAmB0F,M,2DACnB,8CAAAhK,EAAA,6DACQmY,EACJ,+DAFJ,SAIwBjY,IAAMC,IAAN,UAAagY,EAAb,gBAJxB,cAIQC,EAJR,OAKElD,QAAQmD,IAAID,EAAQ1X,MACdE,EAAWwX,EAAQ1X,KAAKG,IAAb,uCAAiB,WAAOyX,GAAP,eAAAtY,EAAA,+EAEdE,IAAMC,IAAN,UAAagY,EAAb,YAA2BG,EAAItX,OAAOuX,UAFxB,OAExBhY,EAFwB,OAG9B+X,EAAIzL,OAAS+K,GAAYrX,EAAEG,MAHG,gDAK9B4X,EAAIzL,OAAS,IAAIjI,IALa,iCAOzB0T,GAPyB,yDAAjB,uDANnB,SAeuBpY,IAAMa,IAAIH,GAfjC,OA8BE,IAfM4I,EAfR,OAgBQwB,EAAiB,IAAIoB,IAErBoM,EAAqBhP,EAAO,GAAGqD,OAAO1M,IAAI,cAC1CsY,EAAkB,IAAI7T,IAE5B4T,EAAmB3T,SAAQ,SAAC6T,EAAWtN,GACrCJ,EAAeC,IAAIyN,EAAS,MAC5BD,EAAgB5S,IAAI6S,EAAS,KAAUtN,MAEzC8J,QAAQmD,IAAIrN,GAzBd,WA8BWa,GACQrC,EAAOqC,GAAGgB,OAElB1M,IAAI,cAAc0E,SAAQ,SAAC6T,GAChC,IAAMC,EAAuBD,EAAS,MAAT,KACvBE,EAAwBH,EAAgBtY,IAAIuY,EAAS,MAC3D,GAAU,IAAN7M,EACF6M,EAAS,MAAT,UAAkCC,MAC7B,CACL,IAAME,EACJrP,EAAOqC,EAAI,GAAGgB,OAAO1M,IAAI,cAAcyY,GAAvC,WAGFF,EAAS,MAAT,UAAkCG,OAb/BhN,EAAI,EAAGA,EAAIrC,EAAOhD,OAAQqF,IAAM,EAAhCA,GAkBTrC,EAAOwH,WAEDtQ,EAAO,IACR+I,WAAa,YAAIuB,EAAe4B,UAAU1G,OAC/CxF,EAAK+X,gBAAkBA,EACvB/X,EAAK8I,OAASA,EACdvI,KAAKyD,SAAShE,GAtDhB,iD,iFAyDA,SAAc6E,GACZ,IAAMuN,EAAgB7R,KAAKmD,MAAM0O,cACjC,QAAIA,EAActM,OAAS,IAAMjB,EAAKmH,SAASoG,M,oBAMjD,WAAU,IAAD,OAsCP,IAAItJ,EAASvI,KAAKmD,MAAMoF,OAClBsP,EAAe7X,KAAKmD,MAAMqF,WAAWnD,QAAO,SAACf,GAAD,OAChD,EAAKsQ,cAActQ,MAEfwT,EAAoBD,EAAajY,KAAI,SAACkI,GAAD,OACzC,oBAAIlH,UAAU,SAAuBsG,MAAM,QAA3C,SACE,8BAAMY,KADoBA,MAIxB0P,EAAkBxX,KAAKmD,MAAMqU,gBAE7BzS,EAAOwD,EAAO3I,KAAI,SAACiK,GACvB,IAAM+B,EAAS/B,EAAM+B,OACfmM,EACJlO,EAAM+B,OAAO1M,IAAI,gBAAjB,gBACI4N,EAAc+K,EAAajY,KAAI,SAACkI,GACpC,IArDiBkQ,EAqDXhM,EAAKJ,EAAO1M,IAAI,cAAcsY,EAAgBtY,IAAI4I,IAClDmQ,EAASF,EAAkB,IAAMjQ,EACnCkF,EAAO,cAAC,WAAD,IACLkL,GACHlM,EAAE,MAAF,KAAsBA,EAAE,MAAF,WACvBA,EAAE,MAAF,UAIF,YAHWhN,IAAPgN,IACFgB,EA3CN,SAAqBjN,GACnB,OAAiBA,GARF,GAUX,sBAAM2N,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,SAAWC,aAAW,SAAvD,gBAPiBoK,EAWHjY,EAVXiY,EAvGK,GAmHR,sBAAMtK,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,OAASC,aAAW,SAArD,eAKF,sBAAMF,KAAK,MAAM1K,MAAO,CAAE2K,MAAO,QAAUC,aAAW,SAAtD,gBAlBJ,IAAuBoK,EA+CVtD,CAAYwD,IAGnB,cAAC,IAAD,CAEEnK,QACEjG,EACA,UACAgP,GAAY9K,EAAE,MAAF,MACZ,gBACA8K,GAAY9K,EAAE,MAAF,WACZ,aAvEWgM,EAwECE,GAvEpBF,EAAQjW,KAAKiV,MAAc,IAARgB,GAAiB,MACvB,IACXA,EAAQ,IAAMA,GAEhBA,GAAS,KAqEHhK,gBAAiB,EACjBC,UAAU,WACVC,sBAAsB,EAbxB,SAeE,qBAEEtN,UAAU,YACVoC,MAAO,CACL4D,UAAW,QACXuH,WAAY,aACZC,QAAS,GANb,UASG,IACApB,EAAM,MATFiL,IAfFnQ,MA8BX,OACE,+BACE,qBAAIlH,UAAU,YAAd,oBAAkCmX,EAAlC,OACCjL,IAFMiL,MAMb,OACE,gCACE,sEACA,8BACE,oBAAInX,UAAU,WAEhB,wBAAOA,UAAU,mBAAjB,UACE,gCACE,+BACE,oBAAIA,UAAU,YAAd,mBACCkX,OAGL,gCAAQ/S,c,GApM8BmB,a,oCChB3BiS,G,kDACnB,WAAYhY,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACXiV,WAAYlQ,aAAaC,QAAQ,WAHlB,E,qDAMnB,WACEnI,KAAKqD,W,2DAGP,oCAAAtE,EAAA,yDACMF,EAAM,IAAIwZ,IAAIC,OAAOC,SAAS3S,MAC9B4S,EAAO3Z,EAAI4Z,aAAavZ,IAAI,QAFlC,wDAMEc,KAAKmD,MAAMqV,KAAOA,EACdE,EAAW,0DAPjB,SAQqBC,MAAM,GAAD,OArBR,2BAqBQ,yBAAgCH,IACrDpZ,MAAK,SAACE,GAAD,OAAOA,EAAEsZ,UACdrZ,OAAM,SAACC,GAGN,OAFAkZ,EACE,sDAAwDlZ,EACnD,CAAEqZ,MAAO,SAbtB,QAQM9Y,EARN,QAec8Y,OAGV3Q,aAAac,QAAQ,SAAUjJ,EAAO8Y,OACtC7Y,KAAKmD,MAAMiV,UAAW,GAHtBU,MAAMJ,GAKR1Y,KAAKyD,SAASzD,KAAKmD,QAIb4V,EAAe7Q,aAAaC,QAAQ,oBAExCD,aAAa8Q,WAAW,iBACpBD,GAAgBT,OAAOC,SAAS3S,OAClC0S,OAAOC,SAAS3S,KAAOmT,IA7B7B,iD,0EAkCA,WAEE,OADsB7Q,aAAaC,QAAQ,UAGvC,qBAAKnF,MAAO,CAAEiW,QAAS,UAAvB,SACE,mBAAGrT,KAAK,iBAAR,uBAID5F,KAAKmD,MAAMqV,KAUd,8BACE,6CATA,sBAAKxV,MAAO,CAAEiW,QAAS,UAAvB,UACE,mBAAGrT,KAAK,4FAAR,oBAEK,W,GA3D8BM,a,4BCRtC,SAASgT,GAAY5R,GAC1B,IAAKA,EACH,MAAO,IAGT,GAAIA,EADO,KAET,OAAOA,EAAO,MAEhB,IAAM6R,EAAK,IACX,GAAI7R,EAAO6R,EACT,OAAQ7R,EANC,MAMU8R,QAAQ,GAAK,MAElC,IAAMC,EAAK,IACX,OAAI/R,EAAO+R,GACD/R,EAAO6R,GAAIC,QAAQ,GAAK,OAE1B9R,EAAO+R,GAAID,QAAQ,GAAK,MAI3B,SAASE,GAASC,EAAKC,GAC5B,IAAIC,EAAM,KACV,GAAInB,OAAOoB,UAAWD,GAAM,IAAIC,WAAYC,gBAAgBJ,EAAK,gBAC5D,KAAIjB,OAAOsB,cAKT,MAAM,IAAIC,MAAM,4BAFrB,IAFAJ,EAAM,IAAIG,cAAc,qBACpBE,OAAQ,GACPL,EAAIM,QAAQR,GACf,MAAME,EAAIO,WAAWC,OAAS,IAAMR,EAAIO,WAAWE,QAGvD,SAASC,EAAUC,EAASra,GAC1B,GAAwB,SAApBqa,EAAQC,SAAZ,CAMA,IAAIC,EAAW,GACbC,EAAWxa,EAAOqa,EAAQC,UAW5B,GAVIE,EACGC,MAAMC,QAAQF,GAEdxa,EAAOqa,EAAQC,UAAUvP,KAAKwP,GADjCva,EAAOqa,EAAQC,UAAY,CAACE,EAAUD,GAGpCd,IAAqD,GAAxCA,EAAUkB,QAAQN,EAAQC,UACzCta,EAAOqa,EAAQC,UAAY,CAACC,GACzBva,EAAOqa,EAAQC,UAAYC,EAG9BF,EAAQO,WAAY,CAAC,IAAD,gBACAP,EAAQO,YADR,IACtB,2BAA0C,CAAC,IAAlCC,EAAiC,QACxCN,EAASM,EAAUP,UAAYO,EAAUC,WAFrB,+BAMxBP,EAASQ,YAAcV,EAAQU,YAzBG,oBA2BjBV,EAAQW,YA3BS,IA2BlC,4BAAqCZ,EAArC,QAAqDG,IA3BnB,mCAClC,CACE,IAAIra,EAAIma,EAAQS,UACZ5a,EAAE+a,SAAQjb,EAAO,SAAWE,IA2BpC,IAxCuC,EAwCnCF,EAAS,GAxC0B,cAyCtB0Z,EAAIsB,YAzCkB,IAyCvC,4BAAiCZ,EAAjC,QAAiDpa,IAzCV,8BA2CvC,OAAOA,EAGF,SAAekb,GAAtB,mC,8CAAO,WAAwBC,GAAxB,eAAAnc,EAAA,6DAEDoc,EAAUD,EAAUtb,KAAI,SAACwb,GAAD,OAAOA,OAF9B,SAGQC,QAAQvb,IAAIqb,GAHpB,oF,+BAMQG,G,iFAAf,WAAkCC,GAAlC,iBAAAxc,EAAA,6DAEQyc,EAAMtT,aAAaC,QAAQ,UAFnC,SAGuBwQ,MAAM,iCAAkC,CAC3D8C,OAAQ,OACRhI,QAAS,CACPiI,cAAe,SAAWF,GAE5BnP,KAAMhE,KAAKY,UAAU,CAAEsS,MAAOA,MARlC,UAUwB,OAPhBxb,EAHR,QAUa0K,OAVb,0EAWoD1K,EAAO+Q,OAX3D,8EAae/Q,EAAO6Y,OAbtB,sF,oEAgBA,WAA8B2C,GAA9B,SAAAxc,EAAA,sEACgBuc,GAAmBC,GADnC,uCAC2C9b,MAD3C,4C,oEAIO,WAA2BZ,GAA3B,iBAAAE,EAAA,6DAECyc,EAAMtT,aAAaC,QAAQ,UAF5B,SAGgBwQ,MAAM,0BAA4B9Z,EAAK,CAC1D4U,QAAS,CACPkI,OAAQ,iCACRD,cAAe,SAAWF,KANzB,cAGCzb,EAHD,gBASQA,EAAO6Y,OATf,oF,oEAYA,WAA0B/Z,GAA1B,iBAAAE,EAAA,6DAECyc,EAAMtT,aAAaC,QAAQ,UAF5B,SAGgBwQ,MAAM,0BAA4B9Z,EAAK,CAC1D4U,QAAS,CACPkI,OAAQ,iCACRD,cAAe,SAAWF,KANzB,cAGCzb,EAHD,yBASEA,GATF,4C,sBAYA,IAAI6b,GAAS,CAClBC,Q,6CACAC,YAAaR,GACb1C,KA3BK,SAAP,oCA4BEmD,IAhBK,SAAP,qCAmBO,SAAeC,GAAtB,qC,8CAAO,WAAkBC,EAAQC,GAA1B,SAAAnd,EAAA,sEAEQ4Z,MACX,kBAAWuD,EAAX,uBACE,IAAIC,gBAAgB,CAClB,YAAa,EACbC,UAAW,IACXH,OAAQA,EACR,WAAY,MAGf7c,MAAK,SAACL,GAAD,OAAOA,EAAE+R,UACd1R,MAAK,SAACL,GAAD,OAAOua,GAASva,MAZnB,oF,0BC3GDsd,G,kDACJ,WAAYlc,GAAQ,IAAD,8BACjB,cAAMA,IAQRmc,UAAY,WACV,GAAI,EAAKC,QAAS,CACL,EAAKA,QAAQC,QAAQC,SAAS,GACzCC,4BAAiB,EAAKH,QAAQC,QAAQC,SAAS,GAAI,CACjDE,SAAU,aAXd,EAAKJ,QAAUK,IAAMC,YAFJ,E,qDAKnB,WACE7c,KAAKsc,c,oBAYP,WACE,IAAMQ,EAAQ9c,KAAKG,MAAM4c,SACrBC,EAAUF,EAAME,SAAWF,EAAMtd,MASjCyd,GANAzC,MAAMC,QAAQuC,GACLA,EAEA,CAACA,IAGSpd,KAAI,SAACwb,GAAD,OAAOA,EAAEN,YAAYE,UAAQkC,KAAK,QAEzDC,EAAW,KAQf,OAPIL,EAAMM,MAAQN,EAAMO,OACtBF,EACE,uBAAMna,MAAO,CAAE2K,MAAO,QAAtB,UACGmP,EAAMM,KADT,IACgBN,EAAMO,KADtB,QAMF,cAACC,GAAA,EAAD,CACEta,MAAO,CACLmL,WAAY,sBACZoP,UAAW,MACXhN,gBAAiB,WAJrB,SAOE,cAAC+M,GAAA,EAAKE,KAAN,UACE,gCACE,8BACGL,EACAL,EAAMW,UAFT,IAEqBX,EAAMxY,QAE3B,qBAAKoZ,IAAK1d,KAAKuc,QAAf,SACE,sBAAM3b,UAAU,kBAAhB,SAAmCqc,iB,GAvDzB/W,aAgElByX,G,kDACJ,WAAYxd,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACXya,YAAY,GAHG,E,0CAOnB,WAAU,IAAD,OACDC,EAAS,WACb,EAAK1a,MAAMya,YAAc,EAAKza,MAAMya,WACpC,EAAKna,SAAS,EAAKN,QAEf2a,EAAY,CAAElI,OAAQ,WAChB,IACR5V,KAAKmD,MAAM4a,YACL,IAKV,IAHA,IAAIC,EAAc,KAEdve,EAAO,GACX,MAAkC6L,OAAOtG,QAAQhF,KAAKG,MAAM8d,MAA5D,eACE,IADG,2BAAOC,EAAP,KAAiBC,EAAjB,KACH,MAAiC7S,OAAOtG,QAAQmZ,GAAhD,eAA0D,CAArD,2BAAOV,EAAP,KAAkBW,EAAlB,KACHA,EAAMF,SAAWA,EACjBE,EAAMX,UAAYA,EAClBhe,EAAKqL,KAAKsT,GAGd3e,EAAOA,EAAKwF,MAAK,SAAClG,EAAG0G,GAGnB,OAFA1G,EAAIA,EAAEsf,OAAStf,EAAES,OACjBiG,EAAIA,EAAE4Y,OAAS5Y,EAAEjG,OACNT,KAEb,IAzBO,EAyBHuf,EAAS,CACXD,OAAQ,EACR7e,MAAO,EACP+e,QAAS,GA5BJ,cA8BY9e,GA9BZ,IA8BP,2BAAyB,CAAC,IAAfsW,EAAc,QACvBuI,EAAOD,QAAUtI,EAAKsI,OACtBC,EAAO9e,OAASuW,EAAKvW,MACrB8e,EAAOC,SAAWxI,EAAKwI,SAjClB,8BAmCP,GAAIve,KAAKmD,MAAMya,WAAY,CACzB,IADyB,EACrB7Y,EAAO,GADc,cAEAtF,GAFA,IAEzB,2BAA+B,CAAC,IAArB+e,EAAoB,QACzBN,EAAWM,EAAWN,SAAS7H,MAAM,KAAKrP,OAAO,GAAG,GACpD1C,EAAI,UAAM4Z,EAAN,YAAkBM,EAAWf,WACrC1Y,EAAK+F,KACH,qBACE9H,MAAO,CACL0T,SAAU,OACVnG,gBAAiBiO,EAAWhf,MAAQ,EAAI,UAAY,SAHxD,UAOE,qBAAIwD,MAAO,CAAEmL,WAAY,uBAAzB,UACE,uBAAMnL,MAAO,CAAE2K,MAAO,QAAtB,UAAiCuQ,EAAjC,OACA,+BAAOM,EAAWf,eAEpB,oBAAI7c,UAAU,SAAd,SAAwB4d,EAAWH,SACnC,oBAAIzd,UAAU,SAAd,SAAwB4d,EAAWhf,QACnC,oBAAIoB,UAAU,SAAd,SAAwB4d,EAAWD,YAR9Bja,KAXc,8BAuBzB0Z,EACE,wBAAOhb,MAAO,CAAEua,UAAW,OAAS3c,UAAU,QAA9C,UACE,gCACE,+BACE,oBAAIA,UAAU,SAAd,kBACA,oBAAIA,UAAU,SAAd,oBACA,oBAAIA,UAAU,SAAd,oBACA,oBAAIA,UAAU,SAAd,0BAGJ,gCAAQmE,OAId,OACE,cAACuY,GAAA,EAAD,CACEta,MAAO,CACLua,UAAW,OAFf,SAKE,eAACD,GAAA,EAAKE,KAAN,WACE,cAACF,GAAA,EAAKmB,MAAN,CAAYzb,MAAO,CAAE0b,aAAc,GAAnC,0BACA,gCACE,oBAAG1b,MAAO,CAAE0b,aAAc,GAA1B,iBACO1e,KAAKG,MAAMme,OAAOK,MADzB,iBAC8C,IAC3C3e,KAAKG,MAAMme,OAAOH,QAFrB,iBAE4Cne,KAAKG,MAAMme,OAAOM,MAAO,IAFrE,WAKA,oBAAG5b,MAAO,CAAE0b,aAAc,GAA1B,UACGJ,EAAOD,OADV,kBACiCC,EAAO9e,MADxC,iBAC6D,IAC1D8e,EAAOC,QAFV,iBAGE,yBACEvb,MAAO,CAAEmP,WAAY,OAAQuE,SAAU,SACvC9V,UAAU,oBACV8U,QAASmI,EAHX,UAKG7d,KAAKmD,MAAMya,WAAa,OAAS,OALpC,iBAQDI,c,GAzGa9X,aAmHL2Y,G,kDACnB,WAAY1e,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,GAFI,E,qDAInB,WAAqB,IAAD,OAClBnD,KAAKqD,SAAS9D,OAAM,SAACC,GACnB,EAAK2D,MAAM2b,cAAgBtf,EAAMuf,WACjC9K,QAAQzU,MAAMA,GACd,EAAKiE,SAAS,EAAKN,Y,2DAIvB,kFAAApE,EAAA,sEAEkB4Z,MAAM3Y,KAAKG,MAAM6e,eAAe5f,MAAK,SAACE,GAAD,OACnDA,EAAE2f,iBAHN,OASE,IAAWC,KAPPC,EAFN,OAKMC,EAAU,GAERhC,EAAO,IAAIiC,WAAWF,GACxBG,EAAQC,aAAUnC,GAEhBhR,EAAM8S,EACPne,QAAQ,qBAAsB,IAC9BA,QAAQ,OAAQ,IACnBqe,EAAQhT,GAAOkN,GAASkG,aAAUF,EAAMJ,KAI1C,IAAWhB,KADPuB,EAAS,GACUL,EAErB,IADI3f,EAAO2f,EAAQlB,IACVwB,UACPD,EAAO3U,KAAKrL,EAAKigB,gBACZ,GAAIjgB,EAAKkgB,WACd,GAAInF,MAAMC,QAAQhb,EAAKkgB,WAAWD,WAAY,CAAC,EAAD,YACxBjgB,EAAKkgB,WAAWD,WADQ,IAC5C,2BAAWE,EAAoC,QAC7CH,EAAO3U,KAAK8U,GAF8B,oCAInCngB,EAAKkgB,WAAWD,WACzBD,EAAO3U,KAAKrL,EAAKkgB,WAAWD,gBAG9BzL,QAAQzU,MAAM,sBAAuBC,GAYzC,IARIogB,EAAW,GACXC,EAAW,GACTxB,EAAS,CACbH,QAAS,EACTQ,MAAO,EACPC,MAAO,EACP1c,KAAM,GAER,MAAoBud,EAApB,eAA4B,CAO1B,GAPSG,EAAiB,KACtBG,GAAaH,EAAMI,OACnBC,GAAeL,EAAMC,SACrBlB,EAAQiB,EAAM7C,SACbvC,MAAMC,QAAQkE,KACjBA,EAAQ,CAACA,IAEPoB,EAAYE,EAAc,EAAG,CAAC,EAAD,YACRtB,GADQ,IAC/B,6BAAW5B,EAAmB,SACfC,SAAWD,EAASvd,QAC/BqgB,EAAS/U,KAAKiS,GAHa,+BAQ3BmD,EAAY,SAACnD,GACjB,OAAIA,EAASwB,QACJ,UAELxB,EAASvd,OAASud,EAASC,QACtB,QAEF,UAtBiB,cAwBH2B,GAxBG,IAwB1B,2BAAW5B,EAAmB,QAC5BuB,EAAOK,OAAS,EACXmB,EAAS/C,EAASK,QACrB0C,EAAS/C,EAASK,MAAQ,GAC1BkB,EAAOM,OAAS,GAEbkB,EAAS/C,EAASK,MAAML,EAASU,aACpCa,EAAOH,SAAW,EAClB2B,EAAS/C,EAASK,MAAML,EAASU,WAAa,CAC5CY,OAAQ,EACR7e,MAAO,EACP+e,QAAS,EACTrc,KAAM,EACNyc,MAAO,IAGXL,EAAOpc,OAAS6a,EAAS7a,KACzB4d,EAAS/C,EAASK,MAAML,EAASU,WAAWyC,EAAUnD,KAAc,EACpE+C,EAAS/C,EAASK,MAAML,EAASU,WAAWkB,OAAS,EACrDmB,EAAS/C,EAASK,MAAML,EAASU,WAAWvb,OAAS6a,EAAS7a,KA3CtC,+BA+C5BlC,KAAKmD,MAAM0c,SAAWA,EACtB7f,KAAKmD,MAAMmb,OAASA,EACpBte,KAAKmD,MAAM2c,SAAWA,EACtB9f,KAAKyD,SAASzD,KAAKmD,OA5FrB,iD,iFA+FA,c,oBAEA,WACE,IAAKnD,KAAKmD,MAAM0c,SACd,OAAI7f,KAAKmD,MAAM2b,cAEX,oBAAG9b,MAAO,CAAE2K,MAAO,OAAnB,qCAC2B3N,KAAKmD,MAAM2b,iBAInC,oEAGT,IAAIqB,EAAU,GAERC,EACJ,cAAC,GAAD,CAAanC,KAAMje,KAAKmD,MAAM2c,SAAUxB,OAAQte,KAAKmD,MAAMmb,SAG7D,GAAkC,GAA9Bte,KAAKmD,MAAM0c,SAASta,OACtB,OACE,gCACG6a,EACD,cAAC9C,GAAA,EAAD,CACEta,MAAO,CACLua,UAAW,MACXhN,gBAAiB,WAHrB,SAME,cAAC+M,GAAA,EAAKE,KAAN,UACE,eAACF,GAAA,EAAKmB,MAAN,CAAYzb,MAAO,CAAE0b,aAAc,GAAnC,UACE,cAAC,KAAD,CAAS1b,MAAO,CAAE2K,MAAO,aAAgB,IACzC,8DAQZ,IAvCO,EAuCH/C,EAAI,EAvCD,cAwCc5K,KAAKmD,MAAM0c,UAxCzB,IAwCP,2BAA0C,CAAC,IAAlC9C,EAAiC,QACxCoD,EAAQrV,KAAK,cAAC,GAAD,CAAqBiS,SAAUA,GAAfnS,OAzCxB,8BA4CP,OACE,gCACGwV,EACAD,S,GA7JuCja,a,kBCpMzC,SAASma,GAAUjJ,GACxB,IAD6B,EACzBkJ,EAAkB,CACpB,0BACA,+CACA,oBACA,qBACA,0BACA,gBACA,kBACA,mBACA,oBACA,YACA,aACA,cACA,0BACA,oCACA,uBACA,sBACA,iCACA,oBACA,8BACA,0BACA,mCACA,qCACA,oCACA,gCACA,+BACA,2BACA,yBACA,iCAGIC,EAAQnJ,EAAIf,MAAM,MACpBmK,EAAS,GAjCgB,cAmCVD,GAnCU,IAmC7B,2BAA0B,CAAC,IAAD,EAAflD,EAAe,QACpBoD,GAAU,EADU,cAEJH,GAFI,IAExB,2BAAqC,CAAC,IAA3B3P,EAA0B,QACnC,GAAI0M,EAAK9O,MAAMoC,GAAQ,CACrB8P,GAAU,EACV,QALoB,8BAQpBA,IACFD,GAAUnD,EAAO,OA5CQ,8BA+C7B,OAAOmD,EAGF,SAASE,GAAoBC,EAAQC,GAE1CD,EAAOE,UAAUC,SAAS,CAAE5O,GAAI,YAGhCyO,EAAOE,UAAUE,yBAAyB,UAAW,CACnDC,UAAW,CACTC,KAAM,CACJ,CAAC,iBAAkB,SACnB,CAAC,iBAAkB,OACnB,CAAC,iBAAkB,SACnB,CAAC,iBAAkB,UACnB,CAAC,iBAAkB,QACnB,CAAC,iBAAkB,WACnB,CAAC,iBAAkB,QACnB,CAAC,iBAAkB,SAEnB,CAAC,eAAgB,SACjB,CAAC,eAAgB,OACjB,CAAC,eAAgB,SACjB,CAAC,eAAgB,UACjB,CAAC,eAAgB,QACjB,CAAC,eAAgB,WACjB,CAAC,eAAgB,QACjB,CAAC,eAAgB,SAEjB,CAAC,mBAAoB,SACrB,CAAC,mBAAoB,OACrB,CAAC,mBAAoB,SACrB,CAAC,mBAAoB,UACrB,CAAC,mBAAoB,QACrB,CAAC,mBAAoB,WACrB,CAAC,mBAAoB,QACrB,CAAC,mBAAoB,SAErB,CAAC,cAAe,QAChB,CAAC,8CAA+C,cAMtDN,EAAOO,OAAOC,YAAY,WAAY,CACpCC,KAAM,UACNC,SAAS,EACTC,MAAO,CACL,CAAEzI,MAAO,QAAS0I,WAAY,SAAUC,UAAW,QACnD,CAAE3I,MAAO,MAAO0I,WAAY,SAAUC,UAAW,QACjD,CAAE3I,MAAO,QAAS0I,WAAY,SAAUC,UAAW,QACnD,CAAE3I,MAAO,SAAU0I,WAAY,SAAUC,UAAW,QACpD,CAAE3I,MAAO,OAAQ0I,WAAY,SAAUC,UAAW,QAClD,CAAE3I,MAAO,UAAW0I,WAAY,SAAUC,UAAW,QACrD,CAAE3I,MAAO,OAAQ0I,WAAY,SAAUC,UAAW,QAClD,CAAE3I,MAAO,QAAS0I,WAAY,SAAUC,UAAW,QACnD,CAAE3I,MAAO,SAAU0I,WAAY,aAInCZ,EAAOE,UAAUY,6BAA6B,UAAW,CACvDC,qBAAsB,SAAUC,EAAOC,EAAS/I,GAC9C,OAAO+H,K,IC5FQiB,G,kDACnB,WAAY1hB,GAAQ,IAAD,sBACjB,cAAMA,GACN,IAAI2hB,EAAa3hB,EAAMsK,OAAOsX,UAAUxT,MAAM,2BAK9C,GAJA,EAAKpL,MAAQ,CACX6e,UAAW,IAGTF,EAAY,CACd,IAAIG,EAAUH,EAAW,GACzB,EAAK3e,MAAMtE,IAAX,mEAA6EojB,GAT9D,S,4CAanB,WACE,YAAmCjjB,IAA5BgB,KAAKmD,MAAM+e,e,uEAGpB,WAAyBnZ,EAAWoZ,GAApC,0BAAApjB,EAAA,0DACMiB,KAAKoiB,WADX,oDAIOpiB,KAAKmD,MAAM1D,KAJlB,+DAOqBO,KAAKmD,MAAM1D,KAAK4iB,OAPrC,0BAOaC,EAPb,QAQI,IAAKA,EAAKlL,IAAImL,YAA2BvjB,IAAlBsjB,EAAKlL,IAAItG,KAC9B,iBAGF6H,MAAM2J,EAAK5T,QAAQ,GAAG8T,YACnBpjB,MAAK,SAACgY,GAAD,OAASA,EAAItG,UAClB1R,MAAK,SAACgY,GACLkL,EAAKlL,IAAItG,KAAOsG,EAAIqL,WAAW,MAAO,MAAMA,WAAW,MAAO,IAC9D,EAAKhf,SAAS,EAAKN,WAhB3B,2T,wFAqBA,WACEnD,KAAKqD,W,2DAGP,kCAAAtE,EAAA,sEACuB4Z,MAAM3Y,KAAKmD,MAAMtE,KADxC,cACMQ,EADN,gBAEmBA,EAASuZ,OAF5B,cAEMnZ,EAFN,QAGcijB,WAHd,cAKqBjjB,EAAK4iB,OAL1B,IAKE,2BAA+B,QACxBjL,IAAM,CACTtG,UAAM9R,EACNujB,OAAO,EACPI,SAAU,WAThB,8BAaE3iB,KAAKyD,SAAS,CAAEhE,KAAMA,IAbxB,iD,oFAgBA,SAAiBgL,GAYf,OAXAA,EAASA,EAAOmY,cAEC,CACfC,QAAS,cAAC,KAAD,CAAS7f,MAAO,CAAE2K,MAAO,aAClCmV,QAAS,cAAC,KAAD,CAAK9f,MAAO,CAAE2K,MAAO,aAC9BoV,OAAQ,cAAC,KAAD,CAAK/f,MAAO,CAAE2K,MAAO,aAC7BqV,SAAU,cAAC,KAAD,CAAKhgB,MAAO,CAAE2K,MAAO,aAC/BsV,QAAS,cAAC,KAAD,CAAejgB,MAAO,CAAE2K,MAAO,aACxCuV,UAAW,cAAC,KAAD,CAAelgB,MAAO,CAAE2K,MAAO,qBAG5BlD,IAAW,cAAC,KAAD,CAAgBzH,MAAO,CAAE2K,MAAO,e,6BAG7D,SAAgB2U,GAAO,IAAD,OAChBlL,EAAM,KAGV,GAAIkL,EAAKlL,IAAImL,MAEX,IADY,EACRD,EAAKlL,IAAItG,KAAM,CACjB,IAAIqS,EAAU,KAORC,IALJD,EADuB,OAArBb,EAAKlL,IAAIuL,SACDL,EAAKlL,IAAItG,KAETuP,GAAUiC,EAAKlL,IAAItG,OAGHvC,MAAM,QAAU,IAAIhJ,OAAS,EAErD+c,EAAKlL,IAAIiM,iBACXf,EAAKlL,IAAIiM,eAAeC,SAASH,GACjCb,EAAKlL,IAAIiM,eAAeE,WAAWH,IAErChM,EACE,sBACEpU,MAAO,CACL0b,aAAc,QAFlB,UAKE,sBAAK9d,UAAU,YAAf,UACE,+CACA,qBAAKoC,MAAO,CAAEiW,QAAS,UAAvB,SACE,cAACuK,GAAA,EAAD,UA1BG,CAAC,UAAW,OA2BL5jB,KAAI,SAAC6jB,EAAO7Q,GAAR,OACV,cAAC8Q,GAAA,EAAD,CAEExR,GAAE,gBAAWU,GACbzC,KAAK,QACLwT,QAAQ,eACRrf,KAAK,QACLoL,MAAO+T,EACPrT,QAASkS,EAAKlL,IAAIuL,WAAac,EAC/BpT,SAAU,SAAC9G,GACT+Y,EAAKlL,IAAIuL,SAAWc,EACpB,EAAKhgB,SAAS,EAAKN,QAVvB,SAaGsgB,GAZI7Q,aAkBf,cAAC,KAAD,CACE1C,OAAO,OACP0T,gBAAgB,UAChB9R,aAAcqR,EACdU,MAAM,WACNC,YAAa,SAACnD,GAEZD,GAAoBC,EADA,KAGtB7hB,QAAS,CACPilB,sBAAsB,EACtBC,oBAAqBZ,EAAWrE,WAAWxZ,OAAS,EACpD0e,SAAS,GAEXC,QAAS,SAAChD,EAAQP,GAChB2B,EAAKlL,IAAIiM,eAAiBnC,EACTA,EAAOiD,UAAU,kBACvB9M,MAAMjY,MAAK,WACpB8hB,EAAOqC,WAAWH,OAGtBgB,QAAS,4DAKfhN,EAAM,iDAGV,OAAOA,I,oBAGT,WAAU,IAAD,OACD3M,EAASzK,KAAKG,MAAMsK,OAEtB4Z,EAAe,KAGnB,GAAIrkB,KAAKmD,MAAM1D,KAAM,CACnB,IADmB,EACf4iB,EAAQ,GADO,cAEKriB,KAAKmD,MAAM1D,KAAK4iB,MAAMrd,WAF3B,mDAEP4F,EAFO,KAEJ0X,EAFI,KAGXhe,EAAOge,EAAKhe,KAGdggB,GAFWhC,EAAK5T,QAAQ,GAAG8T,WAEd,EAAK+B,iBAAiBjC,EAAK5T,QAAQ,GAAGjE,SACjDqT,EAAY,CAAElI,OAAQ,WAEtBiI,EAAS,WACbyE,EAAKlL,IAAImL,OAASD,EAAKlL,IAAImL,MAC3B,EAAK9e,SAAS,EAAKN,QAEjBqS,EAAO,cAAC,IAAD,CAAsBxS,MAAO8a,EAAWpI,QAASmI,IACxDyE,EAAKlL,IAAImL,QACX/M,EAAO,cAAC,IAAD,CAAqBxS,MAAO8a,EAAWpI,QAASmI,KAGzDwE,EAAMvX,KACJ,sBACE9H,MAAO,CAAE0b,aAAc,OADzB,UAIG4F,EAJH,IAIe,+BAAOhgB,IAJtB,IAIoCkR,EAJpC,IAI2C,EAAKgP,gBAAgBlC,KAJhE,iBAEiB7X,EAAOmX,QAFxB,YAEmCtd,EAFnC,YAE2CsG,MAnB/C,2BAA0D,IAFvC,8BA+BnByZ,EAAe,qBAAKrhB,MAAO,CAAEoL,QAAS,OAAvB,SAAiCiU,IAGlD,OACE,cAAC/E,GAAA,EAAD,UACE,eAACA,GAAA,EAAKE,KAAN,CACExa,MAAO,CACLuN,gBACmB,YAAjB9F,EAAOtH,MAAsB,mBAAqB,MAHxD,UAME,cAACma,GAAA,EAAKmB,MAAN,UACE,mBAAG7Y,KAAM6E,EAAOsX,UAAhB,SAA4BtX,EAAOmX,YAErC,gCACGyC,EAhDc,YAqCV,QAAU5Z,EAAOmX,a,GArMQ1b,aCWpCue,GAAmB,mCA0EzB,SAASC,GAAe1R,EAAMC,EAAM0R,GAClC,MAAM,oCAAN,OAEwB1R,EAFxB,sBAE0CD,EAF1C,qCAGoB2R,EAHpB,4yC,IAuDmBC,G,kDACnB,WAAYzkB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACX0hB,UAAW,EAAK1kB,MAAM0kB,UACtBC,YAAa,EAAK3kB,MAAM2kB,YACxBvS,WAAY,IALG,E,qDASnB,WACEvS,KAAKqD,W,kBAGP,WACE,YAAgCrE,IAAzBgB,KAAKmD,MAAM0hB,Y,sBAEpB,WACE,YAAoC7lB,IAA7BgB,KAAKmD,MAAM4hB,gB,yBAGpB,SAAYhlB,EAAQqM,GAGlB,OAAKrM,EAAOqM,GAIRoO,MAAMC,QAAQ1a,EAAOqM,IAChBrM,EAAOqM,GAET,CAACrM,EAAOqM,IANN,O,uEASX,WAAyBrD,EAAWoZ,GAApC,gCAAApjB,EAAA,0DACMiB,KAAKoiB,WADX,+DAIoBpiB,KAAKmD,MAAM6hB,MAJ/B,yDAIa3N,EAJb,sBAKwBA,EAAI4N,UAAUC,OALtC,0BAKeC,EALf,QAMM,IAAKA,EAAM/N,IAAImL,OAA4B,OAAnB4C,EAAM/N,IAAItG,KAChC,iBAGF8K,GACGG,IADH,gBAEa,EAAK5b,MAAM6S,KAFxB,YAEgC,EAAK7S,MAAM8S,KAF3C,yBAEgEkS,EAAMC,WAFtE,UAIGhmB,MAAK,SAACgY,GAAD,OAASA,EAAItG,UAClB1R,MAAK,SAACgY,GACL+N,EAAM/N,IAAItG,KAAOsG,EACjB,EAAK3T,SAAS,EAAKN,WAjB7B,id,oHAuBA,iDAAApE,EAAA,yDAGEmJ,aAAac,QAAQ,gBAAiBsP,OAAOC,SAAS3S,OAzLtD0S,OAAOC,SAAS3S,KAAK4D,WAAW,qBAChC8O,OAAOC,SAAS3S,KAAK4D,WAAW,6BA4LzBtB,aAAaC,QAAQ,YAClB0Q,EAAQwM,OACZ,6JAEFnd,aAAac,QAAQ,SAAU6P,KAK9B3Q,aAAaC,QAAQ,UAhB5B,qDAmBMnI,KAAKoiB,WAnBX,qDAuBMpiB,KAAKslB,OAvBX,iCAwB0B1J,GAAOC,SAzMf7I,EA0MDhT,KAAKG,MAAM6S,KA1MJC,EA0MUjT,KAAKG,MAAM8S,KA1MfpD,EA0MqB7P,KAAKmD,MAAM0hB,UAzMxD,oCAAN,OAEwB5R,EAFxB,sBAE0CD,EAF1C,6CAG4BnD,EAH5B,85CAgLA,UAwBQ0V,EAxBR,OA2BIvlB,KAAKmD,MAAMqiB,GAAKD,EAAUE,WAAWC,YACf,OAAlB1lB,KAAKmD,MAAMqiB,GA5BnB,wBA6BMxlB,KAAKmD,MAAM4hB,cAAgB,sBAAwB/kB,KAAKmD,MAAM0hB,UAC9D7kB,KAAKyD,SAASzD,KAAKmD,OA9BzB,2BAiCInD,KAAKmD,MAAMwH,OAAS3K,KAAKmD,MAAMqiB,GAAGrS,QAAQ+R,MAAM,GAAGva,OAjCvD,yCAmCuBiR,GAAOC,QACxB6I,GAAe1kB,KAAKG,MAAM6S,KAAMhT,KAAKG,MAAM8S,KAAMjT,KAAKmD,MAAM2hB,cApClE,WAsCoC,OAH5Bna,EAnCR,QAsCe8a,WAAWE,OAtC1B,wBAuCM3lB,KAAKmD,MAAM4hB,cAAgB,mBAAqB/kB,KAAKmD,MAAM2hB,YAC3D9kB,KAAKyD,SAASzD,KAAKmD,OAxCzB,2BA2CInD,KAAKmD,MAAMwH,OAASA,EAAO8a,WAAWE,OAAOC,QAAQV,MAAM,GA3C/D,eAkDEW,GADIA,EAAgB7lB,KAAKmD,MAAMwH,OAAOmb,YAAYZ,OACpB7f,QAAO,SAACtC,GAAD,OAAOA,EAAEgjB,gBAChCniB,SAAQ,SAACyT,GACrBA,EAAI4N,UAAUC,MAAMthB,SAAQ,SAACuhB,GAC3BA,EAAM/N,IAAM,CACVtG,KAAM,KACNyR,OAAO,EACPI,SAAU,iBAxDlB,UA4DQ1H,GACJ4K,EAAcjmB,KAAI,SAACyX,GACjB,6BAAO,4BAAAtY,EAAA,6DACDmT,EAAKmF,EAAI0O,YAAYX,WADpB,SAEiBxJ,GAAOhD,KAAP,gBACX,EAAKzY,MAAM6S,KADA,YACQ,EAAK7S,MAAM8S,KADnB,yBACwCf,EADxC,eAFjB,OAELmF,EAAI2O,UAFC,sDA9Db,QAuEEH,EAAgBA,EAAc5gB,MAAK,SAAClG,EAAG0G,GAAJ,OACjC1G,EAAEgnB,YAAYE,SAAS3hB,KAAKse,cAC5Bnd,EAAEsgB,YAAYE,SAAS3hB,KAAKse,cACxB,GACC,KAEP5iB,KAAKmD,MAAM6hB,KAAOa,EA7EpB,cA8EoB7lB,KAAKmD,MAAM6hB,MA9E/B,IA8EE,4BAAW3N,EAAwB,SAC7B5M,OAASzK,KAAKkmB,cAChB7O,EAAI4N,UAAUC,MAAMtlB,KAAI,SAACulB,GAAD,OAAWA,EAAMgB,eAhF/C,qCAmFEnmB,KAAKmD,MAAMijB,SAAWpmB,KAAKmD,MAAMwH,OAAOF,OAAO4b,SAC/CrmB,KAAKyD,SAASzD,KAAKmD,OAKfmjB,EAAWtmB,KAAKmD,MAAM6hB,KAAKplB,KAAI,SAACyX,GAElC,OADAA,EAAIkP,aAAe,GACK,YAApB,EAAKpmB,MAAM8S,KAEb,sBAAO,sBAAAlU,EAAA,2HAKT,sBAAO,gDAAAA,EAAA,sEAEcid,GAAG,mBAAD,OACA3E,EAAI0O,YAAYX,WADhB,KAEnB,iBAJG,UAEDrlB,EAFC,UAODymB,EAAW,EAAKC,YAClB1mB,EAAO2mB,iBACP,oBAKcF,EAASjhB,OAAS,GAd7B,+BAesBihB,GAftB,gEAeQG,EAfR,QAgBG1K,EAAS0K,EAAWC,OAAO,SAhB9B,UAiBkB5K,GAAGC,EAAQ,iBAjB7B,QAiBGlc,EAjBH,OAkBG8mB,EAAW,EAAKJ,YAClB1mB,EAAO2mB,iBACP,YApBD,cAsBqBG,GAtBrB,IAsBD,2BAAW5J,EAAqB,QAC9B5F,EAAIkP,aAAazb,KAAKmS,GAvBvB,wOAlGX,UA+HQhC,GAASqL,GA/HjB,QAgIEtmB,KAAKyD,SAASzD,KAAKmD,OAhIrB,kCAjLF,IAAoB6P,EAAMC,EAAMpD,IAiL9B,Y,0FAmIA,WAA0B,IAAD,OAInBiX,EAAS,KACTC,EAAM,KAEJC,EAAe,SAAC1iB,GAAU,IAAD,gBACE,EAAKnB,MAAM6hB,KAAKhgB,WADlB,IAC7B,2BAA0D,CAAC,IAAD,4BAAnCqS,GAAmC,yBAC3BA,EAAI4N,UAAUC,MAAMlgB,WADO,IACxD,2BAA4D,CAAC,IAAD,0BAAzCmgB,GAAyC,WAC1D,GACEA,EAAM7gB,OAASA,GACE,cAAjB6gB,EAAM1a,QACe,YAArB0a,EAAMgB,WAEN,OAAO,GAP6C,gCAD7B,8BAY7B,OAAO,GA4BT,OAzBInmB,KAAKmD,MAAM6hB,OACTgC,EAAa,yBACfF,EACE,mBACElhB,KAAI,UAAK6e,GAAL,YAAyBzkB,KAAKmD,MAAM0hB,UAApC,eACJrX,OAAO,SACP5M,UAAU,kBACVoC,MAAO,CAAEikB,YAAa,OAJxB,0BAUAD,EAAa,sBACfD,EACE,mBACEnhB,KAAI,UAAK6e,GAAL,YAAyBzkB,KAAKmD,MAAM0hB,UAApC,uBACJrX,OAAO,SACP5M,UAAU,kBAHZ,wBAWJ,sBAAKoC,MAAO,CAAEkkB,cAAe,OAA7B,UACGJ,EAEAC,O,yBAKP,WACE,IAAInX,EAAQ,KACZ,GAAI5P,KAAKmD,MAAMwH,OACb,GAAI3K,KAAKslB,OACP1V,EACE,8BACE,6BACE,oBACEhK,KAAI,6BAAwB5F,KAAKG,MAAM6S,KAAnC,YAA2ChT,KAAKG,MAAM8S,KAAtD,iBAAmEjT,KAAKmD,MAAM0hB,WADpF,UAGG7kB,KAAKmD,MAAMqiB,GAAG5V,MAHjB,MAG2B5P,KAAKmD,MAAM0hB,UAHtC,eAQD,CACL,IAAIsC,EAAUnnB,KAAKmD,MAAMwH,OAAOyc,gBAC5B9T,EAAW,4BAAI6T,IACf5Y,EAAQ4Y,EAAQ5Y,MAAM,iBAC1B,GAAIA,GAASA,EAAM,GAAI,CACrB,IAAIsW,EAAYtW,EAAM,GACtB4Y,EAAUA,EAAQpmB,QAAQwN,EAAM,GAAI,IACpC+E,EACE,8BACG6T,EAAS,IACV,oBACEvhB,KAAI,6BAAwB5F,KAAKG,MAAM6S,KAAnC,YAA2ChT,KAAKG,MAAM8S,KAAtD,iBAAmE4R,GADzE,eAGKA,EAHL,UASNjV,EACE,gCACE,wCACS,IACP,mBAAGhK,KAAM5F,KAAKmD,MAAMwH,OAAO0c,UAA3B,SACGrnB,KAAKmD,MAAMwH,OAAO2c,IAAItgB,MAAM,EAAG,QAGnCsM,KAKT,OAAO1D,I,gCAGT,SAAmB2X,GACjB,IAD2B,EACvBC,EAAO,KADgB,cAELD,GAFK,IAE3B,2BAAgC,CAAC,IAAtBjZ,EAAqB,QAG9B,GAA6B,wBAAzBA,EAAQc,OAAOqY,MAAiC,CAClD,IAAIlZ,EAAQD,EAAQjC,KAAKkC,MACvB,gDAEEA,IACFiZ,EAAOjZ,EAAM,MAVQ,8BAc3B,OAAOiZ,I,wBAGT,WACE,IAAKxnB,KAAKmD,MAAMwH,OACd,OAAO,KAIT,IAAImG,EAAO9Q,KAAKmD,MAAMwH,OAAO+c,YACzBF,EAAO,KACPxnB,KAAKslB,SACPxU,EAAO9Q,KAAKmD,MAAMqiB,GAAGnZ,MAEvB,IAAMkC,EAAQuC,EAAKvC,MAAM,2CAWzB,OAVIA,IACFiZ,EAAOjZ,EAAM,KAGViZ,GAAQxnB,KAAKslB,SAGhBkC,EAAOxnB,KAAK2nB,mBAAmB3nB,KAAKmD,MAAMqiB,GAAG+B,SAASrC,QAGjD,mBAAGtf,KAAI,0CAAqC4hB,GAA5C,SAAqDA,M,wBAG9D,WACE,IAAKxnB,KAAKmD,MAAMwH,OACd,OAAO,KAGT,IAAImG,EAAO9Q,KAAKmD,MAAMwH,OAAO+c,YAK7B,OAJI1nB,KAAKslB,SACPxU,EAAO9Q,KAAKmD,MAAMqiB,GAAGnZ,MAIrB,qBAAKrJ,MAAO,CAAE4kB,UAAW,OAAQvgB,SAAU,SAAUmP,OAAQ,QAA7D,SACE,cAAC,KAAD,CAAeiG,SAAU3L,Q,4BAK/B,SAAe6P,EAAQ7P,GACrB,IAD2B,EACrByP,EAAQzP,EAAKuF,MAAM,MACnBwR,EAAS,GACTC,EAAO,GACTC,EAAa,EAJU,cAKRxH,GALQ,IAK3B,2BAA0B,CAAC,IAAhBlD,EAAe,QACpBA,EAAK5R,SAAS,aAChBoc,EAAO/c,KAAKid,GACH1K,EAAK5R,SAAS,iBACvBqc,EAAKhd,KAAKid,GAEZA,GAAc,GAXW,8BAc3B,IADA,IAAIC,EAAS,GACJpd,EAAI,EAAGA,EAAI7I,KAAKkmB,IAAIJ,EAAOtiB,OAAQuiB,EAAKviB,QAASqF,IACxDod,EAAOld,KAAK,CACVod,MAAOL,EAAOjd,GAAK,EACnBud,IAAKL,EAAKld,GAAK,EACfwd,KAAMzH,EAAOE,UAAUwH,iBAAiBC,UAG5C,OAAON,I,6BAGT,SAAgB7C,GAAQ,IAAD,OACjB/N,EAAM,KACNmR,GAAY,EAEhB,GAAIpD,EAAM/N,IAAImL,MAEZ,GADAgG,GAAY,EACRpD,EAAM/N,IAAItG,KAAM,CAClB,IAAIqS,EAAU,KAORC,IALJD,EADwB,OAAtBgC,EAAM/N,IAAIuL,SACFwC,EAAM/N,IAAItG,KAEVuP,GAAU8E,EAAM/N,IAAItG,OAGJvC,MAAM,QAAU,IAAIhJ,OAAS,EAErD4f,EAAM/N,IAAIiM,iBACZ8B,EAAM/N,IAAIiM,eAAeC,SAASH,GAClCgC,EAAM/N,IAAIiM,eAAeE,WAAWH,IAGtChM,EACE,sBACEpU,MAAO,CACL0b,aAAc,QAFlB,UAKE,sBAAK9d,UAAU,YAAf,UACE,+CACA,qBAAKoC,MAAO,CAAEiW,QAAS,UAAvB,SACE,cAACuK,GAAA,EAAD,UA3BG,CAAC,UAAW,OA4BL5jB,KAAI,SAAC6jB,EAAO7Q,GAAR,OACV,cAAC8Q,GAAA,EAAD,CAEExR,GAAE,gBAAWU,GACbzC,KAAK,QACLwT,QAAQ,eACRrf,KAAK,QACLoL,MAAO+T,EACPrT,QAAS+U,EAAM/N,IAAIuL,WAAac,EAChCpT,SAAU,SAAC9G,GACT4b,EAAM/N,IAAIuL,SAAWc,EACrB,EAAKhgB,SAAS,EAAKN,QAVvB,SAaGsgB,GAZI7Q,aAkBf,cAAC,KAAD,CACE1C,OAAO,OACP0T,gBAAgB,UAChB9R,aAAcqR,EACdU,MAAM,WACNC,YAAa,SAACnD,GAEZD,GAAoBC,EADA,EAAK6H,eAAe7H,EAAQwC,KAGlDrkB,QAAS,CACPilB,sBAAsB,EACtBC,oBAAqBZ,EAAWrE,WAAWxZ,OAAS,EACpD0e,SAAS,GAEXC,QAAS,SAAChD,EAAQP,GAChBwE,EAAM/N,IAAIiM,eAAiBnC,EACVA,EAAOiD,UAAU,kBACvB9M,MAAMjY,MAAK,WACpB8hB,EAAOqC,WAAWH,OAGtBgB,QAAS,4DAKfhN,EAAM,iDAGV,MAAO,CAACA,EAAKmR,K,6BAGf,SAAgBE,GACd,OACEA,EACG1nB,QAAQ,IAAK,IACbA,QAAQ,IAAK,IACbA,QAAQ,QAAS,sBACjB0hB,WAAW,KAAM,KAAO,S,0BAI/B,SAAawC,EAAWyD,GAAc,IAAD,OAC7BC,EAAS,GACTC,EAAsB,GACvBF,IACHA,EAAc,IAEhB,IANmC,EAM/BG,EAAkB,GANa,cAOZH,GAPY,IAOnC,2BAAoC,CAAC,IAA1BI,EAAyB,QAE9BxkB,EADSwkB,EAASC,IAAI,SACR1S,MAAM,KAAKrP,OAAO,GAAG,GACvC6hB,EAAgBvkB,GAAQwkB,GAVS,kDAaN7D,EAAUjgB,WAbJ,mDAavBmF,EAbuB,KAahBgb,EAbgB,KAe3BtH,EAAS,WACbsH,EAAM/N,IAAImL,OAAS4C,EAAM/N,IAAImL,MAC7B,EAAK9e,SAAS,EAAKN,QAErB,EAAyB,EAAKqhB,gBAAgBW,GAA9C,oBAAO/N,EAAP,KAAYmR,EAAZ,KACMzK,EAAY,CAAElI,OAAQ,WACxBJ,EAAO,cAAC,IAAD,CAAsBxS,MAAO8a,EAAWpI,QAASmI,IACxD0K,IACF/S,EAAO,cAAC,IAAD,CAAqBxS,MAAO8a,EAAWpI,QAASmI,KAIzD,IAMIyG,EANa,CACfzB,QAAS,cAAC,KAAD,CAAS7f,MAAO,CAAE2K,MAAO,aAClCmV,QAAS,cAAC,KAAD,CAAK9f,MAAO,CAAE2K,MAAO,aAC9BsV,QAAS,cAAC,KAAD,CAAejgB,MAAO,CAAE2K,MAAO,aACxCuV,UAAW,cAAC,KAAD,CAAelgB,MAAO,CAAE2K,MAAO,qBAElBwX,EAAMgB,aAC9B,cAAC,KAAD,CAAgBnjB,MAAO,CAAE2K,MAAO,aAG9Bqb,EAAsB,KACtBC,EAAkB,KAClBC,EAAe,EAAKC,gBAAgBhE,EAAM7gB,MAC9C,GAAIukB,EAAgBK,GAAe,CACjC,IAAMJ,EAAWD,EAAgBK,GAC3B5hB,EAAO4R,GAAYkQ,SAASN,EAASO,KAAK,WAsBhD,GArBAL,EACE,wBACEhmB,MAAO,CAAEmP,WAAY,MAAOuE,SAAU,QAASP,WAAY,QAC3DvV,UAAU,eACV8U,QAAO,sBAAE,sBAAA3W,EAAA,sDAGH+pB,EAASQ,WACXR,EAASQ,YAAa,EAEtBR,EAASQ,YAAa,EAExB,EAAK7lB,SAAS,EAAKN,OACnB,EAAKomB,SATE,2CAHX,SAeGT,EAASQ,WAAa,OAAtB,iBAAyChiB,EAAzC,OAGLshB,EAAoBE,EAASC,IAAI,WAAY,EAEzCD,EAASQ,WAAY,CACvB,IAAMld,EAAG,aAAS+Y,EAAM7gB,KAAf,YAAuB4kB,GAC5BjN,EAAS6M,EAASC,IAAI,SACtBlqB,EAAG,iDAA6Cod,GACpDgN,EACE,cAAC,GAAD,CAAoBjK,cAAengB,GAAUuN,IAInDuc,EAAO7d,KAAK,CACVrL,KAAM0lB,EACNqE,QACE,sBAAKxmB,MAAO,CAAE0b,aAAc,OAA5B,UACG4F,EADH,IACe,mBAAG1e,KAAMuf,EAAMsE,WAAf,SAA4BtE,EAAM7gB,OADjD,IAC4DkR,EAAM,IAC/D4B,EACA4R,EACAC,IAJuC,aAAe9e,MA/D/D,2BAAmD,IAbhB,8BAqFnC,MAAO,CAACwe,EAAQC,K,4BAGlB,SAAec,GACb,OAAIA,EAAKC,QAEL,gCACE,qCACID,EAAKtB,KADT,KACiBsB,EAAKplB,QACd,IACR,qCAAQ4U,GAAYwQ,EAAKE,eAAzB,mBAJF,UAAaF,EAAKtB,KAAlB,YAA0BsB,EAAKvf,QAS/B,gCACE,oBAAGvE,KAAM8jB,EAAK7qB,IAAd,cACI6qB,EAAKtB,KADT,KACiBsB,EAAKplB,QACjB,IACL,qCAAQ4U,GAAYwQ,EAAKE,eAAzB,OACCF,EAAKG,QALR,UAAaH,EAAKtB,KAAlB,YAA0BsB,EAAKvf,U,mCAWrC,SAAsBkN,GACpB,IADyB,EAErB2O,EAAY,GAFS,cAGO3O,EAAI2O,UAAUA,UAAUhhB,WAH/B,IAGzB,2BAAmE,CAAC,IAAD,0BAAvDmF,EAAuD,KAAhD2e,EAAgD,KAG7DjqB,EAAG,6BAAyBmB,KAAKG,MAAM6S,KAApC,YAA4ChT,KAAKG,MAAM8S,KAAvD,mBAAsEoE,EAAI+N,WAA1E,sBAAkG0D,EAAS5W,IAC9G4W,EAASxkB,KAAKkF,WAAW,kBAG7Bwc,EAAUlb,KACR9K,KAAK8pB,eAAe,CAClB1B,KAAM,MACNje,MAAOA,EACP7F,KAAMwkB,EAASxkB,KACfslB,cAAed,EAASc,cACxB/qB,IAAKA,EACL8qB,QAASb,EAASa,YAjBC,8BAqBzB,OAAO3D,I,+BAGT,SAAkB3O,EAAKuR,GACrB,IAAI5C,EAAY,GAChB,GAAI3O,EAAIkP,aAAc,CAAC,IAAD,gBACYlP,EAAIkP,aAAavhB,WAD7B,IACpB,2BAA4D,CAAC,IAAD,0BAAhDmF,EAAgD,KAAzC2e,EAAyC,KAC1D,IAAIF,EAAoBE,EAASC,IAAI,UAArC,CAIA,IAAI9M,EAAS6M,EAASC,IAAI,SAEtBlqB,GADOod,EAAO5F,MAAM,KAAKrP,OAAO,GAAG,GAChC,iDAA6CiV,IAEpD+J,EAAUlb,KACR9K,KAAK8pB,eAAe,CAClB1B,KAAM,KACNje,MAAOA,EACP7F,KAAM2X,EAAO5F,MAAM,KAAKrP,OAAO,GAC/B4iB,cAAeR,SAASN,EAASO,KAAK,UACtCxqB,IAAKA,EACL8qB,SAAS,OAjBK,+BAsBtB,OAAO3D,I,2BAGT,SAAcI,GACZ,GAAuB,GAAnBA,EAAS7gB,OACX,MAAO,UAET,IAJsB,EAIhBwkB,EAAS,CACbjH,QAAS,EACTG,QAAS,EACTC,UAAW,EACXL,QAAS,GARW,cAUDuD,GAVC,IAUtB,2BAA+B,CAC7B2D,EAD6B,UACX,GAXE,8BAatB,OAAIA,EAAOjH,QAAU,EACZ,UAELiH,EAAO9G,QAAU8G,EAAO7G,YAAckD,EAAS7gB,OAC1C,UAELwkB,EAAOlH,UAAYuD,EAAS7gB,OACvB,UAELwkB,EAAO9G,UAAYmD,EAAS7gB,OACvB,UAEF,Y,0BAGT,SAAayO,GAEX,IAFoB,IAAD,OACfgW,EAAQ,GADO,aAEd,2BAAOpa,EAAP,KAAcnQ,EAAd,KACH,IAAKA,EAAKwqB,KACR,iBAEF,IAAIC,EAAa,EAAK/mB,MAAMoP,WAAW9G,SAASmE,GAC1CuF,EAAc,WACd,EAAKhS,MAAMoP,WAAW9G,SAASmE,GACjC,EAAKzM,MAAMoP,WAAW6C,IAAI,EAAKjS,MAAMoP,WAAWmI,QAAQ9K,IAExD,EAAKzM,MAAMoP,WAAWzH,KAAK8E,GAE7B,EAAKnM,SAAS,EAAKN,QAGjBqS,EACF,cAAC,IAAD,CACExS,MAAO,CAAE4S,OAAQ,WACjBF,QAASP,IAGT/O,EAAQ,GACR8jB,IACF1U,EACE,cAAC,IAAD,CACExS,MAAO,CAAE4S,OAAQ,WACjBF,QAASP,IAGb/O,EAAQ3G,EAAK2G,OAEf,IAAI+jB,EACF,cAAC7M,GAAA,EAAD,UACE,eAACA,GAAA,EAAKE,KAAN,WACE,eAACF,GAAA,EAAKmB,MAAN,WACG7O,EADH,IACW4F,KAEVpP,MALM,cAAgBwJ,GAS7Boa,EAAMlf,KAAK,CAAErL,KAAM,CAAEgL,OAAQ,SAAW+e,QAASW,KAxCnD,MAA4B7e,OAAOtG,QAAQgP,GAA3C,eAAoD,IA0CpD,OAAOgW,I,oBAGT,WAAU,IAAD,OACHhF,EAAO,GACPhR,EAAS,CACX,kBAAmB,GACnB,4BAA6B,GAC7B,qBAAsB,GACtBoW,OAAQ,GACR,kDAAmD,IAOrD,GALA9e,OAAOtG,QAAQgP,GAAQpQ,SAAQ,SAACb,GAC9BA,EAAE,GAAGknB,MAAO,EACZlnB,EAAE,GAAGqD,MAAQ,MAGXpG,KAAKmD,MAAM6hB,KAAM,qBAGYhlB,KAAKmD,MAAM6hB,KAAKhgB,WAH5B,mDAGPqlB,EAHO,KAGIhT,EAHJ,KAIjB,EAA0C,EAAKiT,aAC7CjT,EAAI4N,UAAUC,MACd7N,EAAIkP,cAFN,oBAAOgE,EAAP,KAAmB3B,EAAnB,KAIMD,EAAS4B,EAAW3qB,KAAI,SAACmD,GAAD,OAAOA,EAAEymB,WAEnCxD,EAAY,GAGZ3O,EAAI2O,iBAC0BhnB,IAA5BqY,EAAI2O,UAAUA,UAChBA,EAAYA,EAAUwE,OAAO,EAAKC,sBAAsBpT,IAExD2O,EAAUlb,KACR,8BACE,kFADF,mBAAsBuM,EAAI+N,eAQhCY,EAAYA,EAAUwE,OACpB,EAAKE,kBAAkBrT,EAAKuR,IAI9B,IAAI+B,EAAmB,wBACnB3E,EAAUzgB,OAAS,IACrBolB,EACE,sBAAK3nB,MAAO,CAAEoL,QAAS,OAAvB,UACE,2CACC4X,MAKP,IAAI4E,EAAgB,wBAChBjC,EAAOpjB,OAAS,IAClBqlB,EAAgB,qBAAK5nB,MAAO,CAAEoL,QAAS,OAAvB,SAAiCua,KAInD,IAAM/Y,EAAQyH,EAAI0O,YAAYE,SAAS3hB,KACjC6lB,EACJ,cAAC7M,GAAA,EAAD,UACE,eAACA,GAAA,EAAKE,KAAN,CACExa,MAAO,CACLuN,gBACiB,YAAf8G,EAAI5M,OAAuB,mBAAqB,MAHtD,UAME,cAAC6S,GAAA,EAAKmB,MAAN,UACE,mBAAG7Y,KAAMyR,EAAI0O,YAAYlnB,IAAzB,SAA+B+Q,MAEjC,gCACGgb,EACAD,SAZI,QAAUN,GA0CnBza,KAASoE,GACXA,EAAOpE,GAAOqa,MAAO,EACjB,EAAK9mB,MAAMoP,WAAW9G,SAASmE,KACjCoE,EAAOpE,GAAOqa,MAAO,EACrBjW,EAAOpE,GAAOxJ,MAAM0E,KAAKqf,KAI3BnF,EAAKla,KAAK,CAAErL,KAAM4X,EAAKmS,QAASW,KAhGpC,2BAA2D,IAHxC,+BA0GrBnF,EAAOA,EAAKwF,OAAOxqB,KAAK6qB,aAAa7W,IAErC,IAAIoQ,EAAU,KAOd,GANIpkB,KAAKmD,MAAM4hB,cACbX,EAAU,oBAAGphB,MAAO,CAAE2K,MAAO,OAAnB,cAA8B3N,KAAKmD,MAAM4hB,iBACzC/kB,KAAKmD,MAAMwH,SACrByZ,EAAU,0EAGRpkB,KAAKmD,MAAMijB,SAAU,CAAC,IAAD,gBACFpmB,KAAKmD,MAAMijB,UADT,IACvB,2BAA0C,CAAC,IAAhC3b,EAA+B,QACnCA,EAAOsX,UAAUtW,SAAS,yBAG/BuZ,EAAKla,KAAK,CACRrL,KAAM,CACJgL,OAAQA,EAAOtH,OAEjBqmB,QAAS,cAAC,GAAD,CAAmC/e,OAAQA,GAAxBA,EAAOmX,YAThB,+BAczB,IAAIkJ,EAAc,GAClB,SAAS9gB,EAAImG,GAAO,IAAD,gBACC6U,GADD,IACjB,2BAAwB,CAAC,IAAd3N,EAAa,QAClBA,EAAI5X,KAAKgL,SAAW0F,IACtBkH,EAAI0T,MAAO,EACXD,EAAYhgB,KACV,qBAA+B9H,MAAO,CAAE0b,aAAc,OAAtD,SACGrH,EAAImS,SADGnS,EAAI5X,KAAK2lB,eALR,+BAYnBpb,EAAI,WACJA,EAAI,WACJA,EAAI,WACJA,EAAI,SACJA,EAAI,WAhKG,oBAkKWgb,GAlKX,IAkKP,2BAAwB,CAAC,IAAd3N,EAAa,QACjBA,EAAI0T,MACP9W,QAAQzU,MAAM,wBAAyB6X,EAAI5X,KAAKgL,SApK7C,8BA4KP,OAJIzK,KAAKmD,MAAM6hB,MAA8B,GAAtB8F,EAAYvlB,SACjCulB,EAAc,mBAAG9nB,MAAO,CAAEmT,WAAY,QAAxB,4BAId,gCACGnW,KAAKgrB,cACLhrB,KAAKirB,aACLjrB,KAAKkrB,aACL9G,EAEApkB,KAAKmrB,yBACN,8BAAML,W,GAv3ByB5kB,a,iBCtJlBklB,G,kDACnB,WAAYjrB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,GAFI,E,qDAKnB,WACEnD,KAAKqD,W,2BAGP,SAAcgoB,GACZ,IADsB,EAClBC,EAAS,CAAC,UAAW,UAAW,UAAW,UACzCC,EAAa,GACbC,EAAoB,GAEpBC,EAAa,SAACC,EAAUC,GAC5BJ,EAAWG,IAAY,EACvBH,EAAWI,IAAY,EAClBH,EAAkBE,KACrBF,EAAkBE,GAAY,IAE3BF,EAAkBE,GAAUC,KAC/BH,EAAkBE,GAAUC,GAAY,GAE1CH,EAAkBE,GAAUC,IAAa,GAdrB,cAiBHN,GAjBG,IAiBtB,2BAA6B,CAAC,IAAnBnhB,EAAkB,QACvB2V,EAAW,GACf,IAAK,IAAMxV,KAAYH,EAAKwF,MAAO,CACjC,IAAM5O,EAAMoJ,EAAKwF,MAAMrF,GACnBvJ,EAAI2J,SAA0C,IAAhC6gB,EAAO5Q,QAAQ5Z,EAAI2J,SACnCoV,EAAS/U,KAAKT,GAIlB,cAAuBwV,EAAvB,eAAiC,CAA5B,IAA4B,EAAtB6L,EAAQ,KAAc,cACR7L,GADQ,IAC/B,2BAAiC,CAC/B4L,EAAWC,EADoB,UADF,iCA1Bb,8BAiCtB,IAjCsB,EAiChBE,EAAYtgB,OAAOC,KAAKggB,GAAYtmB,OAEpC4mB,EAAa,GAnCG,cAoCFD,GApCE,IAoCtB,2BAA+B,CAAC,IAAD,EAApBE,EAAoB,QACvBC,EAAM,GADiB,cAETH,GAFS,IAE7B,2BAA+B,CAAC,IAArBI,EAAoB,QACzBR,EAAkBM,IAAUN,EAAkBM,GAAOE,GACvDD,EAAIjhB,KAAK0gB,EAAkBM,GAAOE,IAElCD,EAAIjhB,KAAK,IANgB,8BAS7B+gB,EAAW/gB,KAAKihB,IA7CI,8BAgDtB,MAAO,CAACH,EAAWC,K,2DAGrB,gCAAA9sB,EAAA,6DACQqiB,EAAO,mDADf,KAGe/Y,KAHf,SAIYsQ,MAAM,GAAD,OAAIyI,EAAJ,eAAuB,CAAE6K,MAAO,aAAc7sB,MAAK,SAACL,GAAD,OAC5DA,EAAE+R,UALV,oCAGoBxI,MAHpB,gBAEQ7I,EAFR,CAGIysB,UAHJ,MASQ5F,EAAW7mB,EAAKysB,UAAUtsB,KAAI,SAACkB,GACnC,OAAO6X,MAAM,GAAD,OAAIyI,EAAJ,YAAYtgB,EAAIoR,GAAhB,UAA2B9S,MAAK,SAACE,GAAD,OAAOA,EAAEsZ,aAVzD,KAY4B5Y,KAZ5B,UAaUqb,QAAQ8Q,WAAW7F,GAb7B,oBAYEtmB,KAAKmD,MAAMipB,aAZb,KAYiCC,cAZjC,gBAeErsB,KAAKyD,SAAShE,GAfhB,iD,mFAkBA,SAAgBkiB,EAAO2K,EAAwBzI,GAC7C,IAAQ0I,EAAe1I,EAAf0I,WACR,EAAa5K,EAAMliB,KAAK,GAAG+sB,MAAMnW,MAAM,MAAvC,oBAAKtX,EAAL,KAAQ0G,EAAR,KACA,MAAM,oDAAN,OAGc8mB,EAHd,iQAUUxtB,EAVV,6CAYU0G,EAZV,4XAmB+Dkc,EAAMliB,KAAK,GAAGkO,MAnB7E,oEAoB+CgU,EAAMliB,KAAK,GAAGiQ,MApB7D,4F,gCA4BF,WACE,GAAK1P,KAAKmD,MAAMipB,aAAhB,CAIA,IAAMK,EAAKC,SAASC,eAAe,oBACnC,eAAqC3sB,KAAKmD,MAAMipB,aAAhD,GAAKR,EAAL,KAAgBJ,EAAhB,KACAiB,EAAGG,UAAY,GACf,IAAM9tB,EAAU,CACd+tB,iBAAiB,EACjBC,MAAO,CACLN,MAAO,CACLO,UAAW,SAAChuB,EAAG0G,GAAJ,MAAU,MAGzBunB,MAAO,CACLR,MAAO,CACLO,UAAW,SAAChuB,EAAG0G,GAAJ,MAAU,MAGzBwnB,QAAS,CACPC,SAAUltB,KAAKmtB,kBAGf1tB,EAAO,CACT2tB,WAAY,CACVrqB,EAAG6oB,EACHviB,EAAGuiB,GAELyB,OAAQ7B,GAEV8B,KAAMC,aAAa,CAAEd,KAAIhtB,OAAMX,e,oBAGjC,WACE,OACE,gCACE,qDACA,qBACEoT,GAAG,mBACHlP,MAAO,CAAEkE,MAAO,QAASgJ,OAAQ,kB,GAtJQhK,aCA9BsnB,G,kDACnB,WAAYrtB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,GAFI,E,qDAInB,WACEnD,KAAKqD,W,2DAEP,4BAAAtE,EAAA,kEAEsBsJ,KAFtB,SAGYsQ,MACJ,2DACA,CAAEsT,MAAO,aACT7sB,MAAK,SAACL,GAAD,OAAOA,EAAE+R,UANtB,6BAE2BxI,MAF3B,gBACQ7I,EADR,CAEIguB,iBAFJ,MASEztB,KAAKyD,SAAShE,GAThB,gD,sFAYA,WACE,GAAKO,KAAKmD,MAAMsqB,iBAAhB,CAOA,IAJA,IAAMJ,EAAS,CACbK,MAAO,IAELniB,EAAO,CAAC,cAAe,SAAU,WACrC,MAAkBA,EAAlB,eAAwB,CACtB8hB,EADY,MACE,GAEhBrtB,KAAKmD,MAAMsqB,iBAAiBxoB,MAAK,SAAClG,EAAG0G,GACnC,OAAO1G,EAAE4uB,aAAeloB,EAAEkoB,gBAZT,oBAcA3tB,KAAKmD,MAAMsqB,kBAdX,IAcnB,2BAAgD,CAAC,IAAtC1X,EAAqC,QAC9CsX,EAAOK,MAAM5iB,KAAK,IAAIpK,KAAyB,IAApBqV,EAAK4X,cAAqBvsB,kBADP,oBAE5BmK,GAF4B,IAE9C,2BAAwB,CAAC,IAAda,EAAa,QACtBihB,EAAOjhB,GAAKtB,KAAKiL,EAAK3J,IAAQ,IAHc,gCAd7B,8BAqBnB,IADA,IAAMwhB,EAAc,GACpB,MAAkBriB,EAAlB,eAAwB,CAAnB,IAAMa,EAAG,KACZwhB,EAAY9iB,KAAK,CACfxG,KAAM8H,EACN3M,KAAM4tB,EAAOjhB,KAGjB,IAAM3M,EAAO,CACX2tB,WAAYC,EAAOK,MACnBL,OAAQO,GAGJnB,EAAKC,SAASC,eAAe,SACnCF,EAAGG,UAAY,GAEfU,KAAMO,UAAU,CAAEpB,KAAIhtB,OAAMX,QADZ,Q,oBAIlB,WACE,OACE,gCACE,uDACA,qBAAKoT,GAAG,QAAQlP,MAAO,CAAEkE,MAAO,QAASgJ,OAAQ,kB,GA9DPhK,aCE5C4nB,GACG,UADHA,GAEI,UAFJA,GAGC,UAHDA,GAIE,UAJFA,GAKG,mBAGHC,G,kDACJ,WAAY5tB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACX6qB,MAAO,IAET,EAAKC,OAASrR,IAAMC,YALH,E,qDAQnB,WACE7c,KAAKqD,W,gCAGP,WACE,IAEM6qB,EAFMluB,KAAKiuB,OAAOzR,QAER2R,WAAW,MAC3BD,EAAIE,YACJ,IALmB,EAKbC,EAAS,CACbC,QAASR,GACT9Q,QAAS8Q,GACTtuB,MAAOsuB,GACPS,QAAST,GACTU,UAAWV,GACXW,QAASX,GACTY,OAAQZ,GACRa,QAASb,IAbQ,cAeS9tB,KAAKmD,MAAMijB,SAASphB,WAf7B,IAenB,2BAA2D,CAAC,IAAD,4BAA/CjC,EAA+C,KAA5CqjB,EAA4C,mBAC/BA,EAASphB,WADsB,IACzD,2BAA8C,CAAC,IAAD,0BAAlCqE,EAAkC,KAA/BoB,EAA+B,KACtCmkB,EAAOP,EAAO5jB,GACfmkB,GACH3a,QAAQzU,MAAM,UAAWiL,GAE3ByjB,EAAIW,UAAYD,EAChBV,EAAIY,SAASzlB,EAAGtG,EAAG,EAAG,IAPiC,gCAfxC,iC,2DA2BrB,oEAAAhE,EAAA,6DACQF,EADR,uDAC8DmB,KAAKG,MAAM6S,KADzE,YACiFhT,KAAKG,MAAM8S,KAD5F,YACoGjT,KAAKG,MAAMyY,MAD/G,SAEqBD,MAAM9Z,GAF3B,cAEQkwB,EAFR,gBAGqBA,EAAKnW,OAH1B,OAGQnZ,EAHR,OAIM6U,EAAW,GACX0a,EAAS,GALf,cAMuBvvB,GANvB,IAME,2BAA2B,CAAhBkL,EAAgB,QACrBskB,EAAa,GADQ,cAEPtkB,EAAOT,MAFA,IAEzB,2BAAWpJ,EAAoB,QAC7BwT,EAASxT,EAAIwD,OAAQ,EACrB2qB,EAAWnuB,EAAIwD,MAAQxD,EAJA,8BAMzBkuB,EAAOlkB,KAAKmkB,IAZhB,8BAiBE,KAHA3a,EAAWhJ,OAAOC,KAAK+I,IACdrP,OACLmhB,EAAW,GACf,MAAqB4I,EAArB,eAA6B,CAAlBrkB,EAAkB,KACvBukB,EAAiB,GADM,cAEL5a,GAFK,IAE3B,2BAAWxM,EAAqB,QAC1B2C,EAAS,UACTE,EAAO7C,KACT2C,EAASE,EAAO7C,GAAS2C,QAE3BykB,EAAepkB,KAAKL,GAPK,8BAS3B2b,EAAStb,KAAKokB,GAEhBlvB,KAAKyD,SAAS,CAAE2iB,SAAUA,IA5B5B,iD,0EA+BA,WACE,IAAI6H,EAAS,KAUb,OATIjuB,KAAKmD,MAAMijB,UAAYpmB,KAAKmD,MAAMijB,SAAS7gB,OAAS,IACtD0oB,EACE,wBACE/d,OAAO,MACPhJ,MAAOlH,KAAKmD,MAAMijB,SAAS,GAAG7gB,OAC9BmY,IAAK1d,KAAKiuB,UAKd,sBACEjrB,MAAO,CACLmsB,OAAQ,oBACRC,aAAc,MACdhhB,QAAS,OACToI,OAAQ,MACRyC,QAAS,OACToW,iBAAkB,WAClBzoB,UAAW,UARf,UAWE,iCACE,oBAAGhB,KAAI,6BAAwB5F,KAAKG,MAAM6S,KAAnC,YAA2ChT,KAAKG,MAAM8S,MAA7D,UACGjT,KAAKG,MAAM6S,KADd,IACqBhT,KAAKG,MAAM8S,QAEhC,mBACEjQ,MAAO,CAAEmP,WAAY,OACrBvM,KAAI,cAAS5F,KAAKG,MAAM6S,KAApB,YAA4BhT,KAAKG,MAAM8S,KAAvC,YAA+CjT,KAAKG,MAAMsS,QAFhE,SAIGzS,KAAKG,MAAMsS,YAGhB,8BACE,mBACE7M,KAAI,cAAS5F,KAAKG,MAAM6S,KAApB,YAA4BhT,KAAKG,MAAM8S,KAAvC,YAA+CjT,KAAKG,MAAMsS,QADhE,SAGGwb,a,GA7Ge/nB,aAqHPopB,G,kDACnB,WAAYnvB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACX6qB,MAAO,IAHQ,E,qDAOnB,WACEhuB,KAAKqD,W,iEAGP,WAAmB4Y,GAAnB,qBAAAld,EAAA,sEACqBid,GAAGC,EAAQ,oBADhC,cACMlc,EADN,OAEMqG,EAAQ,GACRrG,EAAO2mB,iBAAiB6I,iBACtBC,EAAUzvB,EAAO2mB,iBAAiB6I,eAClC/U,MAAMC,QAAQ+U,GAChBppB,EAAQA,EAAMokB,OAAOgF,EAAQ5vB,KAAI,SAACmW,GAAD,OAAUA,EAAK6Q,OAAO9L,gBAEvD1U,EAAM0E,KAAK0kB,EAAQ5I,OAAO9L,cAG1B/a,EAAO2mB,iBAAiB+I,WACtB7Q,EAAQ7e,EAAO2mB,iBAAiB+I,SAChCjV,MAAMC,QAAQmE,GAChBxY,EAAQA,EAAMokB,OAAO5L,EAAMhf,KAAI,SAACmW,GAAD,OAAUA,EAAKgT,IAAIjO,gBAGlD1U,EAAM0E,KAAK8T,EAAMmK,IAAIjO,cAjB3B,kBAoBS1U,GApBT,2C,kHAuBA,uCAAArH,EAAA,sEAEsBiB,KAAK0vB,aAAa,OAFxC,cAEQC,EAFR,OAGQrJ,EAAWqJ,EAAM/vB,KAAI,SAACoT,GAC1B,OAAO,sBAAC,4BAAAjU,EAAA,sEACiB,EAAK2wB,aAAa1c,GADnC,cACAwT,EADA,gBAGOnL,QAAQvb,IACnB0mB,EAAS5mB,KAAI,SAACqT,GAAD,OAAU,EAAKyc,aAAazc,OAJrC,kFAAD,MAJX,SAYoBoI,QAAQvb,IAAIwmB,GAZhC,OAYM0H,EAZN,OAaEhuB,KAAKyD,SAAS,CAAEuqB,MAAOA,EAAM4B,SAb/B,gD,0EAgBA,WACE,IADO,EAEHC,EAAW,GAFR,cAGY7vB,KAAKmD,MAAM6qB,OAHvB,IAGP,2BAAqC,CAAC,IAAD,EAA1B/a,EAA0B,QAC7B1E,EAAQ0E,EAAK,GAAG1E,MAAM,oBACtByE,EAAOzE,EAAM,GACbuhB,EAAWvhB,EAAM,GAHY,cAId0E,GAJc,IAInC,2BAA2B,CAAC,IACpB8c,EADmB,QACExhB,MAAM,oBAC3ByhB,EAAaD,EAAY,GAC5BhvB,QAAQ,IAAK,KACbA,QAAQ,QAAS,IACpB8uB,EAAS/kB,KACP,cAAC,GAAD,CAEEkI,KAAMA,EACNC,KAAM6c,EACNrd,OAAQud,EACRpX,KAAMmX,EAAY,IALpB,iBACiBD,EADjB,YAC6BE,MAXE,gCAH9B,8BAuBP,OACE,gCACE,yDACA,gFACkD,IAChD,cAAC,IAAD,CAEEjiB,QAAQ,8FACRC,gBAAiB,EACjBC,UAAU,WACVC,qBAAsB,CAAEkI,YAAY,GALtC,SAOE,sBAAMpT,MAAO,CAAE2K,MAAO,UAAWiI,OAAQ,WAAzC,SACE,cAAC,IAAD,OAPE,WAWR,qBAAK5S,MAAO,CAAEiW,QAAS,OAAQgX,SAAU,QAAzC,SAAoDJ,W,GA3FhB3pB,a,IC7GvB0e,G,kDACnB,WAAYzkB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACX+sB,KAAM,IAHS,E,qDAOnB,WACElwB,KAAKqD,W,2DAGP,4BAAAtE,EAAA,yDACOmJ,aAAaC,QAAQ,UAD5B,uBAII8L,QAAQmD,IAAI,mCAJhB,0CAOyBwE,GAAOE,YAnC1B,yRA4BN,YAOQzc,EAPR,QAQe2gB,OARf,wBASI/L,QAAQzU,MAAM,wBACdyU,QAAQzU,MAAMH,GAVlB,2BAaEW,KAAKmD,MAAM+sB,KAAO7wB,EAASI,KAAK0wB,OAAOjL,MAEvCllB,KAAKyD,SAASzD,KAAKmD,OAfrB,iD,6EAkBA,SAAUitB,GACR,OACE,sBAAKxvB,UAAU,SAAf,UACE,mBAAGgF,KAAK,kEAAR,kBAEK,IACJwqB,EAAMxgB,MAJT,KAIiB,oBAAGhK,KAAMwqB,EAAMvxB,IAAf,cAAsBuxB,EAAMvgB,UAJ7C,S,oBASJ,WACE,IAAKyI,OAAOC,SAAS3S,KAAK6F,SAAS,mBACjC,OAAO,KAET,IAJO,EAID4kB,EAAerwB,KAAKmD,MAAM+sB,KAC1BI,EAAe,GALd,cAMoBD,EAAarrB,WANjC,IAMP,2BAAmD,CAAC,IAAD,0BAAvCmF,EAAuC,KAAhComB,EAAgC,KACjDD,EAAaxlB,KAAK,8BAA2B9K,KAAKwwB,UAAUD,IAA1C,cAAiBpmB,MAP9B,8BAUP,OAAO,8BAAMmmB,Q,GAnDsBpqB,a,mBCdlBuqB,G,kDACnB,WAAYtwB,GAAQ,IAAD,8BACjB,cAAMA,IACDgD,MAAQ,CACXutB,UAAU,GAHK,E,0CAOnB,WAAU,IAAD,OACHC,EAAO,KA+EX,OA9EI3wB,KAAKmD,MAAMutB,WACbC,EACE,gCACE,qBAAI/vB,UAAU,OAAd,UACE,4CACA,6BACE,cAACgwB,GAAA,EAAD,CAAMC,GAAG,yBAAT,qBAEF,6BACE,cAACD,GAAA,EAAD,CAAMC,GAAG,0BAAT,sBAEF,6BACE,cAACD,GAAA,EAAD,CAAMC,GAAG,wBAAT,oBAEF,6BACE,cAACD,GAAA,EAAD,CAAMC,GAAG,yBAAT,0BAEF,6BACE,cAACD,GAAA,EAAD,CAAMC,GAAG,gDAAT,oCAKJ,qBAAIjwB,UAAU,kBAAd,UACE,4CACC,CACC,UAGA,gBACAhB,KAAI,SAAC2J,GAAD,OACJ,cAAC,WAAD,UACG,CAAC,SAAU,gBAAgB3J,KAAI,SAACkxB,GAAD,OAC9B,+BACE,eAACF,GAAA,EAAD,CAAMC,GAAI,WAAatnB,EAAI,IAAMunB,EAAjC,UACGvnB,EADH,IACOunB,KAFT,SAKE,cAACF,GAAA,EAAD,CAAMC,GAAI,WAAatnB,EAAI,IAAMunB,EAAU,aAA3C,kBALF,IASE,cAACF,GAAA,EAAD,CAAMC,GAAI,WAAatnB,EAAI,IAAMunB,EAAU,aAA3C,kBAGO,YAANvnB,GAA+B,WAAZunB,EAClB,eAAC,WAAD,eAEE,cAACF,GAAA,EAAD,CACEC,GAAI,WAAatnB,EAAI,IAAMunB,EAAU,eADvC,uBAOF,cAAC,WAAD,IAtBJ,MAASvnB,EAAI,IAAMunB,OAFRvnB,MA+BjB,cAAC,WAAD,UACE,6BACE,cAACqnB,GAAA,EAAD,CAAMC,GAAI,6BAAV,mCAFU,yBAQhB,oBAAIjwB,UAAU,OAAd,SACE,6BACE,cAACgwB,GAAA,EAAD,CAAMC,GAAG,UAAT,4BAOR,sBAAKjwB,UAAU,kBAAf,UACE,sBAAKA,UAAU,QAAf,UACE,sBAAKoC,MAAO,CAAEiW,QAAS,UAAvB,UACE,mBAAGjW,MAAO,CAAEmT,WAAY,QAAUvQ,KAAK,0BAAvC,4BAGA,qBAAI5C,MAAO,CAAEiW,QAAS,UAAYrY,UAAU,OAA5C,UACG,CAAC,WAAWhB,KAAI,SAAC2J,GAAD,OACf,cAAC,WAAD,UACG,CAAC,SAAU,gBAAiB,UAAW,gBAAgB3J,KACtD,SAAC6S,GAAD,OACE,6BACE,cAACme,GAAA,EAAD,CAAMC,GAAE,8BAAyBpe,GAAjC,SACGA,KAFL,UAAYA,QAHHlJ,MAYjB,6BACE,mBAAG3D,KAAK,8BAAR,uBAEF,6BACE,mBAAGA,KAAK,YAAR,wBAEF,6BACE,mBACEA,KAAK,OACL8P,QAAS,SAACnM,GAIR,OAHAA,EAAE0I,iBACF,EAAK9O,MAAMutB,UAAY,EAAKvtB,MAAMutB,SAClC,EAAKjtB,SAAS,EAAKN,QACZ,GANX,SASGnD,KAAKmD,MAAMutB,SAAW,OAAS,iBAKxC,qBACE1tB,MAAO,CACLiW,QAAS,SACT9G,WAAY,OACZ8U,YAAa,OAJjB,SAOE,qBAAIjkB,MAAO,CAAE0b,aAAc,KAAO9d,UAAU,OAA5C,UACE,6BACE,mBAAGgF,KAAK,gEAAR,oBAIF,6BACE,mBAAGA,KAAK,wHAAR,wBAIF,6BACE,cAAC,GAAD,MAEF,6BACE,mBACE5C,MAAO,CAAE2K,MAAO,SAChB/H,KAAK,4CAFP,SAIE,cAAC,KAAD,gBAMT+qB,S,GAlK0BzqB,a,wCC2J7B6qB,GAAS,kBACb,gCACE,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,EAAD,CAAcxwB,SAAU,MACxB,cAAC,EAAD,CAAiBA,SAAU,UAIzBywB,GAAuB,WAC3B,OAAO,cAAC,GAAD,KAGHC,GAAe,WAGnB,OAFA/oB,aAAa8Q,WAAW,UACxB/E,QAAQmD,IAAI,cACL,cAAC8Z,GAAA,EAAD,CAAUL,GAAG,OAGhBM,GAAQ,SAAC,GAAe,IAAb5iB,EAAY,EAAZA,MAETgN,EAAQ,IAAIY,gBAAgB7D,OAAOC,SAAS4X,QAClD,OACE,cAAC,EAAD,CACE5vB,SAAU,IACVO,IAAKyN,EAAM1P,IAAIkC,QAAQ,aAAc,IACrCsK,KAAMkQ,EAAMrc,IAAI,WAKhBkyB,GAAS,SAAC,GAAe,IAAb7iB,EAAY,EAAZA,MAEVgN,EAAQ,IAAIY,gBAAgB7D,OAAOC,SAAS4X,QAClD,OACE,cAAC,EAAD,CACE5vB,SAAU,IACVO,IAAKyN,EAAM1P,IAAIkC,QAAQ,cAAe,IACtCsK,KAAMkQ,EAAMrc,IAAI,WAkBhBmyB,GAAgB,SAAC,GAAe,IAAb9iB,EAAY,EAAZA,MACvB,OAAO,kDAAqBA,EAAM1P,QAG9ByyB,GAAa,SAAbA,EAAc,GAAD,IAAG/iB,EAAH,EAAGA,MAAH,OACjB,eAAC,WAAD,WACE,cAACgjB,GAAA,EAAD,CAAOC,OAAK,EAACC,KAAMljB,EAAM1P,IAAK6yB,UAAWP,KACzC,cAACI,GAAA,EAAD,CAAOE,KAAI,UAAKljB,EAAM1P,IAAX,aAA2B6yB,UAAWJ,QAI/CK,GAAc,SAAdA,EAAe,GAAD,IAAGpjB,EAAH,EAAGA,MAAH,OAClB,eAAC,WAAD,WACE,cAACgjB,GAAA,EAAD,CAAOC,OAAK,EAACC,KAAMljB,EAAM1P,IAAK6yB,UAAWN,KACzC,cAACG,GAAA,EAAD,CAAOE,KAAI,UAAKljB,EAAM1P,IAAX,aAA2B6yB,UAAWC,QAW/CC,GAAkB,SAAC,GAAD,IAAGrjB,EAAH,EAAGA,MAAH,OACtB,cAAC,WAAD,UACE,cAACgjB,GAAA,EAAD,CAAOC,OAAK,EAACC,KAAMljB,EAAM1P,IAAK6yB,UAAWza,QAI9B4a,GAnOH,kBACV,cAAC,KAAD,CAAQC,SAAmC,IAA3C,SACE,sBAAKlxB,UAAU,MAAf,UACE,cAAC,GAAD,IACA,sBAAKoC,MAAO,CAAEwT,OAAQ,KAAO5V,UAAU,YAAvC,UACE,cAAC,GAAD,IACA,eAACmxB,GAAA,EAAD,WACE,cAACR,GAAA,EAAD,CAAOE,KAAK,SAASC,UAAWJ,KAChC,cAACC,GAAA,EAAD,CAAOE,KAAK,UAAUC,UAAWC,KACjC,cAACJ,GAAA,EAAD,CACEE,KAAK,iCACLlI,OAAQ,SAACppB,GACP,OAAO,cAAC+wB,GAAA,EAAD,CAAUL,GAAE,cAAS1wB,EAAMoO,MAAMpP,OAAO6yB,cAGnD,cAACT,GAAA,EAAD,CACEE,KAAK,2CACLlI,OAAQ,SAACppB,GACP,OAAO,cAAC+wB,GAAA,EAAD,CAAUL,GAAE,kBAAa1wB,EAAMoO,MAAMpP,OAAO6yB,cAGvD,cAACT,GAAA,EAAD,CACEE,KAAK,mCACLlI,OAAQ,SAACppB,GACP,OAAO,cAAC+wB,GAAA,EAAD,CAAUL,GAAE,kBAAa1wB,EAAMoO,MAAMpP,OAAO6yB,cAGvD,cAACT,GAAA,EAAD,CACEE,KAAK,2BACLlI,OAAQ,SAACppB,GACP,IAAMob,EAAQ,IAAIY,gBAAgB7D,OAAOC,SAAS4X,QAC5ChxB,EAASgB,EAAMoO,MAAMpP,OAC3B,OACE,cAAC,GAAD,CACEoB,SAAU,IACV0S,KAAM9T,EAAO8T,KACbD,KAAM7T,EAAO6T,KACbP,OAAQtT,EAAOsT,OACfZ,cAAe0J,EAAMrc,IAAI,oBAKjC,cAACqyB,GAAA,EAAD,CACEE,KAAK,YACLlI,OAAQ,WACN,OAAO,cAAC,GAAD,OAGX,cAACgI,GAAA,EAAD,CACEE,KAAK,0BACLlI,OAAQ,SAACppB,GACP,IAAMhB,EAASgB,EAAMoO,MAAMpP,OAC3B,OACE,cAAC,GAAD,CACE0lB,UAAW1lB,EAAO0Q,OAClBmD,KAAM7T,EAAO6T,KACbC,KAAM9T,EAAO8T,UAKrB,cAACse,GAAA,EAAD,CACEE,KAAK,cACLlI,OAAQ,SAACppB,GACP,OACE,cAAC+wB,GAAA,EAAD,CACEL,GAAE,8BAAyB1wB,EAAMoO,MAAMpP,OAAO0Q,aAKtD,cAAC0hB,GAAA,EAAD,CACEE,KAAK,8BACLlI,OAAQ,SAACppB,GACP,IAAMhB,EAASgB,EAAMoO,MAAMpP,OAC3B,OACE,cAAC,GAAD,CACE2lB,YAAa3lB,EAAOwL,OACpBqI,KAAM7T,EAAO6T,KACbC,KAAM9T,EAAO8T,UAKrB,cAACse,GAAA,EAAD,CACEE,KAAK,kBACLlI,OAAQ,SAACppB,GACP,OACE,cAAC+wB,GAAA,EAAD,CACEL,GAAE,kCAA6B1wB,EAAMoO,MAAMpP,OAAOwL,aAK1D,cAAC4mB,GAAA,EAAD,CACEE,KAAK,mBACLlI,OAAQ,SAACppB,GACP,IAAMsS,EAAStS,EAAMoO,MAAMpP,OAAO6yB,QAAQjxB,QAAQ,WAAY,IAC9D,OAAO,cAACmwB,GAAA,EAAD,CAAUL,GAAE,8BAAyBpe,QAGhD,cAAC8e,GAAA,EAAD,CACEE,KAAK,mBACLlI,OAAQ,SAACppB,GACP,IAAMsS,EAAStS,EAAMoO,MAAMpP,OAAO6yB,QAAQjxB,QAAQ,WAAY,IAC9D,OAAO,cAACmwB,GAAA,EAAD,CAAUL,GAAE,8BAAyBpe,QAGhD,cAAC8e,GAAA,EAAD,CAAOE,KAAK,yBAAyBC,UAAWE,KAChD,cAACL,GAAA,EAAD,CAAOE,KAAK,iBAAiBC,UAAWT,KACxC,cAACM,GAAA,EAAD,CAAOE,KAAK,oBAAoBC,UAAWV,KAC3C,cAACO,GAAA,EAAD,CAAOE,KAAK,UAAUC,UAAWX,KACjC,cAACQ,GAAA,EAAD,CAAOC,OAAK,EAACC,KAAK,IAAlB,SACE,cAACP,GAAA,EAAD,CAAUL,GAAG,6BAEf,cAACU,GAAA,EAAD,CAAOE,KAAK,IAAID,OAAO,EAAME,UAAWL,iBCtIlDY,IAAS1I,OAAO,cAAC,GAAD,IAASmD,SAASC,eAAe,U","file":"static/js/main.ef18b324.chunk.js","sourcesContent":["// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport axios from \"axios\";\n\nexport class Jenkins {\n  url(s) {\n    return \"https://ci.pytorch.org/jenkins/\" + s + \"/api/json\";\n  }\n  link(s) {\n    return \"https://ci.pytorch.org/jenkins/\" + s;\n  }\n\n  async get(url, options) {\n    if (options === undefined) options = {};\n    var r;\n    await axios\n      .get(url, { params: options })\n      .then((response) => {\n        r = response;\n      })\n      .catch((error) => {\n        // console.log(\"error.response: \", error.response)\n      });\n    if (typeof r !== \"undefined\") {\n      return r.data;\n    } else {\n      return null;\n    }\n  }\n\n  async batch_get(urls, options) {\n    if (options === undefined) options = {};\n    let r;\n    let requests = urls.map((url) => {\n      return axios.get(url, { params: options }).then(\n        (response) => ({ response }),\n        (err) => ({ err })\n      );\n    });\n\n    await axios\n      .all(requests)\n      .then((response) => {\n        r = response;\n      })\n      .catch((error) => {\n        // console.log(\"error.response: \", error.response)\n      });\n    if (typeof r !== \"undefined\") {\n      return r.map((result) => {\n        if (result.response) {\n          return result.response.data;\n        }\n        return null;\n      });\n    } else {\n      return null;\n    }\n  }\n\n  async computer(options) {\n    return this.get(this.url(\"computer\"), options);\n  }\n  async queue(options) {\n    return this.get(this.url(\"queue\"), options);\n  }\n  async job(v, options) {\n    return this.get(this.url(\"job/\" + v), options);\n  }\n}\n\nconst jenkins = new Jenkins();\nexport default jenkins;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Fragment } from \"react\";\n\nexport default function AsOf(props) {\n  const updateStatus =\n    props.currentTime - props.updateTime > props.interval ? (\n      \"disconnected\"\n    ) : (\n      <Fragment>connected in {props.connectedIn}ms</Fragment>\n    );\n  const timeString =\n    props.updateTime - new Date(0) === 0 ? (\n      <Fragment>pending</Fragment>\n    ) : (\n      <Fragment>\n        as of {props.updateTime.toLocaleTimeString()}; {updateStatus}\n      </Fragment>\n    );\n  return <span className={updateStatus}>({timeString})</span>;\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nexport function summarize_job(job) {\n  return job\n    .replace(/^pytorch-/, \"\")\n    .replace(/-trigger$/, \"\")\n    .replace(/^private\\//, \"\")\n    .replace(/^ccache-cleanup-/, \"\")\n    .replace(/_ci\\/circleci: /, \"\")\n    .replace(/AAA_/, \"\");\n}\n\nexport function summarize_date(timestamp) {\n  const date = new Date(timestamp);\n  const today = new Date();\n  if (today.toLocaleDateString() === date.toLocaleDateString()) {\n    return date.toLocaleString(\"en-US\", {\n      hour: \"numeric\",\n      minute: \"numeric\",\n      hour12: true,\n    });\n  } else {\n    return date.toLocaleString(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      weekday: \"short\",\n    });\n  }\n}\n\n// https://stackoverflow.com/questions/6312993/javascript-seconds-to-time-string-with-format-hhmmss\nexport function seconds2time(seconds) {\n  let hours = Math.floor(seconds / 3600);\n  let minutes = Math.floor((seconds - hours * 3600) / 60);\n  seconds = seconds - hours * 3600 - minutes * 60;\n  let time = \"\";\n\n  if (hours !== 0) {\n    time = hours + \":\";\n  }\n  if (minutes !== 0 || time !== \"\") {\n    minutes = minutes < 10 && time !== \"\" ? \"0\" + minutes : String(minutes);\n    time += minutes + \":\";\n  }\n  if (time === \"\") {\n    time = seconds + \"s\";\n  } else {\n    time += seconds < 10 ? \"0\" + seconds : String(seconds);\n  }\n  return time;\n}\n\nexport function summarize_ago(timestamp) {\n  const date = new Date(timestamp);\n  const today = new Date();\n  return seconds2time(Math.floor((today - date) / 1000));\n}\n\nexport function summarize_project(project) {\n  return project.replace(/-builds$/, \"\");\n}\n\nexport function summarize_url(url) {\n  let m;\n  if (\n    (m = RegExp(\n      \"^https://ci\\\\.pytorch\\\\.org/jenkins/job/([^/]+)/job/([^/]+)/\"\n    ).exec(url)) !== null\n  ) {\n    return summarize_project(m[1]) + \"/\" + summarize_job(m[2]);\n  }\n  if (\n    (m = RegExp(\"https://ci\\\\.pytorch\\\\.org/jenkins/job/([^/]+)/\").exec(\n      url\n    )) !== null\n  ) {\n    return m[1];\n  }\n  return url;\n}\n\n// Last updated 2018-03-01\nexport const centsPerHour = {\n  \"linux-cpu\": 17, // c5.xlarge\n  \"linux-bigcpu\": 68, // c5.4xlarge\n  \"linux-gpu\": 228, // g3.8xlarge\n  \"linux-tc-gpu\": 228, // g3.8xlarge\n  \"linux-multigpu\": 456, // g3.16xlarge\n  \"linux-cpu-ccache\": 17, // c5.xlarge\n  \"win-cpu\": 34, // c5.2xlarge\n  \"win-gpu\": 114, // g3.4xlarge\n  osx: 13900 / 30 / 24, // MacStadium mini i7 250 elite\n  master: 17, // c5.xlarge\n  packet: 40, // ???? Packet server ???\n  rocm: 0, // we don't pay for it\n  \"tc-gpu\": 114, // g3.4xlarge\n};\n\nexport function centsToDollars(x) {\n  if (x === undefined) return \"?\";\n  // I feel a little dirty resorting to floating point math\n  // here...\n  return (x / 100).toLocaleString(\"en-US\", {\n    style: \"currency\",\n    currency: \"USD\",\n  });\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport jenkins from \"./Jenkins.js\";\nimport AsOf from \"./AsOf.js\";\nimport {\n  summarize_ago,\n  summarize_url,\n  centsToDollars,\n  centsPerHour,\n} from \"./Summarize.js\";\n\nexport default class ComputerDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      computer: [],\n      currentTime: new Date(),\n      updateTime: new Date(0),\n      connectedIn: 0,\n    };\n  }\n  componentDidMount() {\n    this.update();\n    this.interval = setInterval(this.update.bind(this), this.props.interval);\n  }\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n  async update() {\n    const currentTime = new Date();\n    this.setState({ currentTime: currentTime });\n    const data = await jenkins.computer({\n      tree: `computer[\n                offline,\n                idle,\n                displayName,\n                assignedLabels[name],\n                executors[\n                  currentExecutable[\n                    timestamp,\n                    estimatedDuration,\n                    url,\n                    building\n                  ],\n                  idle\n                ]\n              ]`.replace(/\\s+/g, \"\"),\n    });\n    data.updateTime = new Date();\n    data.connectedIn = data.updateTime - currentTime;\n    this.setState(data);\n  }\n  render() {\n    function classify_node(n) {\n      const node = n.displayName;\n      if (/^c5.xlarge-i-.*$/.test(node)) {\n        return \"linux-cpu\";\n      }\n      if (/^c5.4xlarge-i-.*$/.test(node)) {\n        return \"linux-bigcpu\";\n      }\n      if (/^g3.8xlarge-i-.*$/.test(node)) {\n        if (n.assignedLabels.some((l) => l.name === \"tc_gpu\")) {\n          return \"linux-tc-gpu\";\n        } else {\n          return \"linux-gpu\";\n        }\n      }\n      if (/^g3.16xlarge-i-.*$/.test(node)) {\n        return \"linux-multigpu\";\n      }\n      if (/^worker-c5-xlarge-.*$/.test(node)) {\n        return \"linux-cpu-ccache\";\n      }\n      if (/^worker-macos-high-sierra-.*$/.test(node)) {\n        return \"osx\";\n      }\n      if (/^worker-win-c5.2xlarge-i-.*$/.test(node)) {\n        return \"win-cpu\";\n      }\n      if (/^worker-win-g3.4xlarge-i-.*$/.test(node)) {\n        return \"win-gpu\";\n      }\n      if (/^worker-osuosl-ppc64le-cpu-.*$/.test(node)) {\n        return \"ppc\";\n      }\n      if (/^worker-packet-type-1-.*$/.test(node)) {\n        return \"packet\";\n      }\n      if (/^jenkins-worker-rocm-.*$/.test(node)) {\n        return \"rocm\";\n      }\n      if (/^worker-g3-4xlarge-.*$/.test(node)) {\n        return \"tc-gpu\";\n      }\n      return node;\n    }\n\n    const map = new Map();\n    this.state.computer.forEach((c) => {\n      const k = classify_node(c);\n      let v = map.get(k);\n      if (v === undefined) v = { busy: 0, total: 0 };\n      if (!c.offline) {\n        v.total++;\n        if (!c.idle) v.busy++;\n      }\n      map.set(k, v);\n    });\n\n    let totalCost = 0;\n    map.forEach((v, k) => {\n      const perCost = centsPerHour[k];\n      if (perCost !== undefined) {\n        v.totalCost = perCost * v.total;\n        totalCost += v.totalCost;\n      }\n    });\n\n    const rows = [...map.entries()].sort().map((kv) => {\n      const cost = centsToDollars(kv[1].totalCost);\n      return (\n        <tr key={kv[0]}>\n          <th>{kv[0]}</th>\n          <td>\n            {kv[1].busy} / {kv[1].total}\n          </td>\n          <td className=\"ralign\">{cost}/hr</td>\n        </tr>\n      );\n    });\n\n    const busy_nodes = this.state.computer.filter(\n      (c) =>\n        !c.idle &&\n        c.displayName !== \"master\" &&\n        c.executors.length > 0 &&\n        c.executors[0].currentExecutable\n    );\n    busy_nodes.sort(\n      (a, b) =>\n        a.executors[0].currentExecutable.timestamp -\n        b.executors[0].currentExecutable.timestamp\n    );\n    const running_rows = busy_nodes.map((c) => {\n      const executable = c.executors[0].currentExecutable;\n      return (\n        <tr key={c.displayName}>\n          <td className=\"left-cell\">{summarize_ago(executable.timestamp)}</td>\n          <td>\n            <a href={executable.url}>{summarize_url(executable.url)}</a>\n          </td>\n        </tr>\n      );\n    });\n\n    const running_map = new Map();\n    busy_nodes.forEach((c) => {\n      const executable = c.executors[0].currentExecutable;\n      const task = summarize_url(executable.url);\n      let v = running_map.get(task);\n      if (v === undefined) {\n        v = { total: 0, cumulative_time: 0 };\n        running_map.set(task, v);\n      }\n      v.total++;\n\n      function delta_ago(timestamp) {\n        const date = new Date(timestamp);\n        const today = new Date();\n        return (today - date) / 1000;\n      }\n      v.cumulative_time += delta_ago(executable.timestamp);\n    });\n\n    /*\n    const running_summary = [...running_map.entries()].sort((a, b) => b[1].total - a[1].total).map(task_v => {\n      const task = task_v[0];\n      const v = task_v[1];\n      return <tr key={task}><td style={{textAlign: \"right\", paddingRight: 15}}>{v.total}</td><th>{task}</th></tr>\n    });\n\n    const cumulative_running_time_summary = [...running_map.entries()].sort((a, b) => b[1].cumulative_time - a[1].cumulative_time).map(task_v => {\n      const task = task_v[0];\n      const v = task_v[1];\n      return <tr key={task}><td style={{textAlign: \"right\", paddingRight: 15}}>{seconds2time(Math.floor(v.cumulative_time))}</td><th>{task}</th></tr>\n    });\n    */\n\n    return (\n      <div>\n        <h2>\n          Computers{\" \"}\n          <AsOf\n            interval={this.props.interval}\n            currentTime={this.state.currentTime}\n            updateTime={this.state.updateTime}\n            connectedIn={this.state.connectedIn}\n          />\n        </h2>\n        <table>\n          <tbody>\n            <tr>\n              <td>\n                <table>\n                  <tbody>{rows}</tbody>\n                  <tfoot>\n                    <tr>\n                      <td></td>\n                      <td className=\"ralign\" colSpan=\"2\">\n                        {centsToDollars(totalCost * 24 * 30)}/mo\n                      </td>\n                    </tr>\n                  </tfoot>\n                </table>\n              </td>\n              <td className=\"right-cell\">\n                <table>\n                  <tbody>{running_rows}</tbody>\n                </table>\n              </td>\n              {/*\n              <td className=\"right-cell\">\n                <table>\n                  <tbody>\n                    {running_summary}\n                  </tbody>\n                </table>\n              </td>\n              <td className=\"right-cell\">\n                <table>\n                  <tbody>\n                    {cumulative_running_time_summary}\n                  </tbody>\n                </table>\n              </td>\n              */}\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport jenkins from \"./Jenkins.js\";\nimport AsOf from \"./AsOf.js\";\nimport { summarize_url } from \"./Summarize.js\";\n\nexport default class QueueDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: [],\n      currentTime: new Date(),\n      updateTime: new Date(0),\n      connectedIn: 0,\n    };\n  }\n  componentDidMount() {\n    this.update();\n    this.interval = setInterval(this.update.bind(this), this.props.interval);\n  }\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n  async update() {\n    const currentTime = new Date();\n    this.setState({ currentTime: currentTime });\n    const data = await jenkins.queue();\n    data.updateTime = new Date();\n    data.connectedIn = data.updateTime - currentTime;\n    this.setState(data);\n  }\n  render() {\n    function summarize_why(why) {\n      return why\n        .replace(/^Waiting for next available executor on/, \"Needs\")\n        .replace(/docker&&cpu&&ccache/, \"linux-cpu-ccache\")\n        .replace(/[^ ]+cpu_ccache.+/, \"linux-cpu-ccache\")\n        .replace(/docker&&cpu&&!ccache/, \"linux-cpu\")\n        .replace(/docker&&cpu/, \"linux-cpu-any\")\n        .replace(/docker&&gpu/, \"linux-gpu\")\n        .replace(/docker&&bigcpu/, \"linux-bigcpu\")\n        .replace(/windows&&cpu/, \"windows-cpu\")\n        .replace(/windows&&gpu/, \"windows-gpu\")\n        .replace(/g3.8xlarge-i-[^ ]+/, \"linux-gpu\")\n        .replace(/g3.16xlarge-i-[^ ]+/, \"linux-multigpu\")\n        .replace(/worker-win-c5.2xlarge-i-[^ ]+/, \"windows-cpu\")\n        .replace(/worker-win-g3.4xlarge-i-[^ ]+/, \"windows-gpu\");\n    }\n\n    const why_map = new Map();\n    this.state.items.forEach((q) => {\n      const why = summarize_why(q.why);\n      let v = why_map.get(why);\n      if (v === undefined) {\n        v = { total: 0 };\n        why_map.set(why, v);\n      }\n      v.total++;\n    });\n\n    const why_rows = [...why_map.entries()].sort().map((why_v) => {\n      const why = why_v[0];\n      const v = why_v[1];\n      return (\n        <tr key={why}>\n          <td style={{ textAlign: \"right\", paddingRight: 15 }}>{v.total}</td>\n          <th>{why}</th>\n        </tr>\n      );\n    });\n\n    const task_map = new Map();\n    this.state.items.forEach((q) => {\n      const task = summarize_url(q.task.url);\n      let v = task_map.get(task);\n      if (v === undefined) {\n        v = { total: 0 };\n        task_map.set(task, v);\n      }\n      v.total++;\n    });\n\n    const task_map_max = 10;\n    const task_rows = [...task_map.entries()]\n      .sort((a, b) => b[1].total - a[1].total)\n      .slice(0, task_map_max)\n      .map((task_v) => {\n        const task = task_v[0];\n        const v = task_v[1];\n        return (\n          <tr key={task}>\n            <td style={{ textAlign: \"right\", paddingRight: 15 }}>{v.total}</td>\n            <th>{task}</th>\n          </tr>\n        );\n      });\n\n    return (\n      <div>\n        <h2>\n          Queue{\" \"}\n          <AsOf\n            interval={this.props.interval}\n            connectedIn={this.state.connectedIn}\n            currentTime={this.state.currentTime}\n            updateTime={this.state.updateTime}\n          />\n        </h2>\n        <table>\n          <tbody>\n            <tr>\n              <td\n                width={300}\n                style={{\n                  textOverflow: \"clip\",\n                  maxWidth: 300,\n                  overflow: \"hidden\",\n                }}\n              >\n                <table>\n                  <tbody>{why_rows}</tbody>\n                </table>\n              </td>\n              <td className=\"right-cell\" width={300}>\n                <table>\n                  <tbody>\n                    {task_rows}\n                    <tr>\n                      <td></td>\n                      <th>{task_map.size > task_map_max ? \"...\" : \"\"}</th>\n                    </tr>\n                  </tbody>\n                </table>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component, Fragment } from \"react\";\nimport jenkins from \"./Jenkins.js\";\nimport AsOf from \"./AsOf.js\";\nimport {\n  summarize_job,\n  summarize_date,\n  centsToDollars,\n  centsPerHour,\n} from \"./Summarize.js\";\nimport * as d3 from \"d3v4\";\nimport parse_duration from \"parse-duration\";\nimport Tooltip from \"rc-tooltip\";\n\nvar jobs_on_pr = [\n  \"_\",\n  \"setup\",\n  \"caffe2-py2-cuda9.0-cudnn7-windows\",\n  \"caffe2-py2-devtoolset7-rocmrpm-centos7.5\",\n  \"py3.6-clang7-rocmdeb-ubuntu16.04\",\n  \"win-ws2016-cuda9-cudnn7-py3\",\n\n  \"pytorch_linux_xenial_py2_7_9\",\n  \"pytorch_linux_xenial_cuda9_cudnn7_py3\",\n  \"pytorch_linux_xenial_py3_clang5_asan\",\n  \"pytorch_linux_xenial_py3_6_gcc5_4\",\n  \"pytorch_libtorch_linux_xenial_cuda9_cudnn7_py3\",\n\n  \"caffe2_py2_mkl_ubuntu16_04\",\n  \"caffe2_py3_5_cuda10_1_cudnn7_ubuntu16_04\",\n  \"caffe2_onnx_py2_gcc5_ubuntu16_04\",\n  \"caffe2_onnx_main_py3_6_clang7_ubuntu16_04\",\n  \"caffe2_onnx_ort1_py3_6_clang7_ubuntu16_04\",\n  \"caffe2_onnx_ort2_py3_6_clang7_ubuntu16_04\",\n  \"caffe2_py2_clang7_ubuntu16_04\",\n  \"caffe2_cmake_cuda9_0_cudnn7_ubuntu16_04\",\n  \"caffe2_py3_6_devtoolset7_cuda9_0_cudnn7_centos7\",\n\n  \"binary_linux_manywheel_2_7mu_cpu_devtoolset7\",\n  \"binary_linux_libtorch_2_7m_cpu_devtoolset7\",\n  \"binary_linux_libtorch_2_7m_cpu_gcc5_4_cxx11-abi\",\n  \"binary_linux_libtorch_2_7_cpu\",\n\n  \"caffe2_py2_android_ubuntu16_04\",\n  \"caffe2_py2_system_macos10_13\",\n  \"pytorch_macos_10_13_py3\",\n  \"pytorch_macos_10_13_cuda9_2_cudnn7_py3\",\n  \"pytorch-linux_xenial_py3_clang5_android_ndk_r19c_x86_32_build\",\n  \"pytorch-linux-xenial-py3-clang5-android-ndk-r19c-gradle-build-x86_32\",\n  \"pytorch_ios_10_2_1_x86_64_build\",\n  \"pytorch_ios_10_2_1_arm64_build\",\n\n  \"pytorch_linux_backward_compatibility_check_test\",\n\n  \"pytorch_xla_linux_xenial_py3_6_clang7\",\n\n  \"pytorch_python_doc_push\",\n  \"pytorch_cpp_doc_push\",\n];\n\nvar binary_and_smoke_tests_on_pr = [\n  \"binary_linux_manywheel_2_7mu_cpu_devtoolset7_build\",\n  \"binary_linux_manywheel_3_7m_cu100_devtoolset7_build\",\n  \"binary_linux_conda_2_7_cpu_devtoolset7_build\",\n  \"binary_macos_wheel_3_6_cpu_build\",\n  \"binary_macos_conda_2_7_cpu_build\",\n  \"binary_macos_libtorch_2_7_cpu_build\",\n  \"binary_linux_manywheel_2_7mu_cpu_devtoolset7_test\",\n  \"binary_linux_manywheel_3_7m_cu100_devtoolset7_test\",\n  \"binary_linux_conda_2_7_cpu_devtoolset7_test\",\n  \"binary_linux_libtorch_2_7m_cpu_devtoolset7_shared-with-deps_build\",\n  \"binary_linux_libtorch_2_7m_cpu_devtoolset7_shared-with-deps_test\",\n  \"binary_linux_libtorch_2_7m_cpu_gcc5_4_cxx11-abi_shared-with-deps_build\",\n  \"binary_linux_libtorch_2_7m_cpu_gcc5_4_cxx11-abi_shared-with-deps_test\",\n];\n\n// TODO: checks also supports neutral and action_required\n\nfunction is_success(result) {\n  return result === \"SUCCESS\" || result === \"success\";\n}\n\nfunction is_failure(result) {\n  // TODO: maybe classify timeout differently\n  return (\n    result === \"FAILURE\" ||\n    result === \"failure\" ||\n    result === \"error\" ||\n    result === \"timed_out\"\n  );\n}\n\nfunction is_aborted(result) {\n  return result === \"ABORTED\" || result === \"cancelled\";\n}\n\nfunction is_pending(result) {\n  return !result || result === \"pending\";\n}\n\nfunction getJobName(subBuild) {\n  const baseJobName = subBuild.jobName;\n  if (/caffe2-builds/.test(subBuild.url)) {\n    return \"caffe2-\" + baseJobName;\n  } else {\n    return baseJobName;\n  }\n}\n\nfunction classify_job_to_node(j) {\n  if (j === \"short-perf-test-gpu\") {\n    return \"linux-gpu\";\n  } else if (j === \"doc-push\") {\n    return \"linux-cpu\";\n  } else if (/-win/.test(j)) {\n    if (/-test/.test(j) && /-cuda/.test(j)) {\n      return \"win-gpu\";\n    } else {\n      return \"win-cpu\";\n    }\n  } else if (/-macos/.test(j)) {\n    return \"osx\";\n  } else if (\n    /-linux/.test(j) ||\n    /-ubuntu/.test(j) ||\n    /-centos/.test(j) ||\n    /-xenial/.test(j)\n  ) {\n    if (/cuda/.test(j)) {\n      if (/-multigpu-test/.test(j)) {\n        return \"linux-multigpu\";\n      } else if (/-test/.test(j)) {\n        return \"linux-gpu\";\n      } else {\n        return \"linux-cpu\";\n      }\n    } else if (/-rocm/.test(j)) {\n      if (/-test/.test(j)) {\n        return \"rocm\";\n      } else {\n        return \"linux-bigcpu\";\n      }\n    } else {\n      return \"linux-cpu\";\n    }\n  }\n  return \"unknown\";\n}\n\n// Ideas:\n//  - Put the master and pull request info together, so you can see what\n//  the reported 'master' status is for a given 'pull-request' build\n\nexport default class BuildHistoryDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = this.initialState();\n  }\n  initialState() {\n    const prefs_str = localStorage.getItem(\"prefs\");\n    let prefs = {};\n    if (prefs_str) {\n      prefs = JSON.parse(prefs_str);\n    }\n    if (!(\"showStale\" in prefs)) prefs[\"showStale\"] = false;\n    if (!(\"username\" in prefs)) prefs[\"username\"] = \"\";\n    if (!(\"showNotifications\" in prefs)) prefs[\"showNotifications\"] = true;\n    return {\n      builds: [],\n      known_jobs: [],\n      currentTime: new Date(),\n      updateTime: new Date(0),\n      showStale: prefs.showStale,\n      username: prefs.username,\n      showNotifications: prefs.showNotifications,\n    };\n  }\n  componentDidMount() {\n    this.update();\n    this.interval = setInterval(this.update.bind(this), this.props.interval);\n    if (this.state.showNotifications && Notification.permission !== \"granted\") {\n      Notification.requestPermission();\n    }\n  }\n  componentDidUpdate(prevProps) {\n    localStorage.setItem(\n      \"prefs\",\n      JSON.stringify({\n        showNotifications: this.state.showNotifications,\n        showStale: this.state.showStale,\n        username: this.state.username,\n      })\n    );\n    if (this.props.job !== prevProps.job) {\n      this.setState(this.initialState());\n      this.update();\n    }\n  }\n  async update() {\n    const currentTime = new Date();\n    this.setState({ currentTime: currentTime });\n    // NB: server-slide slicing doesn't really help, Jenkins seems to\n    // load everything into memory anyway\n    let data;\n    if (true) {\n      // STOP.  You want more results?  You may have noticed that on\n      // Google, people suggest using allBuilds with {0,n} to make use\n      // of Jenkins pagination.  However, if you do this, it will *DOS our Jeenkins\n      // instance*; even when pagination is requested, Jenkins will\n      // still load ALL builds into memory before servicing your\n      // request.  I've filed this at https://issues.jenkins-ci.org/browse/JENKINS-49908\n      data = await jenkins.job(this.props.job, {\n        tree: `builds[\n                  url,\n                  number,\n                  duration,\n                  timestamp,\n                  result,\n                  actions[parameters[name,value],\n                  causes[shortDescription]],\n                  changeSet[items[commitId,comment,msg]],\n                  subBuilds[\n                    result,jobName,url,duration,\n                    build[\n                      subBuilds[\n                        result,jobName,url,duration,\n                        build[\n                          subBuilds[result,jobName,url,duration]\n                        ]\n                      ]\n                    ]\n                  ]\n               ]`.replace(/\\s+/g, \"\"),\n      });\n      // build[builtOn]\n    } else {\n      // If you want entries in build on subBuilds, need depth = 3\n      // Otherwise, most data can be got with depth = 1\n      const depth = 1;\n      data = await jenkins.job(this.props.job, { depth: depth });\n    }\n    data.updateTime = new Date();\n    data.connectedIn = data.updateTime - currentTime;\n    if (data.allBuilds !== undefined) {\n      data.builds = data.allBuilds;\n    }\n\n    // Get build statuses from Github for CircleCI\n    async function get_github_commit_statuses() {\n      let github_commit_statuses = {};\n      let requests = [];\n\n      function add_jobs(jobs, index) {\n        let commitId = requests[index].commitId;\n        if (jobs) {\n          for (let job_name in jobs) {\n            let job = jobs[job_name];\n            if (!github_commit_statuses[commitId].hasOwnProperty(job_name)) {\n              github_commit_statuses[commitId][job_name] = {\n                duration: \"0\",\n                result: job.status,\n                url: job.build_url,\n              };\n            }\n          }\n        }\n      }\n\n      for (const commit of data.builds) {\n        for (let i = 0; i < commit.changeSet.items.length; i++) {\n          let commitId = commit.changeSet.items[i].commitId;\n          if (!github_commit_statuses.hasOwnProperty(commitId)) {\n            github_commit_statuses[commitId] = {};\n          }\n          requests.push({\n            url:\n              \"https://s3.amazonaws.com/ossci-job-status/combined/\" +\n              commitId +\n              \".json\",\n            commitId,\n          });\n        }\n      }\n      let results = await jenkins.batch_get(\n        requests.map((request) => request.url)\n      );\n      results.forEach(add_jobs);\n      return github_commit_statuses;\n    }\n    data.github_commit_statuses = await get_github_commit_statuses();\n\n    const known_jobs_set = new Set();\n    function collect_known_jobs_set(topBuild) {\n      function go(subBuild) {\n        if (\n          subBuild.build &&\n          subBuild.build._class ===\n            \"com.tikal.jenkins.plugins.multijob.MultiJobBuild\"\n        ) {\n          subBuild.build.subBuilds.forEach(go);\n        } else {\n          known_jobs_set.add(getJobName(subBuild));\n        }\n      }\n      topBuild.subBuilds.forEach(go);\n    }\n    const props_mode = this.props.mode;\n    if (props_mode !== \"binary\") {\n      data.builds.forEach(collect_known_jobs_set);\n    }\n\n    if (data.github_commit_statuses) {\n      Object.keys(data.github_commit_statuses).forEach(function (commit) {\n        var jobs = data.github_commit_statuses[commit];\n        Object.keys(jobs).forEach(function (job_name) {\n          if (props_mode !== \"binary\") {\n            // Warning: quadratic police!\n            for (var i = 0; i < binary_and_smoke_tests_on_pr.length; i++) {\n              if (job_name.endsWith(binary_and_smoke_tests_on_pr[i])) {\n                known_jobs_set.add(\"_\" + job_name); // Add \"_\" before name to make sure CircleCI builds always show up on the left\n                break;\n              }\n            }\n            if (\n              !(job_name.includes(\"binary_\") || job_name.includes(\"smoke_\"))\n            ) {\n              // Exclude binary builds and smoke tests that are not running on every PR\n              known_jobs_set.add(\"_\" + job_name); // Add \"_\" before name to make sure CircleCI builds always show up on the left\n            }\n          } else {\n            if (job_name.includes(\"binary_\") || job_name.includes(\"smoke_\")) {\n              let found = false;\n              for (let i = 0; i < binary_and_smoke_tests_on_pr.length; i++) {\n                if (job_name.endsWith(binary_and_smoke_tests_on_pr[i])) {\n                  found = true;\n                  break;\n                }\n              }\n              if (!found) known_jobs_set.add(\"_\" + job_name);\n            }\n          }\n        });\n      });\n    }\n\n    function compareFun(x, y) {\n      const sx = jobs_on_pr.some((e) => summarize_job(x).startsWith(e));\n      const sy = jobs_on_pr.some((e) => summarize_job(y).startsWith(e));\n      if (sx < sy) return 1;\n      else if (sx > sy) return -1;\n      else if (x < y) return -1;\n      else if (x > y) return 1;\n      else return 0;\n    }\n    data.known_jobs = [...known_jobs_set.values()].sort(compareFun);\n\n    data.builds.forEach((build) => {\n      const sb_map = new Map();\n\n      // Collect job status from Jenkins\n      function collect_jobs(topBuild) {\n        function go(subBuild) {\n          if (\n            subBuild.build &&\n            subBuild.build._class ===\n              \"com.tikal.jenkins.plugins.multijob.MultiJobBuild\"\n          ) {\n            subBuild.build.subBuilds.forEach(go);\n          } else {\n            sb_map.set(getJobName(subBuild), subBuild);\n          }\n        }\n        topBuild.subBuilds.forEach(go);\n      }\n      collect_jobs(build);\n\n      // Collect job status for non-Jenkins jobs (i.e. CircleCI jobs)\n      async function collect_jobs_from_github_status(build) {\n        if (build.changeSet.items.length > 0) {\n          for (var i = 0; i < build.changeSet.items.length; i++) {\n            let commitId = build.changeSet.items[i].commitId;\n            if (data.github_commit_statuses) {\n              Object.keys(data.github_commit_statuses[commitId]).forEach(\n                function (job_name) {\n                  var job = data.github_commit_statuses[commitId][job_name];\n                  sb_map.set(\"_\" + job_name, {\n                    duration: job.duration,\n                    result: job.result,\n                    url: job.url,\n                  });\n                }\n              );\n            }\n          }\n        }\n      }\n      collect_jobs_from_github_status(build);\n      build.sb_map = sb_map;\n    });\n\n    // Figure out if we think something is broken or not.\n    //  1. Consider the MOST RECENT finished build for any given sub\n    //     build type.  If it is success, it's fine.\n    //  2. Otherwise, check builds prior to it.  If the previous build\n    //     also failed, we think it's broken!\n    //\n    // Special cases:\n    //  - pytorch_doc_push: don't care about this\n    //  - nightlies: these don't run all the time\n\n    const failure_window = 10;\n    if (this.props.job.includes(\"master\")) {\n      const still_unknown_set = new Set();\n      const consecutive_failure_count = new Map();\n      data.known_jobs.forEach((job) => {\n        if (job === \"pytorch_doc_push\") return;\n        if (job === \"__dr.ci\") return;\n        if (job.includes(\"nightlies\")) return;\n        still_unknown_set.add(job);\n      });\n      for (let i = 0; i < data.builds.length; i++) {\n        // After some window, don't look anymore; the job may have been\n        // removed\n        if (i > failure_window) break;\n        if (!still_unknown_set.size) break;\n        const build = data.builds[i];\n        const sb_map = build.sb_map;\n        sb_map.forEach((sb, jobName) => {\n          if (!still_unknown_set.has(jobName)) {\n            // do nothing\n          } else if (is_failure(sb.result)) {\n            let count = consecutive_failure_count.get(jobName) || 0;\n            count++;\n            consecutive_failure_count.set(jobName, count);\n          } else if (is_success(sb.result)) {\n            still_unknown_set.delete(jobName);\n          }\n        });\n      }\n\n      // Prune uninteresting alarms\n      consecutive_failure_count.forEach((v, k) => {\n        // Require two consecutive failure to alert\n        if (v <= 1) {\n          consecutive_failure_count.delete(k);\n        }\n      });\n\n      data.consecutive_failure_count = consecutive_failure_count;\n\n      // Compute what notifications to show\n      // We'll take a diff and then give notifications for keys that\n      // changed\n      if (this.state.consecutive_failure_count) {\n        this.state.consecutive_failure_count.forEach((v, key) => {\n          if (!consecutive_failure_count.has(key)) {\n            // It's fixed!\n            new Notification(\" \" + this.props.job, {\n              body: summarize_job(key),\n            });\n          }\n        });\n      }\n      consecutive_failure_count.forEach((v, key) => {\n        // Don't produce notifications for initial failure!\n        if (\n          this.state.consecutive_failure_count &&\n          !this.state.consecutive_failure_count.has(key)\n        ) {\n          // It's failed!\n          new Notification(\" \" + this.props.job, {\n            body: summarize_job(key),\n          });\n        }\n      });\n    }\n\n    // TODO: This can cause spurious state updates\n    this.setState(data);\n  }\n\n  render() {\n    function result_icon(result) {\n      if (is_success(result))\n        return (\n          <span role=\"img\" style={{ color: \"green\" }} aria-label=\"passed\">\n            0\n          </span>\n        );\n      if (is_failure(result))\n        return (\n          <span role=\"img\" style={{ color: \"red\" }} aria-label=\"failed\">\n            X\n          </span>\n        );\n      if (is_aborted(result))\n        return (\n          <span role=\"img\" style={{ color: \"gray\" }} aria-label=\"cancelled\">\n            .\n          </span>\n        );\n      if (is_pending(result))\n        return (\n          <span\n            className=\"animate-flicker\"\n            role=\"img\"\n            style={{ color: \"goldenrod\" }}\n            aria-label=\"in progress\"\n          >\n            ?\n          </span>\n        );\n      return result;\n    }\n\n    // Sigh... the place where you can get the information you're\n    // interested in at the top level is NOT the same as where you get\n    // it inside, because of how Jenkins handles depth (Jenkins\n    // *will* give you information for everything recursively, just\n    // not in the place you might expect it.\n    //\n    //  class: \"com.tikal.jenkins.plugins.multijob.MultiJobBuild\"\n    //  id: \"3772\"\n    //  subBuilds:\n    //    0:\n    //      jobName: \"whatever\"\n    //      build:\n    //        class: \"com.tikal.jenkins.plugins.multijob.MultiJobBuild\"\n    //        subBuilds:\n\n    let builds = this.state.builds;\n    let consecutive_failure_count = this.state.consecutive_failure_count;\n\n    const known_jobs = this.state.known_jobs;\n    const known_jobs_head = known_jobs.map((jobName) => (\n      <th className=\"rotate\" key={jobName}>\n        <div\n          className={\n            (jobs_on_pr.some((e) => summarize_job(jobName).startsWith(e))\n              ? \"pr-header\"\n              : \"master-only-header\") +\n            \" \" +\n            (consecutive_failure_count.has(jobName) ? \"failing-header\" : \"\")\n          }\n        >\n          {jobs_on_pr.some((e) => summarize_job(jobName).startsWith(e))\n            ? \"\"\n            : \" \"}\n          {summarize_job(jobName)}\n        </div>\n      </th>\n    ));\n    // const known_jobs_head = known_jobs.map((jobName) =>\n    //  <th key={jobName}></th>\n    //);\n\n    const durationWidth = 100;\n    const durationHeight = 10;\n    const durationScale = d3.scaleLinear().rangeRound([0, durationWidth]);\n    durationScale.domain([0, d3.max(builds, (b) => b.duration)]);\n\n    const seen_prs = new Set();\n\n    const rows = builds.map((build) => {\n      const sb_map = build.sb_map;\n\n      function perf_report(sb, result) {\n        return (\n          <Fragment>\n            <span\n              className={\n                is_success(result) ? \"ok-duration\" : \"suspect-duration\"\n              }\n            >\n              {parse_duration(sb.duration) / 1000}\n            </span>\n            &nbsp;&nbsp;\n          </Fragment>\n        );\n      }\n\n      // let cumulativeMs = 0;\n      let cost = 0;\n      let unknownCost = false;\n      let inProgressCost = false;\n      let found = false;\n\n      const status_cols = known_jobs.map((jobName) => {\n        const sb = sb_map.get(jobName);\n        let cell = <Fragment />;\n        if (sb !== undefined) {\n          found = true;\n          const dur = parse_duration(sb.duration);\n          // cumulativeMs += dur;\n          const node = classify_job_to_node(getJobName(sb));\n          let this_cost = 0;\n          if (node === \"unknown\") {\n            unknownCost = true;\n          } else {\n            this_cost = Math.ceil((centsPerHour[node] * dur) / 1000 / 60 / 60);\n          }\n          cost += this_cost;\n          if (!sb.result) inProgressCost = true;\n          if (this.props.mode === \"perf\") {\n            cell = perf_report(sb, sb.result);\n          } else if (this.props.mode === \"cost\") {\n            cell = (\n              <Fragment>\n                {node === \"unknown\" ? \"?\" : this_cost}&nbsp;&nbsp;\n              </Fragment>\n            );\n          } else {\n            var cellHref = sb.url;\n            if (/^https?:\\/\\//.test(cellHref)) {\n              if (cellHref.includes(\"jenkins\")) {\n                cellHref = cellHref + \"/console\";\n              }\n            } else {\n              cellHref = jenkins.link(cellHref + \"/console\");\n            }\n            cell = (\n              <a\n                href={cellHref}\n                className=\"icon\"\n                target=\"_blank\"\n                alt={getJobName(sb)}\n              >\n                {result_icon(sb.result)}\n              </a>\n            );\n          }\n        }\n        return (\n          <Tooltip\n            key={jobName}\n            overlay={jobName}\n            mouseLeaveDelay={0}\n            placement=\"rightTop\"\n            destroyTooltipOnHide={true}\n          >\n            <td\n              key={jobName}\n              className=\"icon-cell\"\n              style={{\n                textAlign: \"right\",\n                fontFamily: \"sans-serif\",\n                padding: 0,\n              }}\n            >\n              {cell}\n            </td>\n          </Tooltip>\n        );\n      });\n\n      function drop_pr_number(msg) {\n        return msg.replace(/\\(#[0-9]+\\)/, \"\");\n      }\n\n      function renderPullRequestNumber(comment) {\n        let m = comment.match(/\\(#(\\d+)\\)/);\n        if (m) {\n          return (\n            <Fragment>\n              <a\n                href={\"https://github.com/pytorch/pytorch/pull/\" + m[1]}\n                target=\"_blank\"\n              >\n                #{m[1]}\n              </a>\n            </Fragment>\n          );\n        }\n        return <Fragment />;\n      }\n\n      function renderCommit(commit) {\n        return (\n          <div key={commit.commitId}>\n            {renderPullRequestNumber(commit.comment)}{\" \"}\n            {drop_pr_number(commit.msg)}{\" \"}\n            <code>\n              <a\n                href={\n                  \"https://github.com/pytorch/pytorch/commit/\" + commit.commitId\n                }\n                target=\"_blank\"\n              >\n                {commit.commitId.slice(0, 7)}\n              </a>\n            </code>\n          </div>\n        );\n      }\n\n      function renderCauses(changeSet) {\n        const defaultCause = <em>Manually triggered rebuild.</em>;\n        if (changeSet.actions === undefined) return defaultCause;\n        return changeSet.actions\n          .filter((action) => action.causes !== undefined)\n          .map((action, i) =>\n            action.causes.map((cause, i) => (\n              <em key={i}>{cause.shortDescription}. </em>\n            ))\n          );\n      }\n\n      function getPushedBy(build) {\n        const action = build.actions.find(\n          (action) => action._class === \"hudson.model.CauseAction\"\n        );\n        if (action === undefined) return \"(unknown)\";\n        const cause = action.causes.find(\n          (cause) => cause._class === \"com.cloudbees.jenkins.GitHubPushCause\"\n        );\n        if (cause === undefined) return \"\";\n        const match = cause.shortDescription.match(\n          /Started by GitHub push by (.+)/\n        );\n        if (match === null) return cause.shortDescription;\n        return match[1];\n      }\n\n      function getPullParams(build) {\n        let action = build.actions.find(\n          (action) =>\n            action._class ===\n            \"org.jenkinsci.plugins.ghprb.GhprbParametersAction\"\n        );\n        if (action === undefined) {\n          action = build.actions.find(\n            (action) =>\n              action._class ===\n              \"com.tikal.jenkins.plugins.multijob.MultiJobParametersAction\"\n          );\n        }\n        if (action === undefined) {\n          return new Map();\n        }\n        return new Map(\n          action.parameters.map((param) => [param.name, param.value])\n        );\n      }\n\n      const isRebuild = build.actions.some(\n        (action) =>\n          action.causes !== undefined &&\n          action.causes.some(\n            (cause) => cause._class === \"com.sonyericsson.rebuild.RebuildCause\"\n          )\n      );\n      const isPullRequest = build.actions.some(\n        (action) =>\n          action.causes !== undefined &&\n          action.causes.some(\n            (cause) =>\n              cause._class === \"org.jenkinsci.plugins.ghprb.GhprbCause\" ||\n              (cause._class === \"hudson.model.Cause$UpstreamCause\" &&\n                /-pull-request$/.test(cause.upstreamProject))\n          )\n      );\n\n      let author = \"\";\n      let desc = \"\";\n      let pull_link;\n      let pull_id;\n\n      // TODO: Too lazy to set up PR numbers for the old ones\n\n      let stale = false;\n      if (isRebuild) {\n        desc = renderCauses(build);\n      } else if (isPullRequest) {\n        const params = getPullParams(build);\n        const title = params.get(\"ghprbPullTitle\");\n        pull_link = params.get(\"ghprbPullLink\");\n        pull_id = params.get(\"ghprbPullId\");\n        author = params.get(\"ghprbPullAuthorLogin\");\n        desc = title;\n        if (seen_prs.has(pull_id)) {\n          // TODO: do this filtering earlier\n          if (!this.state.showStale) return <Fragment key={build.number} />;\n          stale = true;\n        }\n        if (this.state.username !== \"\" && this.state.username !== author) {\n          return <Fragment key={build.number} />;\n        }\n        seen_prs.add(pull_id);\n      } else {\n        const changeSet = build.changeSet;\n        // TODO: This is empty for not pytorch-master.  We could\n        // probably get the info if we propagate it as a variable.\n        author = getPushedBy(build);\n        if (changeSet.items.length === 0) {\n          desc = renderCauses(build);\n        } else {\n          desc = changeSet.items.slice().reverse().map(renderCommit);\n        }\n      }\n\n      const whenString = summarize_date(build.timestamp);\n\n      if (!found) {\n        return <Fragment />;\n      }\n\n      return (\n        <tr key={build.number} className={stale ? \"stale\" : \"\"}>\n          <th className=\"left-cell\">\n            <a href={build.url} target=\"_blank\">\n              {build.number}\n            </a>\n          </th>\n          <th className=\"left-cell\">\n            <a href={pull_link} target=\"_blank\">\n              {pull_id ? \"#\" + pull_id : \"\"}\n            </a>\n          </th>\n          <td className=\"left-cell\">{whenString}</td>\n          {status_cols}\n          <td className=\"right-cell bar-number\">\n            {Math.floor(build.duration / 1000 / 60)}\n          </td>\n          <td>\n            <svg width={durationWidth} height={durationHeight}>\n              <rect\n                className=\"bar\"\n                x=\"0\"\n                y=\"0\"\n                width={durationScale(build.duration)}\n                height={durationHeight}\n              />\n            </svg>\n          </td>\n          <td className=\"right-cell\" style={{ textAlign: \"right\" }}>\n            {inProgressCost ? \" \" : \"\"}\n            {centsToDollars(cost)}\n            {unknownCost ? \"?\" : \"\"}\n          </td>\n          <td className=\"right-cell\">{author}</td>\n          <td className=\"right-cell\">{desc}</td>\n        </tr>\n      );\n    });\n\n    return (\n      <div>\n        <h2>\n          <a href={jenkins.link(\"job/\" + this.props.job)} target=\"_blank\">\n            {this.props.job}\n          </a>{\" \"}\n          history{\" \"}\n          <AsOf\n            interval={this.props.interval}\n            connectedIn={this.state.connectedIn}\n            currentTime={this.state.currentTime}\n            updateTime={this.state.updateTime}\n          />\n        </h2>\n        <div style={{ color: \"#909\" }}>\n           Purple bulleted jobs run on master only.\n        </div>\n        <div>\n          <ul className=\"menu\">\n            <li>\n              <input\n                type=\"checkbox\"\n                name=\"show-stale\"\n                checked={this.state.showStale}\n                onChange={(e) => {\n                  this.setState({ showStale: e.target.checked });\n                }}\n              />\n              <label htmlFor=\"show-stale\">Show stale builds of PRs</label>\n            </li>\n            <li>\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={this.state.username}\n                onChange={(e) => {\n                  this.setState({ username: e.target.value });\n                }}\n              />\n              <label\n                htmlFor=\"username\"\n                style={{\n                  backgroundColor: \"white\",\n                  position: \"relative\",\n                  zIndex: 3,\n                }}\n              >\n                Show builds from this user only\n              </label>\n            </li>\n            <li>\n              <input\n                type=\"checkbox\"\n                name=\"show-notifications\"\n                checked={this.state.showNotifications}\n                onChange={(e) =>\n                  this.setState({ showNotifications: e.target.checked })\n                }\n              />\n              <label htmlFor=\"show-notifications\">\n                Show notifications on master failure\n                {Notification.permission === \"denied\" ? (\n                  <Fragment>\n                    {\" \"}\n                    <strong>\n                      (WARNING: notifications are currently denied)\n                    </strong>\n                  </Fragment>\n                ) : (\n                  \"\"\n                )}\n              </label>\n            </li>\n          </ul>\n        </div>\n        <table className=\"buildHistoryTable\">\n          <thead>\n            <tr>\n              <th className=\"left-cell\">J#</th>\n              <th className=\"left-cell\">PR#</th>\n              <th className=\"left-cell\">Date</th>\n              {known_jobs_head}\n              <th className=\"right-cell\" colSpan=\"2\">\n                Latency (min)\n              </th>\n              <th className=\"right-cell\">Cost</th>\n              <th className=\"right-cell\">User</th>\n              <th className=\"right-cell\">Description</th>\n            </tr>\n          </thead>\n          <tbody>{rows}</tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","import { groups as pytorch } from \"./pytorch.js\";\nimport { groups as vision } from \"./vision.js\";\nimport { groups as audio } from \"./audio.js\";\nimport { groups as text } from \"./text.js\";\nimport { groups as lightning } from \"./pytorch-lightning.js\";\n\nconst map = {\n  pytorch: pytorch,\n  vision: vision,\n  audio: audio,\n  text: text,\n  \"pytorch-lightning\": lightning,\n};\n\nexport default function getGroups(repo) {\n  const result = [];\n  if (!map[repo]) {\n    console.error(`Unknown group repo ${repo}`);\n    return [];\n  }\n\n  for (const group of map[repo]) {\n    let obj = {};\n    Object.assign(obj, group);\n    result.push(obj);\n  }\n\n  return result;\n}\n","export const groups = [\n  {\n    regex: /Lint/,\n    name: \"Lint Jobs\",\n  },\n  {\n    regex: /(\\(periodic-pytorch)|(ci\\/circleci: periodic_pytorch)|(^periodic-)/,\n    name: \"Periodic Jobs\",\n  },\n  {\n    regex: /(Linux CI \\(pytorch-linux-)|(^linux-)/,\n    name: \"Linux GitHub Actions\",\n  },\n  {\n    regex:\n      /(Add annotations )|(Close stale pull requests)|(Label PRs & Issues)|(Triage )|(Update S3 HTML indices)|(codecov\\/project)|(Facebook CLA Check)|(auto-label-rocm)/,\n    name: \"Annotations and labeling\",\n  },\n  {\n    regex:\n      /(ci\\/circleci: docker-pytorch-)|(ci\\/circleci: ecr_gc_job_)|(ci\\/circleci: docker_for_ecr_gc_build_job)|(Garbage Collect ECR Images)/,\n    name: \"Docker\",\n  },\n  {\n    regex: /(Windows CI \\(pytorch-)|(^win-)/,\n    name: \"Windows GitHub Actions\",\n  },\n  {\n    regex: / \\/ calculate-docker-image/,\n    name: \"GitHub calculate-docker-image\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_ios_/,\n    name: \"ci/circleci: pytorch_ios\",\n  },\n  {\n    regex:\n      /(ci\\/circleci: pytorch_parallelnative_)|(ci\\/circleci: pytorch_paralleltbb_)|(paralleltbb-linux-)|(parallelnative-linux-)/,\n    name: \"Parallel\",\n  },\n  {\n    regex:\n      /(ci\\/circleci: pytorch_cpp_doc_build)|(ci\\/circleci: pytorch_cpp_doc_test)|(pytorch_python_doc_build)|(pytorch_doc_test)/,\n    name: \"Docs\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_bionic_cuda10_2_cudnn7_py3_9_gcc7_/,\n    name: \"ci/circleci: pytorch_linux_bionic_cuda10_2_cudnn7_py3_9_gcc7\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_cuda10_2_cudnn7_py3_/,\n    name: \"ci/circleci: pytorch_linux_xenial_cuda10_2_cudnn7_py3\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_cuda11_1_cudnn8_py3_gcc7_/,\n    name: \"ci/circleci: pytorch_linux_xenial_cuda11_1_cudnn8_py3_gcc7\",\n  },\n  {\n    regex:\n      /(ci\\/circleci: pytorch_linux_xenial_py3_clang5_android_ndk_r19c_)|(ci\\/circleci: pytorch-linux-xenial-py3-clang5-android-ndk-r19c-)/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_clang5_android_ndk\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_py3_6_gcc7_build/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_clang5_asan_build\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_py3_clang5_mobile_/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_clang5_mobile\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_py3_clang7_onnx_/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_clang7_onnx\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_py3_clang5_asan_/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_clang5_asan\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_py3_6_gcc7_/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_6_gcc7\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_macos_10_13_py3_/,\n    name: \"ci/circleci: pytorch_macos_10_13_py3\",\n  },\n  {\n    regex: /ci\\/circleci: pytorch_linux_xenial_py3_6_gcc5_4_/,\n    name: \"ci/circleci: pytorch_linux_xenial_py3_6_gcc5_4\",\n  },\n  {\n    regex: /ci\\/circleci: binary_linux_/,\n    name: \"ci/circleci: binary_linux\",\n  },\n  {\n    regex: /ci\\/circleci: binary_macos_/,\n    name: \"ci/circleci: binary_macos\",\n  },\n  {\n    regex: /ci\\/circleci: binary_windows_/,\n    name: \"ci/circleci: binary_windows\",\n  },\n  {\n    regex: /(pytorch-linux-bionic-rocm)|(pytorch_linux_bionic_rocm)/,\n    name: \"ROCm\",\n  },\n];\n","export const groups = [\n  {\n    regex: /ci\\/circleci: unittest/,\n    name: \"CircleCI unittest\",\n  },\n  {\n    regex: /ci\\/circleci: binary_linux/,\n    name: \"CircleCI binary_linux\",\n  },\n  {\n    regex: /ci\\/circleci: binary_macos/,\n    name: \"CircleCI binary_macos\",\n  },\n  {\n    regex: /ci\\/circleci: binary_win/,\n    name: \"CircleCI binary_win\",\n  },\n];\n","export const groups = [\n  {\n    regex: /ci\\/circleci: unittest/,\n    name: \"CircleCI unittest\",\n  },\n  {\n    regex: /ci\\/circleci: binary_linux/,\n    name: \"CircleCI binary_linux\",\n  },\n  {\n    regex: /ci\\/circleci: binary_macos/,\n    name: \"CircleCI binary_macos\",\n  },\n  {\n    regex: /ci\\/circleci: binary_win/,\n    name: \"CircleCI binary_win\",\n  },\n  {\n    regex: /ci\\/circleci: nightly_binary_linux/,\n    name: \"CircleCI nightly_binary_linux\",\n  },\n  {\n    regex: /ci\\/circleci: nightly_binary_macos/,\n    name: \"CircleCI nightly_binary_macos\",\n  },\n  {\n    regex: /ci\\/circleci: nightly_binary_win/,\n    name: \"CircleCI nightly_binary_win\",\n  },\n];\n","export const groups = [\n  {\n    regex: /ci\\/circleci: unittest/,\n    name: \"CircleCI unittest\",\n  },\n  {\n    regex: /ci\\/circleci: binary_linux/,\n    name: \"CircleCI binary_linux\",\n  },\n  {\n    regex: /ci\\/circleci: binary_macos/,\n    name: \"CircleCI binary_macos\",\n  },\n  {\n    regex: /ci\\/circleci: binary_win/,\n    name: \"CircleCI binary_win\",\n  },\n  {\n    regex: /ci\\/circleci: nightly_binary_linux/,\n    name: \"CircleCI nightly_binary_linux\",\n  },\n  {\n    regex: /ci\\/circleci: nightly_binary_macos/,\n    name: \"CircleCI nightly_binary_macos\",\n  },\n  {\n    regex: /ci\\/circleci: nightly_binary_win/,\n    name: \"CircleCI nightly_binary_win\",\n  },\n];\n","export const groups = [\n  {\n    regex: /Nightly events/,\n    name: \"Nightly Events\",\n  },\n  {\n    regex: /Publish Docker Releases/,\n    name: \"Docker Releases\",\n  },\n];\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component, Fragment } from \"react\";\nimport jenkins from \"./Jenkins.js\";\nimport AsOf from \"./AsOf.js\";\nimport { summarize_job, summarize_date } from \"./Summarize.js\";\nimport getGroups from \"./groups/index.js\";\nimport Tooltip from \"rc-tooltip\";\nimport axios from \"axios\";\nimport {\n  BsFillCaretRightFill,\n  BsFillCaretDownFill,\n  ImSpinner2,\n  FcCancel,\n} from \"react-icons/all\";\n\nfunction isMobile() {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n    navigator.userAgent\n  );\n}\n\nfunction array_move(arr, old_index, new_index) {\n  while (old_index < 0) {\n    old_index += arr.length;\n  }\n  while (new_index < 0) {\n    new_index += arr.length;\n  }\n  if (new_index >= arr.length) {\n    var k = new_index - arr.length + 1;\n    while (k--) {\n      arr.push(undefined);\n    }\n  }\n  arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);\n}\n\nfunction is_success(result) {\n  return result === \"SUCCESS\" || result === \"success\";\n}\n\nfunction is_failure(result) {\n  // TODO: maybe classify timeout differently\n  return (\n    result === \"FAILURE\" ||\n    result === \"failure\" ||\n    result === \"error\" ||\n    result === \"timed_out\"\n  );\n}\n\nfunction is_aborted(result) {\n  return result === \"ABORTED\" || result === \"cancelled\";\n}\n\nfunction is_pending(result) {\n  return !result || result === \"pending\";\n}\n\nfunction is_skipped(result) {\n  return result === \"skipped\";\n}\n\nfunction is_infra_failure(result) {\n  return result === \"infrastructure_fail\";\n}\n\nfunction objToStrMap(obj) {\n  let strMap = new Map();\n  for (let k of Object.keys(obj)) {\n    strMap.set(k, obj[k]);\n  }\n  return strMap;\n}\n\nfunction computeConsecutiveFailureCount(data, failure_window = 10) {\n  const still_unknown_set = new Set();\n  const consecutive_failure_count = new Map();\n  data.known_jobs.forEach((job) => {\n    if (job === \"pytorch_doc_push\") return;\n    if (job === \"__dr.ci\") return;\n    if (job.includes(\"nightlies\")) return;\n    still_unknown_set.add(job);\n  });\n  for (let i = 0; i < data.builds.length; i++) {\n    // After some window, don't look anymore; the job may have been\n    // removed\n    if (i > failure_window) break;\n    if (!still_unknown_set.size) break;\n    const build = data.builds[i];\n    const sb_map = build.sb_map;\n    sb_map.forEach((sb, jobName) => {\n      if (!still_unknown_set.has(jobName)) {\n        // do nothing\n      } else if (is_failure(sb.status)) {\n        let count = consecutive_failure_count.get(jobName) || 0;\n        count++;\n        consecutive_failure_count.set(jobName, count);\n      } else if (is_success(sb.status)) {\n        still_unknown_set.delete(jobName);\n      }\n    });\n  }\n\n  // Prune uninteresting alarms\n  consecutive_failure_count.forEach((v, k) => {\n    // Require two consecutive failure to alert\n    if (v <= 1) {\n      consecutive_failure_count.delete(k);\n    }\n  });\n  return consecutive_failure_count;\n}\n\nfunction getJenkinsJobName(subBuild) {\n  const baseJobName = subBuild.jobName;\n  if (/caffe2-builds/.test(subBuild.url)) {\n    return \"jenkins: caffe2-\" + baseJobName;\n  } else {\n    return \"jenkins: \" + baseJobName;\n  }\n}\n\nclass NameFilterForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      jobNameFilter: props.defaultValue || \"\",\n      onSubmit: props.onSubmit || ((_) => {}),\n    };\n  }\n  render() {\n    return (\n      <form\n        onSubmit={(e) => {\n          e.preventDefault();\n          this.state.onSubmit(this.state.jobNameFilter);\n        }}\n      >\n        <label htmlFor=\"job-name-filter\">Name filter:&nbsp;</label>\n        <input\n          type=\"input\"\n          name=\"job-name-filter\"\n          id=\"job-name-filter\"\n          value={this.state.jobNameFilter}\n          onChange={(e) => {\n            this.setState({ jobNameFilter: e.target.value });\n          }}\n        />\n        <input style={{ marginLeft: \"3px\" }} type=\"submit\" value=\"Go\" />\n      </form>\n    );\n  }\n}\n\nexport default class BuildHistoryDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = this.initialState();\n  }\n  initialState() {\n    const prefs_str = localStorage.getItem(\"prefs2\");\n    let prefs = {};\n    if (prefs_str) {\n      prefs = JSON.parse(prefs_str);\n    }\n    if (!(\"showNotifications\" in prefs))\n      prefs[\"showNotifications\"] = !isMobile();\n    if (!(\"groupJobs\" in prefs)) prefs[\"groupJobs\"] = true;\n    let jobNameFilter = this.props.jobNameFilter || \"\";\n    return {\n      fetchedBuilds: false,\n      fetchError: false,\n      builds: [],\n      lastUpdateDate: null,\n      known_jobs: [],\n      showGroups: [],\n      currentTime: new Date(),\n      updateTime: new Date(0),\n      showNotifications: prefs.showNotifications,\n      groupJobs: jobNameFilter.length === 0 ? prefs.groupJobs : false,\n      jobNameFilter: jobNameFilter,\n    };\n  }\n  componentDidMount() {\n    this.update();\n    this.interval = setInterval(this.update.bind(this), this.props.interval);\n    if (\n      !isMobile() &&\n      this.state.showNotifications &&\n      Notification.permission !== \"granted\"\n    ) {\n      Notification.requestPermission();\n    }\n  }\n  componentDidUpdate(prevProps) {\n    localStorage.setItem(\n      \"prefs2\",\n      JSON.stringify({\n        showNotifications: this.state.showNotifications,\n        groupJobs: this.state.groupJobs,\n      })\n    );\n    if (this.props.branch !== prevProps.branch) {\n      this.setState(this.initialState());\n      this.update();\n    }\n  }\n  async addJenkinsResults(builds) {\n    // Adds Jenkins results to builds array\n    // Step 1. Fetch info via GraphQL\n    //\n    // STOP.  You want more results?  You may have noticed that on\n    // Google, people suggest using allBuilds with {0,n} to make use\n    // of Jenkins pagination.  However, if you do this, it will *DOS our Jeenkins\n    // instance*; even when pagination is requested, Jenkins will\n    // still load ALL builds into memory before servicing your\n    // request.  I've filed this at https://issues.jenkins-ci.org/browse/JENKINS-49908\n    let jenkins_data = await jenkins.job(`pytorch-${this.props.branch}`, {\n      tree: `builds[\n                url,\n                number,\n                duration,\n                timestamp,\n                result,\n                actions[parameters[name,value],\n                causes[shortDescription]],\n                changeSet[items[commitId,comment,msg]],\n                subBuilds[\n                  result,jobName,url,duration,\n                  build[\n                    subBuilds[\n                      result,jobName,url,duration,\n                      build[\n                        subBuilds[result,jobName,url,duration]\n                      ]\n                    ]\n                  ]\n                ]\n             ]`.replace(/\\s+/g, \"\"),\n    });\n\n    // Step 2: Build commit to build idx map\n    const commitIdxMap = new Map();\n    builds.forEach((build, idx) => {\n      commitIdxMap[build.id] = idx;\n    });\n\n    // Step 3: Add jenkins jobs\n    if (jenkins_data) {\n      jenkins_data.builds.forEach((topBuild) => {\n        if (topBuild.changeSet.items.length !== 1) {\n          return;\n        }\n        const buildCommitId = topBuild.changeSet.items[0].commitId;\n        if (!(buildCommitId in commitIdxMap)) {\n          return;\n        }\n        const buildIdx = commitIdxMap[buildCommitId];\n        function go(subBuild) {\n          if (\n            subBuild.build &&\n            subBuild.build._class ===\n              \"com.tikal.jenkins.plugins.multijob.MultiJobBuild\"\n          ) {\n            subBuild.build.subBuilds.forEach(go);\n          } else {\n            builds[buildIdx].sb_map.set(\n              getJenkinsJobName(subBuild),\n              Object.fromEntries([\n                [\"status\", subBuild.result],\n                [\"build_url\", jenkins.link(subBuild.url + \"/console\")],\n              ])\n            );\n          }\n        }\n        topBuild.subBuilds.forEach(go);\n      });\n    }\n  }\n  async update() {\n    const currentTime = new Date();\n    this.setState({ currentTime: currentTime });\n\n    const branch = this.props.branch;\n    const user = this.props.user;\n    const repo = this.props.repo;\n    const jsonUrl = `https://s3.amazonaws.com/ossci-job-status/v5/${user}/${repo}/${branch.replace(\n      \"/\",\n      \"_\"\n    )}.json`;\n    let commits = null;\n    try {\n      commits = await axios.get(jsonUrl);\n    } catch {\n      this.setState({ fetchError: true });\n      return;\n    }\n\n    // Marshal new build format into the old build format\n    const builds = [];\n    for (const commit of commits.data) {\n      const build_map = new Map();\n      for (const job of commit.jobs) {\n        let status = job.status;\n        if (status === \"neutral\") {\n          status = \"skipped\";\n        }\n        if (status === \"queued\") {\n          status = \"pending\";\n        }\n        build_map.set(job.name, {\n          build_url: job.url,\n          status: status,\n        });\n      }\n      builds.push({\n        author: {\n          username: commit.author,\n        },\n        message: commit.headline + \"\\n\" + commit.body,\n        sb_map: build_map,\n        id: commit.sha,\n        timestamp: commit.date,\n        url: `https://github.com/${this.props.user}/${this.props.repo}/commit/${commit.sha}`,\n      });\n    }\n\n    if (this.props.repo === \"pytorch\" && branch === \"master\") {\n      await this.addJenkinsResults(builds);\n    }\n\n    const data = {};\n\n    data.updateTime = new Date();\n    data.lastUpdateDate = new Date(commits.headers[\"last-modified\"]);\n    data.fetchedBuilds = true;\n    data.connectedIn = data.updateTime - currentTime;\n\n    const known_jobs_set = new Set();\n    builds.forEach((build) => {\n      build.sb_map.forEach((sb, job_name) => {\n        known_jobs_set.add(job_name);\n      });\n    });\n\n    data.known_jobs = [...known_jobs_set.values()].sort();\n    data.builds = builds;\n\n    // Figure out if we think something is broken or not.\n    //  1. Consider the MOST RECENT finished build for any given sub\n    //     build type.  If it is success, it's fine.\n    //  2. Otherwise, check builds prior to it.  If the previous build\n    //     also failed, we think it's broken!\n    //\n    // Special cases:\n    //  - pytorch_doc_push: don't care about this\n    //  - nightlies: these don't run all the time\n\n    if (this.props.repo === \"pytorch\") {\n      data.consecutive_failure_count = computeConsecutiveFailureCount(data);\n\n      // Compute what notifications to show\n      // We'll take a diff and then give notifications for keys that\n      // changed\n      if (!isMobile()) {\n        if (this.state.consecutive_failure_count) {\n          this.state.consecutive_failure_count.forEach((v, key) => {\n            if (!data.consecutive_failure_count.has(key)) {\n              // It's fixed!\n              new Notification(\" \" + this.props.job, {\n                body: summarize_job(key),\n              });\n            }\n          });\n        }\n        data.consecutive_failure_count.forEach((v, key) => {\n          // Don't produce notifications for initial failure!\n          if (\n            this.state.consecutive_failure_count &&\n            !this.state.consecutive_failure_count.has(key)\n          ) {\n            // It's failed!\n            new Notification(\" \" + this.props.job, {\n              body: summarize_job(key),\n            });\n          }\n        });\n      }\n    }\n\n    this.setState(data);\n  }\n\n  nameMatches(name, filter) {\n    if (name.includes(filter)) {\n      return true;\n    }\n\n    // try-catch this since filter is user supplied and RegExp errors on invalid\n    // regexes\n    try {\n      const regex = new RegExp(filter);\n      return Boolean(name.match(regex));\n    } catch {\n      return false;\n    }\n  }\n\n  shouldShowJob(name) {\n    const jobNameFilter = this.state.jobNameFilter;\n    if (jobNameFilter.length > 0 && !this.nameMatches(name, jobNameFilter)) {\n      return false;\n    }\n    const isDockerJob = name.startsWith(\"ci/circleci: docker\");\n    const isGCJob = name.startsWith(\"ci/circleci: ecr_gc\");\n    const isCIFlowShouldRunJob = name.endsWith(\"ciflow_should_run\");\n    const isGenerateTestMatrixJob = name.endsWith(\"generate-test-matrix\");\n    return !(\n      isDockerJob ||\n      name === \"welcome\" ||\n      isGCJob ||\n      isCIFlowShouldRunJob ||\n      isGenerateTestMatrixJob\n    );\n  }\n\n  render() {\n    // Initialize the groups\n    let groups = getGroups(this.props.repo);\n\n    for (const group of groups) {\n      group.jobNames = [];\n    }\n\n    if (!this.state.groupJobs) {\n      groups = [];\n    }\n\n    const findGroup = (jobName) => {\n      for (const group of groups) {\n        if (jobName.match(group.regex)) {\n          return group;\n        }\n      }\n      return null;\n    };\n\n    const groupIsExpanded = (group) => {\n      for (const stateGroup of this.state.showGroups) {\n        if (stateGroup.name === group.name) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n    const groupIsFailing = (group) => {\n      for (const jobName of group.jobNames) {\n        if (\n          this.state.consecutive_failure_count &&\n          this.state.consecutive_failure_count.has(jobName)\n        ) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    function result_icon(result) {\n      if (is_success(result))\n        return (\n          <span role=\"img\" style={{ color: \"green\" }} aria-label=\"passed\">\n            0\n          </span>\n        );\n      if (is_skipped(result))\n        return (\n          <span role=\"img\" style={{ color: \"gray\" }} aria-label=\"skipped\">\n            S\n          </span>\n        );\n      if (is_failure(result))\n        return (\n          <span role=\"img\" style={{ color: \"red\" }} aria-label=\"failed\">\n            X\n          </span>\n        );\n      if (is_aborted(result))\n        return (\n          <span\n            role=\"img\"\n            style={{ marginLeft: \"-2px\", color: \"gray\" }}\n            aria-label=\"cancelled\"\n          >\n            <FcCancel />\n          </span>\n        );\n      if (is_pending(result))\n        return (\n          <span\n            className=\"animate-flicker\"\n            role=\"img\"\n            style={{ color: \"goldenrod\" }}\n            aria-label=\"in progress\"\n          >\n            ?\n          </span>\n        );\n      if (is_infra_failure(result))\n        return (\n          <span role=\"img\" style={{ color: \"grey\" }} aria-label=\"failed\">\n            X\n          </span>\n        );\n      return result;\n    }\n\n    let builds = this.state.builds;\n    let consecutive_failure_count = this.state.consecutive_failure_count;\n\n    const visibleJobs = this.state.known_jobs.filter((name) =>\n      this.shouldShowJob(name)\n    );\n    let s = \"\";\n    for (const j of visibleJobs) {\n      s += j + \"\\n\";\n    }\n\n    // Collapse down groups of jobs based on a regex match to the name\n    const groupedVisibleJobsMap = {};\n    for (const jobName of visibleJobs) {\n      let group = findGroup(jobName);\n\n      if (!group || groupIsExpanded(group)) {\n        // Fake a group of size one\n        group = {\n          name: jobName,\n          jobNames: [jobName],\n        };\n      } else {\n        group.jobNames.push(jobName);\n      }\n      groupedVisibleJobsMap[group.name] = group;\n    }\n\n    // Go from the map of name -> group to a sorted list\n    let groupedVisibleJobs = [];\n    for (const groupName in groupedVisibleJobsMap) {\n      groupedVisibleJobs.push({\n        name: groupName,\n        group: groupedVisibleJobsMap[groupName],\n      });\n    }\n\n    for (const group of this.state.showGroups) {\n      // Keep in headers for expanded groups\n      groupedVisibleJobs.push({\n        name: group.name,\n        group: group,\n      });\n    }\n\n    // Sort by group name\n    groupedVisibleJobs.sort((a, b) => {\n      if (a.name < b.name) {\n        return -1;\n      }\n      if (a.name > b.name) {\n        return 1;\n      }\n      return 0;\n    });\n\n    // Now that jobs have been globally sorted, shuffle around the expanded groups\n    // so they show up next to their group header\n    for (const group of this.state.showGroups) {\n      let groupBaseIndex = groupedVisibleJobs.findIndex(\n        (job) => job.name == group.name\n      );\n      if (groupBaseIndex === null) {\n        console.error(`Unable to find group ${group.name}`);\n        continue;\n      }\n\n      for (const jobName of group.jobNames) {\n        let jobIndex = groupedVisibleJobs.findIndex(\n          (job) => job.name == jobName\n        );\n        if (jobIndex === null) {\n          console.error(`Unable to job ${jobName} in group ${group.name}`);\n          continue;\n        }\n        if (jobIndex < groupBaseIndex) {\n          array_move(groupedVisibleJobs, jobIndex, groupBaseIndex);\n        } else {\n          array_move(groupedVisibleJobs, jobIndex, groupBaseIndex + 1);\n        }\n      }\n    }\n\n    const toggleGroup = (group) => {\n      let showGroups = this.state.showGroups;\n\n      if (groupIsExpanded(group)) {\n        // Remove the group\n        showGroups.pop(\n          showGroups.findIndex((shownGroup) => shownGroup.name === group.name)\n        );\n      } else {\n        showGroups.push(group);\n      }\n      this.setState({ showGroups: showGroups });\n    };\n\n    const visibleJobsHeaders = [];\n    for (const data of groupedVisibleJobs) {\n      let jobName = data.name;\n      if (data.group.jobNames.length === 1) {\n        jobName = data.group.jobNames[0];\n      }\n      let header = (\n        <th className=\"rotate\" key={jobName}>\n          <div\n            className={\n              consecutive_failure_count &&\n              consecutive_failure_count.has(jobName)\n                ? \"failing-header\"\n                : \"\"\n            }\n          >\n            {summarize_job(jobName)}\n          </div>\n        </th>\n      );\n\n      if (data.group.jobNames.length > 1) {\n        const group = data.group;\n        let icon = <BsFillCaretRightFill />;\n\n        if (groupIsExpanded(group)) {\n          icon = <BsFillCaretDownFill />;\n        }\n\n        let headerClass = \"\";\n        if (groupIsFailing(group)) {\n          headerClass = \"failing-text\";\n        }\n\n        header = (\n          <th className=\"rotate\" key={jobName}>\n            <div\n              onClick={() => {\n                toggleGroup(group);\n              }}\n              onAuxClick={() => {\n                toggleGroup(group);\n              }}\n              style={{ cursor: \"pointer\" }}\n            >\n              <span style={{ color: \"#d0d0d0\" }}>Group </span>\n              <span className={headerClass}>{group.name}</span> {icon}\n            </div>\n          </th>\n        );\n      }\n      visibleJobsHeaders.push(header);\n    }\n\n    function aggregateStatus(jobs) {\n      // The logic here follows these rules (in order):\n      // 1. If there are no jobs, return no status\n      // 2. Failed if any job is failed\n      // 3. Pending if any job is pending\n      // 4. Success if all jobs are success, skipped, or aborted\n      // 5. Otherwise pending\n\n      jobs = jobs.filter((x) => x !== undefined);\n      if (jobs.length == 0) {\n        // No jobs in the group so don't show anything\n        return null;\n      }\n\n      for (const job of jobs) {\n        if (is_failure(job.status) || is_infra_failure(job.status)) {\n          return \"failure\";\n        }\n      }\n\n      for (const job of jobs) {\n        if (is_pending(job.status)) {\n          return \"pending\";\n        }\n      }\n\n      let allOk = true;\n      for (const job of jobs) {\n        if (\n          !(\n            is_success(job.status) ||\n            is_skipped(job.status) ||\n            is_aborted(job.status)\n          )\n        ) {\n          allOk = false;\n        }\n      }\n      if (allOk) {\n        return \"success\";\n      }\n\n      return \"pending\";\n    }\n\n    const decoratedBuildUrl = (url) => {\n      // Add check_suite_focus=true to GHA checkruns\n      const ghaRegex = new RegExp(\n        \"^https://github.com/\" +\n          this.props.user +\n          \"/\" +\n          this.props.repo +\n          \"/runs/\\\\d+$\"\n      );\n      if (url.match(ghaRegex)) {\n        return url + \"?check_suite_focus=true\";\n      }\n      return url;\n    };\n    builds.forEach((build) => {\n      build.sb_map.forEach((item) => {\n        if (item.status) {\n          item.status = item.status.toLowerCase();\n        }\n      });\n    });\n    const rows = builds.map((build) => {\n      let found = false;\n      const sb_map = build.sb_map;\n\n      const status_cols = groupedVisibleJobs.map((data) => {\n        let cell = <Fragment />;\n        let jobName = data.name;\n\n        if (data.group.jobNames.length > 1) {\n          // For groups, get the status of all the jobs in the group\n          jobName = `Group: ${data.group.name}`;\n          const jobs = data.group.jobNames.map((jobName) =>\n            sb_map.get(jobName)\n          );\n          const status = aggregateStatus(jobs);\n          if (status) {\n            cell = (\n              <div\n                className=\"display-cell\"\n                style={{\n                  fontWeight: \"bold\",\n                }}\n                onClick={() => {\n                  toggleGroup(data.group);\n                }}\n                onAuxClick={() => {\n                  toggleGroup(data.group);\n                }}\n              >\n                {result_icon(status)}\n              </div>\n            );\n            found = true;\n          }\n        } else {\n          // Ungrouped job, show it directly\n          if (data.group.jobNames.length === 1) {\n            jobName = data.group.jobNames[0];\n          }\n          const sb = sb_map.get(jobName);\n          if (sb !== undefined) {\n            found = true;\n            cell = (\n              <div className=\"display-cell\">\n                <a\n                  href={decoratedBuildUrl(sb.build_url)}\n                  className=\"icon\"\n                  target=\"_blank\"\n                  alt={jobName}\n                >\n                  {result_icon(sb.status)}\n                </a>\n              </div>\n            );\n          }\n        }\n\n        return (\n          <Tooltip\n            key={jobName}\n            overlay={jobName}\n            mouseLeaveDelay={0}\n            placement=\"rightTop\"\n            destroyTooltipOnHide={{ keepParent: false }}\n          >\n            <td key={jobName} className=\"icon-cell\">\n              {cell}\n            </td>\n          </Tooltip>\n        );\n      });\n\n      function drop_pr_number(msg) {\n        return msg.replace(/\\(#[0-9]+\\)/, \"\");\n      }\n\n      const renderPullRequestNumber = (comment) => {\n        let m = comment.match(/\\(#(\\d+)\\)/);\n        if (m) {\n          return (\n            <Fragment>\n              <a\n                href={`https://github.com/${this.props.user}/${this.props.repo}/pull/${m[1]}`}\n                target=\"_blank\"\n              >\n                #{m[1]}\n              </a>\n            </Fragment>\n          );\n        }\n        m = comment.match(\n          /https:\\/\\/github.com\\/pytorch\\/pytorch\\/pull\\/(\\d+)/\n        );\n        if (m) {\n          return (\n            <Fragment>\n              <a\n                href={`https://github.com/${this.props.user}/${this.props.repo}/pull/${m[1]}`}\n                target=\"_blank\"\n              >\n                #{m[1]}\n              </a>\n            </Fragment>\n          );\n        }\n        return <Fragment />;\n      };\n\n      let author = build.author.username;\n\n      const desc = (\n        <div key={build.id}>\n          <a\n            style={{ color: \"#003d7f\" }}\n            href={`/commit/${this.props.user}/${this.props.repo}/${build.id}`}\n          >\n            {drop_pr_number(build.message).split(\"\\n\")[0]}{\" \"}\n          </a>\n          <code>\n            <a\n              href={`https://github.com/${this.props.user}/${this.props.repo}/commit/${build.id}`}\n              target=\"_blank\"\n            >\n              {build.id.slice(0, 7)}\n            </a>\n          </code>\n        </div>\n      );\n\n      // TODO: Too lazy to set up PR numbers for the old ones\n\n      let stale = false;\n\n      // TODO: need to store this in index or payload\n      const whenString = summarize_date(build.timestamp);\n\n      // TODO: Add preference to show/hide those\n      // if (!found) {\n      //  return <Fragment key={build.id} />;\n      // }\n\n      return (\n        <tr key={build.id} className={stale ? \"stale\" : \"\"}>\n          <td className=\"left-cell\" title={build.timestamp}>\n            {whenString}\n          </td>\n          {status_cols}\n          <td\n            className=\"right-cell\"\n            style={{\n              maxWidth: \"6em\",\n              textOverflow: \"ellipsis\",\n              overflow: \"hidden\",\n            }}\n          >\n            {author}\n          </td>\n          <th\n            className=\"right-cell\"\n            style={{ paddingLeft: \"0\", paddingRight: \"5px\" }}\n          >\n            {renderPullRequestNumber(build.message)}\n          </th>\n          <td>{desc}</td>\n        </tr>\n      );\n    });\n\n    let loadingInfo = null;\n    if (this.state.fetchError) {\n      loadingInfo = (\n        <p>\n          Error fetching commits, either the branch does not exist or is not\n          tracked by the{\" \"}\n          <a href=\"https://github.com/pytorch/test-infra/tree/main/aws/lambda/github-status-sync\">\n            status syncing job\n          </a>\n        </p>\n      );\n    } else if (this.state.fetchedBuilds && rows.length == 0) {\n      loadingInfo = <p>Fetched data but found no rows</p>;\n    } else if (!this.state.fetchedBuilds) {\n      loadingInfo = (\n        <div style={{ margin: \"10px\" }}>\n          <ImSpinner2 className=\"icon-spin\" />\n        </div>\n      );\n    }\n\n    let lastUpdate = null;\n    if (this.state.lastUpdateDate) {\n      lastUpdate = (\n        <p style={{ fontSize: \"0.8em\" }}>\n          Last updated {this.state.lastUpdateDate.toLocaleString()}\n        </p>\n      );\n    }\n\n    return (\n      <div>\n        <h4>\n          <a\n            href={`https://github.com/${this.props.user}/${this.props.repo}/commits/${this.props.branch}`}\n          >\n            {this.props.user}/{this.props.repo}/{this.props.branch}\n          </a>{\" \"}\n          CI history{\" \"}\n        </h4>\n        {lastUpdate}\n        <div>\n          <ul className=\"menu\">\n            {isMobile() ? null : (\n              <li>\n                <input\n                  type=\"checkbox\"\n                  name=\"show-notifications\"\n                  checked={this.state.showNotifications}\n                  onChange={(e) =>\n                    this.setState({ showNotifications: e.target.checked })\n                  }\n                />\n                <label htmlFor=\"show-notifications\">\n                  Show notifications on master failure\n                  {this.state.showNotifications &&\n                  Notification &&\n                  Notification.permission === \"denied\" ? (\n                    <Fragment>\n                      {\" \"}\n                      <strong>\n                        (WARNING: notifications are currently denied)\n                      </strong>\n                    </Fragment>\n                  ) : (\n                    \"\"\n                  )}\n                </label>\n              </li>\n            )}\n            {isMobile() ? null : <br />}\n            <li>\n              <input\n                type=\"checkbox\"\n                name=\"group-jobs\"\n                checked={this.state.groupJobs}\n                onChange={(e) => this.setState({ groupJobs: e.target.checked })}\n              />\n              <label htmlFor=\"group-jobs\">Group related jobs</label>\n            </li>\n            <li>\n              <NameFilterForm\n                onSubmit={(filter) => {\n                  this.setState({ jobNameFilter: filter });\n                }}\n                defaultValue={this.props.jobNameFilter}\n              />\n            </li>\n          </ul>\n        </div>\n        {rows.length > 0 ? (\n          <table className=\"buildHistoryTable\">\n            <thead>\n              <tr>\n                <th className=\"left-cell\">Date</th>\n                {visibleJobsHeaders}\n                <th className=\"right-cell\">User</th>\n                <th className=\"right-cell\">PR#</th>\n                <th className=\"right-cell\">Description</th>\n              </tr>\n            </thead>\n            <tbody>{rows}</tbody>\n          </table>\n        ) : null}\n\n        {loadingInfo}\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component, Fragment } from \"react\";\nimport Tooltip from \"rc-tooltip\";\nimport axios from \"axios\";\n\nfunction objToStrMap(obj) {\n  let strMap = new Map();\n  for (let k of Object.keys(obj)) {\n    strMap.set(k, obj[k]);\n  }\n  return strMap;\n}\n\n// define the threshold to determine whether it is regression/optimization\nconst THRESHOLD = 0.1;\nconst ROUND_PRECISION = 100000;\n\nfunction round_float(mean) {\n  return Math.round(mean * ROUND_PRECISION) / ROUND_PRECISION;\n}\n\nexport default class PerfHistoryDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = this.initialState();\n  }\n  initialState() {\n    return {\n      builds: [],\n      known_jobs: [],\n      jobNameFilter: \"\",\n    };\n  }\n  componentDidMount() {\n    this.update();\n  }\n  componentDidUpdate(prevProps) {}\n  async update() {\n    const url_prefix =\n      \"https://s3.amazonaws.com/ossci-metrics/torchbench_v0_nightly\";\n    // branch: v0-nightly\n    const indexes = await axios.get(`${url_prefix}/index.json`);\n    console.log(indexes.data);\n    const requests = indexes.data.map(async (run) => {\n      try {\n        const r = await axios.get(`${url_prefix}/${run.result.relpath}`);\n        run.sb_map = objToStrMap(r.data);\n      } catch (e) {\n        run.sb_map = new Map();\n      }\n      return run;\n    });\n    const builds = await axios.all(requests);\n    const known_jobs_set = new Set();\n    // Use the oldest benchmark run as the standard\n    const standard_benchmark = builds[0].sb_map.get(\"benchmarks\");\n    const benchmark_index = new Map();\n\n    standard_benchmark.forEach((benchmark, index) => {\n      known_jobs_set.add(benchmark[\"name\"]);\n      benchmark_index.set(benchmark[\"name\"], index);\n    });\n    console.log(known_jobs_set);\n    // Figure out if we think there is performance regression or not.\n    // 1. If the test mean is >10% smaller than the previous mean, it is an optimization\n    // 3. If the test mean is >10% larger than the previous mean, it is a regression\n    // 4. Otherwise, it is a stable result\n    for (let i = 0; i < builds.length; i++) {\n      const sb_map = builds[i].sb_map;\n      // Get the test\n      sb_map.get(\"benchmarks\").forEach((benchmark) => {\n        const build_benchmark_mean = benchmark[\"stats\"][\"mean\"];\n        const build_benchmark_index = benchmark_index.get(benchmark[\"name\"]);\n        if (i === 0) {\n          benchmark[\"stats\"][\"prev_mean\"] = build_benchmark_mean;\n        } else {\n          const prev_mean =\n            builds[i - 1].sb_map.get(\"benchmarks\")[build_benchmark_index][\n              \"stats\"\n            ][\"mean\"];\n          benchmark[\"stats\"][\"prev_mean\"] = prev_mean;\n        }\n      });\n    }\n\n    builds.reverse();\n\n    const data = {};\n    data.known_jobs = [...known_jobs_set.values()].sort();\n    data.benchmark_index = benchmark_index;\n    data.builds = builds;\n    this.setState(data);\n  }\n\n  shouldShowJob(name) {\n    const jobNameFilter = this.state.jobNameFilter;\n    if (jobNameFilter.length > 0 && !name.includes(jobNameFilter)) {\n      return false;\n    }\n    return true;\n  }\n\n  render() {\n    function gen_summary(delta) {\n      delta = Math.round(delta * 10000) / 100;\n      if (delta >= 0) {\n        delta = \"+\" + delta;\n      }\n      delta += \"%\";\n      return delta;\n    }\n\n    function is_optimized(delta) {\n      return delta < -1 * THRESHOLD;\n    }\n\n    function is_regression(delta) {\n      return delta > THRESHOLD;\n    }\n\n    function result_icon(result) {\n      if (is_optimized(result))\n        return (\n          <span role=\"img\" style={{ color: \"green\" }} aria-label=\"passed\">\n            0\n          </span>\n        );\n      if (is_regression(result))\n        return (\n          <span role=\"img\" style={{ color: \"red\" }} aria-label=\"failed\">\n            X\n          </span>\n        );\n      return (\n        <span role=\"img\" style={{ color: \"grey\" }} aria-label=\"passed\">\n          -\n        </span>\n      );\n    }\n\n    let builds = this.state.builds;\n    const visible_jobs = this.state.known_jobs.filter((name) =>\n      this.shouldShowJob(name)\n    );\n    const visible_jobs_head = visible_jobs.map((jobName) => (\n      <th className=\"rotate\" key={jobName} width=\"20px;\">\n        <div>{jobName}</div>\n      </th>\n    ));\n    const benchmark_index = this.state.benchmark_index;\n\n    const rows = builds.map((build) => {\n      const sb_map = build.sb_map;\n      const pytorch_version =\n        build.sb_map.get(\"machine_info\")[\"pytorch_version\"];\n      const status_cols = visible_jobs.map((jobName) => {\n        const sb = sb_map.get(\"benchmarks\")[benchmark_index.get(jobName)];\n        const colkey = pytorch_version + \"-\" + jobName;\n        let cell = <Fragment />;\n        const prev_delta =\n          (sb[\"stats\"][\"mean\"] - sb[\"stats\"][\"prev_mean\"]) /\n          sb[\"stats\"][\"prev_mean\"];\n        if (sb !== undefined) {\n          cell = result_icon(prev_delta);\n        }\n        return (\n          <Tooltip\n            key={jobName}\n            overlay={\n              jobName +\n              \" Mean: \" +\n              round_float(sb[\"stats\"][\"mean\"]) +\n              \", prev mean: \" +\n              round_float(sb[\"stats\"][\"prev_mean\"]) +\n              \", delta: \" +\n              gen_summary(prev_delta)\n            }\n            mouseLeaveDelay={0}\n            placement=\"rightTop\"\n            destroyTooltipOnHide={true}\n          >\n            <td\n              key={colkey}\n              className=\"icon-cell\"\n              style={{\n                textAlign: \"right\",\n                fontFamily: \"sans-serif\",\n                padding: 0,\n              }}\n            >\n              {\" \"}\n              {cell}{\" \"}\n            </td>\n          </Tooltip>\n        );\n      });\n\n      return (\n        <tr key={pytorch_version}>\n          <th className=\"left-cell\"> torch-{pytorch_version} </th>\n          {status_cols}\n        </tr>\n      );\n    });\n    return (\n      <div>\n        <h2>TorchBench v0 nightly testing result</h2>\n        <div>\n          <ul className=\"menu\"></ul>\n        </div>\n        <table className=\"perfHistoryTable\">\n          <thead>\n            <tr>\n              <th className=\"left-cell\">Build</th>\n              {visible_jobs_head}\n            </tr>\n          </thead>\n          <tbody>{rows}</tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\n\nconst AUTH_SERVER = \"https://auth.pytorch.org\";\n\nexport default class AuthorizeGitHub extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loggedin: !!localStorage.getItem(\"gh_pat\"),\n    };\n  }\n  componentDidMount() {\n    this.update();\n  }\n\n  async update() {\n    let url = new URL(window.location.href);\n    let code = url.searchParams.get(\"code\");\n    if (!code) {\n      return;\n    }\n    this.state.code = code;\n    let errorMsg = \"bad code passed to GitHub OAuth, sign into GitHub again\";\n    let result = await fetch(`${AUTH_SERVER}/authenticate/${code}`)\n      .then((r) => r.json())\n      .catch((error) => {\n        errorMsg =\n          \"Error happened while communicating to auth server: \" + error;\n        return { token: null };\n      });\n    if (!result.token) {\n      alert(errorMsg);\n    } else {\n      localStorage.setItem(\"gh_pat\", result.token);\n      this.state.loggedin = true;\n    }\n    this.setState(this.state);\n\n    // GitHub redirects back to a URL with just a ?code=... parameter, so store\n    // off to the side the place to go once logged in\n    const lastRedirect = localStorage.getItem(\"last_redirect\");\n    if (lastRedirect) {\n      localStorage.removeItem(\"last_redirect\");\n      if (lastRedirect != window.location.href) {\n        window.location.href = lastRedirect;\n      }\n    }\n  }\n\n  render() {\n    const existingToken = localStorage.getItem(\"gh_pat\");\n    if (existingToken) {\n      return (\n        <div style={{ display: \"inline\" }}>\n          <a href=\"/github_logout\">log out</a>\n        </div>\n      );\n    }\n    if (!this.state.code) {\n      return (\n        <div style={{ display: \"inline\" }}>\n          <a href=\"https://github.com/login/oauth/authorize?scope=public_repo&client_id=7e8b4df19d85405ac1b2\">\n            log in\n          </a>{\" \"}\n        </div>\n      );\n    }\n    return (\n      <div>\n        <p>loading...</p>\n      </div>\n    );\n  }\n}\n","// see https://github.com/qoomon/aws-s3-bucket-browser/blob/937147179a9284dc8d98e7a6d52f60e8fdcd7231/index.html#L430\nexport function formatBytes(size) {\n  if (!size) {\n    return \"-\";\n  }\n  const KB = 1024;\n  if (size < KB) {\n    return size + \"  B\";\n  }\n  const MB = 1000000;\n  if (size < MB) {\n    return (size / KB).toFixed(0) + \" KB\";\n  }\n  const GB = 1000000000;\n  if (size < GB) {\n    return (size / MB).toFixed(2) + \" MB\";\n  }\n  return (size / GB).toFixed(2) + \" GB\";\n}\n\n// see https://stackoverflow.com/a/19448718\nexport function parseXml(xml, arrayTags) {\n  let dom = null;\n  if (window.DOMParser) dom = new DOMParser().parseFromString(xml, \"text/xml\");\n  else if (window.ActiveXObject) {\n    dom = new ActiveXObject(\"Microsoft.XMLDOM\");\n    dom.async = false;\n    if (!dom.loadXML(xml))\n      throw dom.parseError.reason + \" \" + dom.parseError.srcText;\n  } else throw new Error(\"cannot parse xml string!\");\n\n  function parseNode(xmlNode, result) {\n    if (xmlNode.nodeName == \"#text\") {\n      let v = xmlNode.nodeValue;\n      if (v.trim()) result[\"#text\"] = v;\n      return;\n    }\n\n    let jsonNode = {},\n      existing = result[xmlNode.nodeName];\n    if (existing) {\n      if (!Array.isArray(existing))\n        result[xmlNode.nodeName] = [existing, jsonNode];\n      else result[xmlNode.nodeName].push(jsonNode);\n    } else {\n      if (arrayTags && arrayTags.indexOf(xmlNode.nodeName) != -1)\n        result[xmlNode.nodeName] = [jsonNode];\n      else result[xmlNode.nodeName] = jsonNode;\n    }\n\n    if (xmlNode.attributes) {\n      for (let attribute of xmlNode.attributes) {\n        jsonNode[attribute.nodeName] = attribute.nodeValue;\n      }\n    }\n\n    jsonNode.textContent = xmlNode.textContent;\n\n    for (let node of xmlNode.childNodes) parseNode(node, jsonNode);\n  }\n\n  let result = {};\n  for (let node of dom.childNodes) parseNode(node, result);\n\n  return result;\n}\n\nexport async function asyncAll(functions) {\n  // Run a list of arg-less async functions\n  let invoked = functions.map((f) => f());\n  return await Promise.all(invoked);\n}\n\nasync function github_graphql_raw(query) {\n  // Query the GitHub GraphQL API\n  const pat = localStorage.getItem(\"gh_pat\");\n  const result = await fetch(\"https://api.github.com/graphql\", {\n    method: \"POST\",\n    headers: {\n      Authorization: \"token \" + pat,\n    },\n    body: JSON.stringify({ query: query }),\n  });\n  if (result.status !== 200) {\n    throw `Error fetching data from GitHub: ${await result.text()}`;\n  }\n  return await result.json();\n}\n\nasync function github_graphql(query) {\n  return (await github_graphql_raw(query)).data;\n}\n\nexport async function github_json(url) {\n  // Query the GitHub JSON API\n  const pat = localStorage.getItem(\"gh_pat\");\n  const result = await fetch(\"https://api.github.com/\" + url, {\n    headers: {\n      Accept: \"application/vnd.github.v3+json\",\n      Authorization: \"token \" + pat,\n    },\n  });\n  return await result.json();\n}\n\nexport async function github_raw(url) {\n  // Query the GitHub JSON API\n  const pat = localStorage.getItem(\"gh_pat\");\n  const result = await fetch(\"https://api.github.com/\" + url, {\n    headers: {\n      Accept: \"application/vnd.github.v3+json\",\n      Authorization: \"token \" + pat,\n    },\n  });\n  return result;\n}\n\nexport let github = {\n  graphql: github_graphql,\n  graphql_raw: github_graphql_raw,\n  json: github_json,\n  raw: github_raw,\n};\n\nexport async function s3(prefix, bucket) {\n  // List the gha-artifacts S3 bucket by a specific prefix\n  return await fetch(\n    `https://${bucket}.s3.amazonaws.com/?` +\n      new URLSearchParams({\n        \"list-type\": 2,\n        delimiter: \"/\",\n        prefix: prefix,\n        \"max-keys\": 50,\n      })\n  )\n    .then((a) => a.text())\n    .then((a) => parseXml(a));\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport Card from \"react-bootstrap/Card\";\nimport { highlightElement } from \"highlight.js\";\nimport { strFromU8, unzipSync } from \"fflate\";\nimport {\n  GoCheck,\n  BsFillCaretRightFill,\n  BsFillCaretDownFill,\n} from \"react-icons/all\";\n\nimport { parseXml, formatBytes, asyncAll, s3, github } from \"../utils.js\";\n\nclass TestSuite extends Component {\n  constructor(props) {\n    super(props);\n    this.nodeRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.highlight();\n  }\n\n  highlight = () => {\n    if (this.nodeRef) {\n      let code = this.nodeRef.current.children[0];\n      highlightElement(this.nodeRef.current.children[0], {\n        language: \"python\",\n      });\n    }\n  };\n\n  render() {\n    const tcase = this.props.testcase;\n    let failure = tcase.failure || tcase.error;\n\n    let failures = null;\n    if (Array.isArray(failure)) {\n      failures = failure;\n    } else {\n      failures = [failure];\n    }\n\n    let content = failures.map((f) => f.textContent.trim()).join(\"\\n\\n\");\n\n    let fileinfo = null;\n    if (tcase.file && tcase.line) {\n      fileinfo = (\n        <span style={{ color: \"grey\" }}>\n          {tcase.file}:{tcase.line}:\n        </span>\n      );\n    }\n    return (\n      <Card\n        style={{\n          fontFamily: '\"Monaco\", monospace',\n          marginTop: \"5px\",\n          backgroundColor: \"#ffe5e5\",\n        }}\n      >\n        <Card.Body>\n          <div>\n            <p>\n              {fileinfo}\n              {tcase.classname}.{tcase.name}\n            </p>\n            <pre ref={this.nodeRef}>\n              <code className=\"language-python\">{content}</code>\n            </pre>\n          </div>\n        </Card.Body>\n      </Card>\n    );\n  }\n}\n\nclass TestSummary extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showDetail: false,\n    };\n  }\n\n  render() {\n    const toggle = () => {\n      this.state.showDetail = !this.state.showDetail;\n      this.setState(this.state);\n    };\n    const iconStyle = { cursor: \"pointer\" };\n    let icon = <BsFillCaretRightFill style={iconStyle} onClick={toggle} />;\n    if (this.state.showSuites) {\n      icon = <BsFillCaretDownFill style={iconStyle} onClick={toggle} />;\n    }\n    let suiteDetail = null;\n\n    let data = [];\n    for (const [filename, classes] of Object.entries(this.props.info)) {\n      for (const [classname, stats] of Object.entries(classes)) {\n        stats.filename = filename;\n        stats.classname = classname;\n        data.push(stats);\n      }\n    }\n    data = data.sort((a, b) => {\n      a = a.passed + a.error;\n      b = b.passed + b.error;\n      return b - a;\n    });\n    let totals = {\n      passed: 0,\n      error: 0,\n      skipped: 0,\n    };\n    for (const item of data) {\n      totals.passed += item.passed;\n      totals.error += item.error;\n      totals.skipped += item.skipped;\n    }\n    if (this.state.showDetail) {\n      let rows = [];\n      for (const classStats of data) {\n        let filename = classStats.filename.split(\"/\").slice(-1)[0];\n        let name = `${filename}:${classStats.classname}`;\n        rows.push(\n          <tr\n            style={{\n              fontSize: \"12px\",\n              backgroundColor: classStats.error > 0 ? \"#ffe4e4\" : \"white\",\n            }}\n            key={name}\n          >\n            <td style={{ fontFamily: '\"Monaco\", monospace' }}>\n              <span style={{ color: \"grey\" }}>{filename}:</span>\n              <span>{classStats.classname}</span>\n            </td>\n            <td className=\"center\">{classStats.passed}</td>\n            <td className=\"center\">{classStats.error}</td>\n            <td className=\"center\">{classStats.skipped}</td>\n          </tr>\n        );\n      }\n      suiteDetail = (\n        <table style={{ marginTop: \"6px\" }} className=\"table\">\n          <thead>\n            <tr>\n              <th className=\"center\">Name</th>\n              <th className=\"center\">Passed</th>\n              <th className=\"center\">Errors</th>\n              <th className=\"center\">Skipped</th>\n            </tr>\n          </thead>\n          <tbody>{rows}</tbody>\n        </table>\n      );\n    }\n    return (\n      <Card\n        style={{\n          marginTop: \"5px\",\n        }}\n      >\n        <Card.Body>\n          <Card.Title style={{ marginBottom: 0 }}>Test Summary</Card.Title>\n          <div>\n            <p style={{ marginBottom: 0 }}>\n              Ran {this.props.totals.cases} test cases in{\" \"}\n              {this.props.totals.classes} classes from {this.props.totals.files}{\" \"}\n              files\n            </p>\n            <p style={{ marginBottom: 0 }}>\n              {totals.passed} tests passed, {totals.error} tests failed,{\" \"}\n              {totals.skipped} tests skipped\n              <button\n                style={{ marginLeft: \"10px\", fontSize: \"0.8em\" }}\n                className=\"btn btn-secondary\"\n                onClick={toggle}\n              >\n                {this.state.showDetail ? \"Hide\" : \"Show\"} Details\n              </button>\n            </p>\n            {suiteDetail}\n          </div>\n        </Card.Body>\n      </Card>\n    );\n  }\n}\n\n// Given a URL to a .zip of test reports (as we have in CI), download it then\n// render a summary + the failures in a nice way\nexport default class TestReportRenderer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n  componentDidMount() {\n    this.update().catch((error) => {\n      this.state.updateFailure = error.toString();\n      console.error(error);\n      this.setState(this.state);\n    });\n  }\n\n  async update() {\n    // Download the test report\n    let buf = await fetch(this.props.testReportZip).then((r) =>\n      r.arrayBuffer()\n    );\n    let reports = {};\n\n    const file = new Uint8Array(buf);\n    let inner = unzipSync(file);\n    for (const innerFilename in inner) {\n      let key = innerFilename\n        .replace(\"test/test-reports/\", \"\")\n        .replace(\".xml\", \"\");\n      reports[key] = parseXml(strFromU8(inner[innerFilename]));\n    }\n\n    let suites = [];\n    for (const filename in reports) {\n      let data = reports[filename];\n      if (data.testsuite) {\n        suites.push(data.testsuite);\n      } else if (data.testsuites) {\n        if (Array.isArray(data.testsuites.testsuite)) {\n          for (const suite of data.testsuites.testsuite) {\n            suites.push(suite);\n          }\n        } else if (data.testsuites.testsuite) {\n          suites.push(data.testsuites.testsuite);\n        }\n      } else {\n        console.error(\"Unknown report type\", data);\n      }\n    }\n\n    let failures = [];\n    let testInfo = {};\n    const totals = {\n      classes: 0,\n      cases: 0,\n      files: 0,\n      time: 0,\n    };\n    for (const suite of suites) {\n      let numErrors = +suite.errors;\n      let numFailures = +suite.failures;\n      let cases = suite.testcase;\n      if (!Array.isArray(cases)) {\n        cases = [cases];\n      }\n      if (numErrors + numFailures > 0) {\n        for (const testcase of cases) {\n          if (testcase.failure || testcase.error) {\n            failures.push(testcase);\n          }\n        }\n      }\n\n      const getStatus = (testcase) => {\n        if (testcase.skipped) {\n          return \"skipped\";\n        }\n        if (testcase.error || testcase.failure) {\n          return \"error\";\n        }\n        return \"passed\";\n      };\n      for (const testcase of cases) {\n        totals.cases += 1;\n        if (!testInfo[testcase.file]) {\n          testInfo[testcase.file] = {};\n          totals.files += 1;\n        }\n        if (!testInfo[testcase.file][testcase.classname]) {\n          totals.classes += 1;\n          testInfo[testcase.file][testcase.classname] = {\n            passed: 0,\n            error: 0,\n            skipped: 0,\n            time: 0,\n            cases: 0,\n          };\n        }\n        totals.time += +testcase.time;\n        testInfo[testcase.file][testcase.classname][getStatus(testcase)] += 1;\n        testInfo[testcase.file][testcase.classname].cases += 1;\n        testInfo[testcase.file][testcase.classname].time += +testcase.time;\n      }\n    }\n\n    this.state.failures = failures;\n    this.state.totals = totals;\n    this.state.testInfo = testInfo;\n    this.setState(this.state);\n  }\n\n  renderSummary() {}\n\n  render() {\n    if (!this.state.failures) {\n      if (this.state.updateFailure) {\n        return (\n          <p style={{ color: \"red\" }}>\n            Loading/parsing failed: {this.state.updateFailure}\n          </p>\n        );\n      }\n      return <p>loading and parsing test results...</p>;\n    }\n\n    let results = [];\n\n    const summary = (\n      <TestSummary info={this.state.testInfo} totals={this.state.totals} />\n    );\n\n    if (this.state.failures.length == 0) {\n      return (\n        <div>\n          {summary}\n          <Card\n            style={{\n              marginTop: \"5px\",\n              backgroundColor: \"#ebffeb\",\n            }}\n          >\n            <Card.Body>\n              <Card.Title style={{ marginBottom: 0 }}>\n                <GoCheck style={{ color: \"#22863a\" }} />{\" \"}\n                <span>All tests passed</span>\n              </Card.Title>\n            </Card.Body>\n          </Card>\n        </div>\n      );\n    }\n\n    let i = 0;\n    for (let testcase of this.state.failures) {\n      results.push(<TestSuite key={i++} testcase={testcase} />);\n    }\n\n    return (\n      <div>\n        {summary}\n        {results}\n      </div>\n    );\n  }\n}\n","export function filterLog(log) {\n  let negativeRegexes = [\n    /Z Entering 'third_party/,\n    /Z http\\.https:\\/\\/github\\.com\\/\\.extraheader/,\n    /Z deleted: sha256/,\n    /Z untagged: sha256/,\n    /Z untagged: .*amazonaws/,\n    /Z \\s*adding: /,\n    /Z \\s*creating: /,\n    /Z \\s*inflating: /,\n    /Z \\s*extracting: /,\n    /Z adding /,\n    /Z copying /,\n    /Z creating /,\n    /Z refs\\/remotes\\/origin/,\n    /Z Synchronizing submodule url for/,\n    /Z Receiving objects:/,\n    /Z Resolving deltas:/,\n    /Z remote: Compressing objects:/,\n    /Z Submodule path /,\n    /Z remote: Counting objects:/,\n    /Z [a-z0-9]{12}: Waiting/,\n    /Z [a-z0-9]{12}: Pulling fs layer/,\n    /Z [a-z0-9]{12}: Verifying Checksum/,\n    /Z [a-z0-9]{12}: Download complete/,\n    /Z [a-z0-9]{12}: Pull complete/,\n    /Z url\\.https:\\/\\/github\\.com/,\n    /Z Generating XML reports/,\n    /Z Generated XML report/,\n    /Z Test results will be stored/,\n  ];\n\n  const lines = log.split(\"\\n\");\n  let newLog = \"\";\n\n  for (const line of lines) {\n    let include = true;\n    for (const regex of negativeRegexes) {\n      if (line.match(regex)) {\n        include = false;\n        break;\n      }\n    }\n    if (include) {\n      newLog += line + \"\\n\";\n    }\n  }\n  return newLog;\n}\n\nexport function registerLogLanguage(monaco, groupRanges) {\n  // Register a new language\n  monaco.languages.register({ id: \"logText\" });\n\n  // Register a tokens provider for the language\n  monaco.languages.setMonarchTokensProvider(\"logText\", {\n    tokenizer: {\n      root: [\n        [/\\[30;1m.*?\\[0m/, \"black\"],\n        [/\\[31;1m.*?\\[0m/, \"red\"],\n        [/\\[32;1m.*?\\[0m/, \"green\"],\n        [/\\[33;1m.*?\\[0m/, \"yellow\"],\n        [/\\[34;1m.*?\\[0m/, \"blue\"],\n        [/\\[35;1m.*?\\[0m/, \"magenta\"],\n        [/\\[36;1m.*?\\[0m/, \"cyan\"],\n        [/\\[37;1m.*?\\[0m/, \"white\"],\n\n        [/\\[30m.*?\\[0m/, \"black\"],\n        [/\\[31m.*?\\[0m/, \"red\"],\n        [/\\[32m.*?\\[0m/, \"green\"],\n        [/\\[33m.*?\\[0m/, \"yellow\"],\n        [/\\[34m.*?\\[0m/, \"blue\"],\n        [/\\[35m.*?\\[0m/, \"magenta\"],\n        [/\\[36m.*?\\[0m/, \"cyan\"],\n        [/\\[37m.*?\\[0m/, \"white\"],\n\n        [/\\[0;1;30m.*?\\[0m/, \"black\"],\n        [/\\[0;1;31m.*?\\[0m/, \"red\"],\n        [/\\[0;1;32m.*?\\[0m/, \"green\"],\n        [/\\[0;1;33m.*?\\[0m/, \"yellow\"],\n        [/\\[0;1;34m.*?\\[0m/, \"blue\"],\n        [/\\[0;1;35m.*?\\[0m/, \"magenta\"],\n        [/\\[0;1;36m.*?\\[0m/, \"cyan\"],\n        [/\\[0;1;37m.*?\\[0m/, \"white\"],\n\n        [/\\[1m.*?\\[0m/, \"cyan\"],\n        [/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{7}Z/, \"hidden\"],\n      ],\n    },\n  });\n\n  // Define a new theme that contains only rules that match this language\n  monaco.editor.defineTheme(\"logTheme\", {\n    base: \"vs-dark\",\n    inherit: true,\n    rules: [\n      { token: \"black\", foreground: \"000000\", fontStyle: \"bold\" },\n      { token: \"red\", foreground: \"af0000\", fontStyle: \"bold\" },\n      { token: \"green\", foreground: \"87d700\", fontStyle: \"bold\" },\n      { token: \"yellow\", foreground: \"d7d700\", fontStyle: \"bold\" },\n      { token: \"blue\", foreground: \"5fd7ff\", fontStyle: \"bold\" },\n      { token: \"magenta\", foreground: \"8700af\", fontStyle: \"bold\" },\n      { token: \"cyan\", foreground: \"00af87\", fontStyle: \"bold\" },\n      { token: \"white\", foreground: \"ffffff\", fontStyle: \"bold\" },\n      { token: \"hidden\", foreground: \"5f5f5f\" },\n    ],\n  });\n\n  monaco.languages.registerFoldingRangeProvider(\"logText\", {\n    provideFoldingRanges: function (model, context, token) {\n      return groupRanges;\n    },\n  });\n}\n","import React, { Component } from \"react\";\nimport Card from \"react-bootstrap/Card\";\nimport ButtonGroup from \"react-bootstrap/ButtonGroup\";\nimport ToggleButton from \"react-bootstrap/ToggleButton\";\nimport Button from \"react-bootstrap/Button\";\nimport Editor from \"@monaco-editor/react\";\nimport { filterLog, registerLogLanguage } from \"./logs.js\";\n\nimport {\n  BsFillCaretRightFill,\n  BsCaretDownFill,\n  BsFillCaretDownFill,\n  GoPrimitiveDot,\n  GoCircleSlash,\n  GoCheck,\n  GoX,\n} from \"react-icons/all\";\n\nexport default class CircleCICard extends Component {\n  constructor(props) {\n    super(props);\n    let buildMatch = props.status.targetUrl.match(/pytorch\\/pytorch\\/(\\d+)/);\n    this.state = {\n      showSteps: {},\n    };\n\n    if (buildMatch) {\n      let buildId = buildMatch[1];\n      this.state.url = `https://circleci.com/api/v1.1/project/gh/pytorch/pytorch/${buildId}`;\n    }\n  }\n\n  hasError() {\n    return this.state.errorMessage !== undefined;\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (this.hasError()) {\n      return;\n    }\n    if (!this.state.data) {\n      return;\n    }\n    for (const step of this.state.data.steps) {\n      if (!step.log.shown || step.log.text !== undefined) {\n        continue;\n      }\n\n      fetch(step.actions[0].output_url)\n        .then((log) => log.text())\n        .then((log) => {\n          step.log.text = log.replaceAll(\"\\\\n\", \"\\n\").replaceAll(\"\\\\r\", \"\");\n          this.setState(this.state);\n        });\n    }\n  }\n\n  componentDidMount() {\n    this.update();\n  }\n\n  async update() {\n    let response = await fetch(this.state.url);\n    let data = await response.json();\n    delete data.circle_yml;\n\n    for (const step of data.steps) {\n      step.log = {\n        text: undefined,\n        shown: false,\n        logLevel: \"Minimal\",\n      };\n    }\n\n    this.setState({ data: data });\n  }\n\n  renderStatusIcon(status) {\n    status = status.toUpperCase();\n    // Determine the check's status and turn that into an icon\n    const statuses = {\n      SUCCESS: <GoCheck style={{ color: \"#22863a\" }} />,\n      FAILURE: <GoX style={{ color: \"#cb2431\" }} />,\n      FAILED: <GoX style={{ color: \"#cb2431\" }} />,\n      TIMEDOUT: <GoX style={{ color: \"#cb2431\" }} />,\n      NEUTRAL: <GoCircleSlash style={{ color: \"#959da5\" }} />,\n      CANCELLED: <GoCircleSlash style={{ color: \"rgb(255 86 86)\" }} />,\n    };\n\n    return statuses[status] || <GoPrimitiveDot style={{ color: \"#dbab09\" }} />;\n  }\n\n  renderLogViewer(step) {\n    let log = null;\n    let isShowing = false;\n    const radios = [\"Minimal\", \"All\"];\n    if (step.log.shown) {\n      isShowing = true;\n      if (step.log.text) {\n        let logText = null;\n        if (step.log.logLevel == \"All\") {\n          logText = step.log.text;\n        } else {\n          logText = filterLog(step.log.text);\n        }\n\n        const totalLines = (logText.match(/\\n/g) || \"\").length + 1;\n        let existingEditor = null;\n        if (step.log.existingEditor) {\n          step.log.existingEditor.setValue(logText);\n          step.log.existingEditor.revealLine(totalLines);\n        }\n        log = (\n          <div\n            style={{\n              marginBottom: \"20px\",\n            }}\n          >\n            <div className=\"hideRadio\">\n              <span>Log Level: </span>\n              <div style={{ display: \"inline\" }}>\n                <ButtonGroup>\n                  {radios.map((radio, idx) => (\n                    <ToggleButton\n                      key={idx}\n                      id={`radio-${idx}`}\n                      type=\"radio\"\n                      variant=\"outline-info\"\n                      name=\"radio\"\n                      value={radio}\n                      checked={step.log.logLevel === radio}\n                      onChange={(e) => {\n                        step.log.logLevel = radio;\n                        this.setState(this.state);\n                      }}\n                    >\n                      {radio}\n                    </ToggleButton>\n                  ))}\n                </ButtonGroup>\n              </div>\n            </div>\n            <Editor\n              height=\"80vh\"\n              defaultLanguage=\"logText\"\n              defaultValue={logText}\n              theme=\"logTheme\"\n              beforeMount={(monaco) => {\n                const groupRanges = [];\n                registerLogLanguage(monaco, groupRanges);\n              }}\n              options={{\n                scrollBeyondLastLine: false,\n                lineNumbersMinChars: totalLines.toString().length + 1,\n                folding: true,\n              }}\n              onMount={(editor, monaco) => {\n                step.log.existingEditor = editor;\n                let foldAction = editor.getAction(\"editor.foldAll\");\n                foldAction.run().then(() => {\n                  editor.revealLine(totalLines);\n                });\n              }}\n              loading={<p>Loading viewer...</p>}\n            />\n          </div>\n        );\n      } else {\n        log = <p>Fetching logs...</p>;\n      }\n    }\n    return log;\n  }\n\n  render() {\n    const status = this.props.status;\n\n    let stepsElement = null;\n    let artifactsElement = null;\n\n    if (this.state.data) {\n      let steps = [];\n      for (const [i, step] of this.state.data.steps.entries()) {\n        const name = step.name;\n        const logUrl = step.actions[0].output_url;\n\n        let statusIcon = this.renderStatusIcon(step.actions[0].status);\n        const iconStyle = { cursor: \"pointer\" };\n        // Show the log viewer + toggle chevron\n        const toggle = () => {\n          step.log.shown = !step.log.shown;\n          this.setState(this.state);\n        };\n        let icon = <BsFillCaretRightFill style={iconStyle} onClick={toggle} />;\n        if (step.log.shown) {\n          icon = <BsFillCaretDownFill style={iconStyle} onClick={toggle} />;\n        }\n\n        steps.push(\n          <div\n            style={{ marginBottom: \"2px\" }}\n            key={`status-${status.context}-${name}-${i}`}\n          >\n            {statusIcon} <span>{name}</span> {icon} {this.renderLogViewer(step)}\n            {/* TODO: These are unimplemented for now since CircleCI provides\n             a good view into them already */}\n            {/* {renderResultsButton} */}\n            {/* {artifactDetails} */}\n          </div>\n        );\n      }\n      stepsElement = <div style={{ padding: \"6px\" }}>{steps}</div>;\n    }\n\n    return (\n      <Card key={\"card-\" + status.context}>\n        <Card.Body\n          style={{\n            backgroundColor:\n              status.state === \"FAILURE\" ? \"rgb(255 243 243)\" : null,\n          }}\n        >\n          <Card.Title>\n            <a href={status.targetUrl}>{status.context}</a>\n          </Card.Title>\n          <div>\n            {stepsElement}\n            {artifactsElement}\n          </div>\n        </Card.Body>\n      </Card>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport Card from \"react-bootstrap/Card\";\nimport ButtonGroup from \"react-bootstrap/ButtonGroup\";\nimport ToggleButton from \"react-bootstrap/ToggleButton\";\nimport Button from \"react-bootstrap/Button\";\nimport AuthorizeGitHub from \"./AuthorizeGitHub.js\";\nimport TestReportRenderer from \"./pr/TestReportRenderer.js\";\nimport Editor from \"@monaco-editor/react\";\nimport ReactMarkdown from \"react-markdown\";\nimport { filterLog, registerLogLanguage } from \"./pr/logs.js\";\nimport CircleCICard from \"./pr/CircleCICard.js\";\n\nimport {\n  BsFillCaretRightFill,\n  BsCaretDownFill,\n  BsFillCaretDownFill,\n  GoPrimitiveDot,\n  GoCircleSlash,\n  GoCheck,\n  GoX,\n} from \"react-icons/all\";\n\nimport { parseXml, formatBytes, asyncAll, s3, github } from \"./utils.js\";\n\nconst PREVIEW_BASE_URL = \"https://docs-preview.pytorch.org\";\n\n// Returns true if the location is local or a deploy preview\nfunction isOnDevelopmentHost() {\n  return (\n    window.location.href.startsWith(\"http://localhost\") ||\n    window.location.href.startsWith(\"https://deploy-preview\")\n  );\n}\n\nfunction getPrQuery(user, repo, number) {\n  return `\n    {\n      repository(name: \"${repo}\", owner: \"${user}\") {\n        pullRequest(number: ${number}) {\n          title\n          number\n          url\n          body\n          comments(last: 10) {\n            nodes {\n              author {\n                login\n              }\n              body\n            }\n          }\n          commits(last: 1) {\n            nodes {\n              commit {\n                status {\n                  contexts {\n                    description\n                    context\n                    targetUrl\n                    state\n                  }\n                }\n                checkSuites(last: 100) {\n                  nodes {\n                    databaseId\n                    workflowRun {\n                      runNumber\n                      id\n                      databaseId\n                      workflow {\n                        name\n                        databaseId\n                      }\n                      url\n                    }\n                    checkRuns(last: 100) {\n                      nodes {\n                        name\n                        title\n                        status\n                        conclusion\n                        text\n                        databaseId\n                        detailsUrl\n                        summary\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  `;\n}\n\nfunction getCommitQuery(user, repo, hash) {\n  return `\n    {\n      repository(name: \"${repo}\", owner: \"${user}\") {\n        object(oid:\"${hash}\") {\n          ... on Commit {\n            history(first: 1) {\n              nodes {\n                oid\n                commitUrl\n                messageHeadline\n                messageBody\n                status {\n                  contexts {\n                    description\n                    context\n                    targetUrl\n                    state\n                  }\n                }\n                checkSuites(last: 100) {\n                  nodes {\n                    databaseId\n                    workflowRun {\n                      runNumber\n                      id\n                      databaseId\n                      workflow {\n                        name\n                        databaseId\n                      }\n                      url\n                    }\n                    checkRuns(last: 100) {\n                      nodes {\n                        name\n                        title\n                        status\n                        conclusion\n                        text\n                        databaseId\n                        detailsUrl\n                        summary\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  `;\n}\n\nexport default class PrDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pr_number: this.props.pr_number,\n      commit_hash: this.props.commit_hash,\n      showGroups: [],\n    };\n  }\n\n  componentDidMount() {\n    this.update();\n  }\n\n  isPr() {\n    return this.state.pr_number !== undefined;\n  }\n  hasError() {\n    return this.state.error_message !== undefined;\n  }\n\n  extractItem(result, key) {\n    // Some of the stuff from s3 can come in as a single object or an array,\n    // so unpack that here\n    if (!result[key]) {\n      return null;\n    }\n\n    if (Array.isArray(result[key])) {\n      return result[key];\n    }\n    return [result[key]];\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (this.hasError()) {\n      return;\n    }\n    for (const run of this.state.runs) {\n      for (const check of run.checkRuns.nodes) {\n        if (!check.log.shown || check.log.text !== null) {\n          continue;\n        }\n\n        github\n          .raw(\n            `repos/${this.props.user}/${this.props.repo}/actions/jobs/${check.databaseId}/logs`\n          )\n          .then((log) => log.text())\n          .then((log) => {\n            check.log.text = log;\n            this.setState(this.state);\n          });\n      }\n    }\n  }\n\n  async update() {\n    // Set some global persistent state to redirect back to this window for log\n    // ins\n    localStorage.setItem(\"last_redirect\", window.location.href);\n\n    if (isOnDevelopmentHost()) {\n      // If we're in development, prompt the user for a token to manually enter\n      if (!localStorage.getItem(\"gh_pat\")) {\n        const token = prompt(\n          'In development mode, GitHub API token not found. You can get it from hud.pytorch.org by running localStorage.getItem(\"gh_pat\") in the JavaScript console.'\n        );\n        localStorage.setItem(\"gh_pat\", token);\n      }\n    }\n\n    // Fetch the PR's info from GitHub's GraphQL API\n    if (!localStorage.getItem(\"gh_pat\")) {\n      return;\n    }\n    if (this.hasError()) {\n      return;\n    }\n\n    if (this.isPr()) {\n      let pr_result = await github.graphql(\n        getPrQuery(this.props.user, this.props.repo, this.state.pr_number)\n      );\n      this.state.pr = pr_result.repository.pullRequest;\n      if (this.state.pr === null) {\n        this.state.error_message = \"Failed to fetch PR \" + this.state.pr_number;\n        this.setState(this.state);\n        return;\n      }\n      this.state.commit = this.state.pr.commits.nodes[0].commit;\n    } else {\n      let commit = await github.graphql(\n        getCommitQuery(this.props.user, this.props.repo, this.state.commit_hash)\n      );\n      if (commit.repository.object == null) {\n        this.state.error_message = \"Failed to fetch \" + this.state.commit_hash;\n        this.setState(this.state);\n        return;\n      }\n      this.state.commit = commit.repository.object.history.nodes[0];\n    }\n\n    // The GraphQL API doesn't have any types for artifacts (at least as far as\n    // I can tell), so we have to fall back to iterating through them all via\n    // the v3 JSON API\n    let workflow_runs = this.state.commit.checkSuites.nodes;\n    workflow_runs = workflow_runs.filter((x) => x.workflowRun);\n    workflow_runs.forEach((run) => {\n      run.checkRuns.nodes.forEach((check) => {\n        check.log = {\n          text: null,\n          shown: false,\n          logLevel: \"Minimal\",\n        };\n      });\n    });\n    await asyncAll(\n      workflow_runs.map((run) => {\n        return async () => {\n          let id = run.workflowRun.databaseId;\n          run.artifacts = await github.json(\n            `repos/${this.props.user}/${this.props.repo}/actions/runs/${id}/artifacts`\n          );\n        };\n      })\n    );\n\n    workflow_runs = workflow_runs.sort((a, b) =>\n      a.workflowRun.workflow.name.toUpperCase() >\n      b.workflowRun.workflow.name.toUpperCase()\n        ? 1\n        : -1\n    );\n    this.state.runs = workflow_runs;\n    for (const run of this.state.runs) {\n      run.status = this.mergeStatuses(\n        run.checkRuns.nodes.map((check) => check.conclusion)\n      );\n    }\n    this.state.statuses = this.state.commit.status.contexts;\n    this.setState(this.state);\n\n    // Go through all the runs and check if there is a prefix for the workflow\n    // run in S3 (indicating that there are some relevant artifacts stored\n    // there)\n    let promises = this.state.runs.map((run) => {\n      run.s3_artifacts = [];\n      if (this.props.repo !== \"pytorch\") {\n        // Ignore for non-pytorch/pytorch repos\n        return async () => {\n          // Intentional no-op\n          return;\n        };\n      }\n      return async () => {\n        // Check that the workflow run exists\n        let result = await s3(\n          `pytorch/pytorch/${run.workflowRun.databaseId}/`,\n          \"gha-artifacts\"\n        );\n\n        let prefixes = this.extractItem(\n          result.ListBucketResult,\n          \"CommonPrefixes\"\n        );\n\n        // If anything was found, go through the results and add the items to\n        // the 'run' object in place\n        if (prefixes && prefixes.length > 0) {\n          for (const prefixItem of prefixes) {\n            let prefix = prefixItem.Prefix[\"#text\"];\n            let result = await s3(prefix, \"gha-artifacts\");\n            let contents = this.extractItem(\n              result.ListBucketResult,\n              \"Contents\"\n            );\n            for (const content of contents) {\n              run.s3_artifacts.push(content);\n            }\n          }\n        }\n      };\n    });\n    await asyncAll(promises);\n    this.setState(this.state);\n  }\n\n  renderDocPreviewButton() {\n    // Search through all the checks for a docs build, if it's completed then\n    // assume it's also been uploaded to S3 (which should happen as part of the\n    // docs build on PRs)\n    let python = null;\n    let cpp = null;\n\n    const runIsPassing = (name) => {\n      for (const [run_index, run] of this.state.runs.entries()) {\n        for (const [index, check] of run.checkRuns.nodes.entries()) {\n          if (\n            check.name === name &&\n            check.status === \"COMPLETED\" &&\n            check.conclusion === \"SUCCESS\"\n          ) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n\n    if (this.state.runs) {\n      if (runIsPassing(\"build-docs (python)\")) {\n        python = (\n          <a\n            href={`${PREVIEW_BASE_URL}/${this.state.pr_number}/index.html`}\n            target=\"_blank\"\n            className=\"btn btn-primary\"\n            style={{ marginRight: \"5px\" }}\n          >\n            Python Docs\n          </a>\n        );\n      }\n      if (runIsPassing(\"build-docs (cpp)\")) {\n        cpp = (\n          <a\n            href={`${PREVIEW_BASE_URL}/${this.state.pr_number}/cppdocs/index.html`}\n            target=\"_blank\"\n            className=\"btn btn-primary\"\n          >\n            C++ Docs\n          </a>\n        );\n      }\n    }\n    return (\n      <div style={{ paddingBottom: \"5px\" }}>\n        {python}\n\n        {cpp}\n      </div>\n    );\n  }\n\n  renderTitle() {\n    let title = null;\n    if (this.state.commit) {\n      if (this.isPr()) {\n        title = (\n          <div>\n            <h3>\n              <a\n                href={`https://github.com/${this.props.user}/${this.props.repo}/pull/${this.state.pr_number}`}\n              >\n                {this.state.pr.title} (#{this.state.pr_number})\n              </a>\n            </h3>\n          </div>\n        );\n      } else {\n        let subject = this.state.commit.messageHeadline;\n        let headline = <p>{subject}</p>;\n        let match = subject.match(/\\(#([\\d]+)\\)$/);\n        if (match && match[1]) {\n          let pr_number = match[1];\n          subject = subject.replace(match[0], \"\");\n          headline = (\n            <p>\n              {subject}{\" \"}\n              <a\n                href={`https://github.com/${this.props.user}/${this.props.repo}/pull/${pr_number}`}\n              >\n                (#{pr_number})\n              </a>\n            </p>\n          );\n        }\n\n        title = (\n          <div>\n            <h2>\n              Commit{\" \"}\n              <a href={this.state.commit.commitUrl}>\n                {this.state.commit.oid.slice(0, 7)}\n              </a>\n            </h2>\n            {headline}\n          </div>\n        );\n      }\n    }\n    return title;\n  }\n\n  findDiffInComments(comments) {\n    let diff = null;\n    for (const comment of comments) {\n      // We don't care about user supplied updates from ghstack since those are\n      // in the PR body\n      if (comment.author.login === \"facebook-github-bot\") {\n        let match = comment.body.match(\n          /https:\\/\\/www\\.internalfb\\.com\\/diff\\/(D\\d+)/\n        );\n        if (match) {\n          diff = match[1];\n        }\n      }\n    }\n    return diff;\n  }\n\n  renderDiff() {\n    if (!this.state.commit) {\n      return null;\n    }\n\n    // Try to find the diff in the commit message or PR body\n    let text = this.state.commit.messageBody;\n    let diff = null;\n    if (this.isPr()) {\n      text = this.state.pr.body;\n    }\n    const match = text.match(/Differential Revision: (\\[)?(D\\d+)(\\])?/);\n    if (match) {\n      diff = match[2];\n    }\n\n    if (!diff && this.isPr()) {\n      // If we didn't find a diff, search the PR comment for facebook-github-bot\n      // comments\n      diff = this.findDiffInComments(this.state.pr.comments.nodes);\n    }\n\n    return <a href={`https://www.internalfb.com/diff/${diff}`}>{diff}</a>;\n  }\n\n  renderBody() {\n    if (!this.state.commit) {\n      return null;\n    }\n\n    let text = this.state.commit.messageBody;\n    if (this.isPr()) {\n      text = this.state.pr.body;\n    }\n\n    return (\n      <div style={{ maxHeight: \"13em\", overflow: \"scroll\", margin: \"10px\" }}>\n        <ReactMarkdown children={text} />\n      </div>\n    );\n  }\n\n  getGroupRanges(monaco, text) {\n    const lines = text.split(\"\\n\");\n    const starts = [];\n    const ends = [];\n    let lineNumber = 0;\n    for (const line of lines) {\n      if (line.includes(\"##[group]\")) {\n        starts.push(lineNumber);\n      } else if (line.includes(\"##[endgroup]\")) {\n        ends.push(lineNumber);\n      }\n      lineNumber += 1;\n    }\n    let ranges = [];\n    for (let i = 0; i < Math.min(starts.length, ends.length); i++) {\n      ranges.push({\n        start: starts[i] + 1,\n        end: ends[i] + 1,\n        kind: monaco.languages.FoldingRangeKind.Imports,\n      });\n    }\n    return ranges;\n  }\n\n  renderLogViewer(check) {\n    let log = null;\n    let isShowing = false;\n    const radios = [\"Minimal\", \"All\"];\n    if (check.log.shown) {\n      isShowing = true;\n      if (check.log.text) {\n        let logText = null;\n        if (check.log.logLevel == \"All\") {\n          logText = check.log.text;\n        } else {\n          logText = filterLog(check.log.text);\n        }\n\n        const totalLines = (logText.match(/\\n/g) || \"\").length + 1;\n        let existingEditor = null;\n        if (check.log.existingEditor) {\n          check.log.existingEditor.setValue(logText);\n          check.log.existingEditor.revealLine(totalLines);\n        }\n\n        log = (\n          <div\n            style={{\n              marginBottom: \"20px\",\n            }}\n          >\n            <div className=\"hideRadio\">\n              <span>Log Level: </span>\n              <div style={{ display: \"inline\" }}>\n                <ButtonGroup>\n                  {radios.map((radio, idx) => (\n                    <ToggleButton\n                      key={idx}\n                      id={`radio-${idx}`}\n                      type=\"radio\"\n                      variant=\"outline-info\"\n                      name=\"radio\"\n                      value={radio}\n                      checked={check.log.logLevel === radio}\n                      onChange={(e) => {\n                        check.log.logLevel = radio;\n                        this.setState(this.state);\n                      }}\n                    >\n                      {radio}\n                    </ToggleButton>\n                  ))}\n                </ButtonGroup>\n              </div>\n            </div>\n            <Editor\n              height=\"80vh\"\n              defaultLanguage=\"logText\"\n              defaultValue={logText}\n              theme=\"logTheme\"\n              beforeMount={(monaco) => {\n                const groupRanges = this.getGroupRanges(monaco, logText);\n                registerLogLanguage(monaco, groupRanges);\n              }}\n              options={{\n                scrollBeyondLastLine: false,\n                lineNumbersMinChars: totalLines.toString().length + 1,\n                folding: true,\n              }}\n              onMount={(editor, monaco) => {\n                check.log.existingEditor = editor;\n                let foldAction = editor.getAction(\"editor.foldAll\");\n                foldAction.run().then(() => {\n                  editor.revealLine(totalLines);\n                });\n              }}\n              loading={<p>Loading viewer...</p>}\n            />\n          </div>\n        );\n      } else {\n        log = <p>Fetching logs...</p>;\n      }\n    }\n    return [log, isShowing];\n  }\n\n  getArtifactName(checkName) {\n    return (\n      checkName\n        .replace(\"(\", \"\")\n        .replace(\")\", \"\")\n        .replace(\"test \", \"test-reports-test-\")\n        .replaceAll(\", \", \"-\") + \".zip\"\n    );\n  }\n\n  renderChecks(checkRuns, s3Artifacts) {\n    const checks = [];\n    const testResultArtifacts = {};\n    if (!s3Artifacts) {\n      s3Artifacts = [];\n    }\n    let artifactsByName = {};\n    for (const artifact of s3Artifacts) {\n      let prefix = artifact.Key[\"#text\"];\n      let name = prefix.split(\"/\").slice(-1)[0];\n      artifactsByName[name] = artifact;\n    }\n\n    for (const [index, check] of checkRuns.entries()) {\n      // Show the log viewer + toggle chevron\n      const toggle = () => {\n        check.log.shown = !check.log.shown;\n        this.setState(this.state);\n      };\n      const [log, isShowing] = this.renderLogViewer(check);\n      const iconStyle = { cursor: \"pointer\" };\n      let icon = <BsFillCaretRightFill style={iconStyle} onClick={toggle} />;\n      if (isShowing) {\n        icon = <BsFillCaretDownFill style={iconStyle} onClick={toggle} />;\n      }\n\n      // Determine the check's status and turn that into an icon\n      const statuses = {\n        SUCCESS: <GoCheck style={{ color: \"#22863a\" }} />,\n        FAILURE: <GoX style={{ color: \"#cb2431\" }} />,\n        NEUTRAL: <GoCircleSlash style={{ color: \"#959da5\" }} />,\n        CANCELLED: <GoCircleSlash style={{ color: \"rgb(255 86 86)\" }} />,\n      };\n      let statusIcon = statuses[check.conclusion] || (\n        <GoPrimitiveDot style={{ color: \"#dbab09\" }} />\n      );\n\n      let renderResultsButton = null;\n      let artifactDetails = null;\n      let artifactName = this.getArtifactName(check.name);\n      if (artifactsByName[artifactName]) {\n        const artifact = artifactsByName[artifactName];\n        const size = formatBytes(parseInt(artifact.Size[\"#text\"]));\n        renderResultsButton = (\n          <button\n            style={{ marginLeft: \"5px\", fontSize: \"0.7em\", fontWeight: \"bold\" }}\n            className=\"btn btn-info\"\n            onClick={async () => {\n              // showReport might be undefined the first time so explicitly\n              // spell it out here to avoid any falsiness\n              if (artifact.showReport) {\n                artifact.showReport = false;\n              } else {\n                artifact.showReport = true;\n              }\n              this.setState(this.state);\n              this.render();\n            }}\n          >\n            {artifact.showReport ? \"Hide\" : `Tests (${size})`}\n          </button>\n        );\n        testResultArtifacts[artifact.Key[\"#text\"]] = true;\n\n        if (artifact.showReport) {\n          const key = `s3-${check.name}-${artifactName}`;\n          let prefix = artifact.Key[\"#text\"];\n          let url = `https://gha-artifacts.s3.amazonaws.com/${prefix}`;\n          artifactDetails = (\n            <TestReportRenderer testReportZip={url} key={key} />\n          );\n        }\n      }\n      checks.push({\n        data: check,\n        element: (\n          <div style={{ marginBottom: \"2px\" }} key={\"check-run-\" + index}>\n            {statusIcon} <a href={check.detailsUrl}>{check.name}</a> {icon}{\" \"}\n            {log}\n            {renderResultsButton}\n            {artifactDetails}\n          </div>\n        ),\n      });\n    }\n    return [checks, testResultArtifacts];\n  }\n\n  renderArtifact(args) {\n    if (args.expired) {\n      return (\n        <div key={`${args.kind}-${args.index}`}>\n          <span>\n            [{args.kind}] {args.name}\n          </span>{\" \"}\n          <span>({formatBytes(args.size_in_bytes)}) (expired)</span>\n        </div>\n      );\n    } else {\n      return (\n        <div key={`${args.kind}-${args.index}`}>\n          <a href={args.url}>\n            [{args.kind}] {args.name}\n          </a>{\" \"}\n          <span>({formatBytes(args.size_in_bytes)})</span>\n          {args.extra}\n        </div>\n      );\n    }\n  }\n\n  renderGitHubArtifacts(run) {\n    let reportUrl = null;\n    let artifacts = [];\n    for (const [index, artifact] of run.artifacts.artifacts.entries()) {\n      // The URL in the response is for the API, not browsers, so make it\n      // manually\n      let url = `https://github.com/${this.props.user}/${this.props.repo}/suites/${run.databaseId}/artifacts/${artifact.id}`;\n      if (artifact.name.startsWith(\"test-reports-\")) {\n        continue;\n      }\n      artifacts.push(\n        this.renderArtifact({\n          kind: \"gha\",\n          index: index,\n          name: artifact.name,\n          size_in_bytes: artifact.size_in_bytes,\n          url: url,\n          expired: artifact.expired,\n        })\n      );\n    }\n    return artifacts;\n  }\n\n  renderS3Artifacts(run, testResultArtifacts) {\n    let artifacts = [];\n    if (run.s3_artifacts) {\n      for (const [index, artifact] of run.s3_artifacts.entries()) {\n        if (testResultArtifacts[artifact.Key[\"#text\"]]) {\n          // Already shown inline with a step, so don't show it again\n          continue;\n        }\n        let prefix = artifact.Key[\"#text\"];\n        let name = prefix.split(\"/\").slice(-1)[0];\n        let url = `https://gha-artifacts.s3.amazonaws.com/${prefix}`;\n\n        artifacts.push(\n          this.renderArtifact({\n            kind: \"s3\",\n            index: index,\n            name: prefix.split(\"/\").slice(-1),\n            size_in_bytes: parseInt(artifact.Size[\"#text\"]),\n            url: url,\n            expired: false,\n          })\n        );\n      }\n    }\n    return artifacts;\n  }\n\n  mergeStatuses(statuses) {\n    if (statuses.length == 0) {\n      return \"SKIPPED\";\n    }\n    const counts = {\n      FAILURE: 0,\n      NEUTRAL: 0,\n      CANCELLED: 0,\n      SUCCESS: 0,\n    };\n    for (const status of statuses) {\n      counts[status] += 1;\n    }\n    if (counts.FAILURE > 0) {\n      return \"FAILURE\";\n    }\n    if (counts.NEUTRAL + counts.CANCELLED === statuses.length) {\n      return \"SKIPPED\";\n    }\n    if (counts.SUCCESS === statuses.length) {\n      return \"SUCCESS\";\n    }\n    if (counts.NEUTRAL === statuses.length) {\n      return \"SKIPPED\";\n    }\n    return \"PENDING\";\n  }\n\n  renderGroups(groups) {\n    let cards = [];\n    for (const [title, data] of Object.entries(groups)) {\n      if (!data.show) {\n        continue;\n      }\n      let isExpanded = this.state.showGroups.includes(title);\n      const toggleGroup = () => {\n        if (this.state.showGroups.includes(title)) {\n          this.state.showGroups.pop(this.state.showGroups.indexOf(title));\n        } else {\n          this.state.showGroups.push(title);\n        }\n        this.setState(this.state);\n      };\n\n      let icon = (\n        <BsFillCaretRightFill\n          style={{ cursor: \"pointer\" }}\n          onClick={toggleGroup}\n        />\n      );\n      let items = [];\n      if (isExpanded) {\n        icon = (\n          <BsFillCaretDownFill\n            style={{ cursor: \"pointer\" }}\n            onClick={toggleGroup}\n          />\n        );\n        items = data.items;\n      }\n      let card = (\n        <Card key={\"group-card-\" + title}>\n          <Card.Body>\n            <Card.Title>\n              {title} {icon}\n            </Card.Title>\n            {items}\n          </Card.Body>\n        </Card>\n      );\n      cards.push({ data: { status: \"GROUP\" }, element: card });\n    }\n    return cards;\n  }\n\n  render() {\n    let runs = [];\n    let groups = {\n      \"Add annotations\": {},\n      \"Close stale pull requests\": {},\n      \"Label PRs & Issues\": {},\n      Triage: {},\n      \"Update S3 HTML indices for download.pytorch.org\": {},\n    };\n    Object.entries(groups).forEach((x) => {\n      x[1].show = false;\n      x[1].items = [];\n    });\n\n    if (this.state.runs) {\n      // Render all of the check runs as a list\n\n      for (const [run_index, run] of this.state.runs.entries()) {\n        const [checksData, testResultArtifacts] = this.renderChecks(\n          run.checkRuns.nodes,\n          run.s3_artifacts\n        );\n        const checks = checksData.map((x) => x.element);\n\n        let artifacts = [];\n\n        // List out artifacts hosted on GitHub\n        if (run.artifacts) {\n          if (run.artifacts.artifacts !== undefined) {\n            artifacts = artifacts.concat(this.renderGitHubArtifacts(run));\n          } else {\n            artifacts.push(\n              <div key={`artifact-${run.databaseId}`}>\n                <span>Can't query artifacts (hit GitHub rate limit)</span>\n              </div>\n            );\n          }\n        }\n\n        // List out artifacts from s3\n        artifacts = artifacts.concat(\n          this.renderS3Artifacts(run, testResultArtifacts)\n        );\n\n        // If there were any artifacts, set up the 'div' to show them\n        let artifactsElement = <div></div>;\n        if (artifacts.length > 0) {\n          artifactsElement = (\n            <div style={{ padding: \"6px\" }}>\n              <h5>Artifacts</h5>\n              {artifacts}\n            </div>\n          );\n        }\n\n        let checksElement = <div></div>;\n        if (checks.length > 0) {\n          checksElement = <div style={{ padding: \"6px\" }}>{checks}</div>;\n        }\n\n        // Wrap up everything in a card\n        const title = run.workflowRun.workflow.name;\n        const card = (\n          <Card key={\"card-\" + run_index}>\n            <Card.Body\n              style={{\n                backgroundColor:\n                  run.status === \"FAILURE\" ? \"rgb(255 243 243)\" : null,\n              }}\n            >\n              <Card.Title>\n                <a href={run.workflowRun.url}>{title}</a>\n              </Card.Title>\n              <div>\n                {checksElement}\n                {artifactsElement}\n              </div>\n            </Card.Body>\n          </Card>\n        );\n\n        function pushGroupCard(icon, itemCard) {\n          groups[title].push(card);\n          if (groups[title].length === 1) {\n            // If this is the first instance of this group, add the header\n            const groupCard = (\n              <Card key={\"group-card-\" + run_index}>\n                <Card.Body>\n                  <Card.Title>\n                    {title} {icon}\n                  </Card.Title>\n                </Card.Body>\n              </Card>\n            );\n            runs.push({\n              data: { status: \"GROUP\" },\n              element: groupCard,\n            });\n          }\n          if (itemCard) {\n          }\n        }\n\n        // Some jobs are uninteresting and there are a bunch of them, so group\n        // them all together here\n        if (title in groups) {\n          groups[title].show = true;\n          if (this.state.showGroups.includes(title)) {\n            groups[title].show = true;\n            groups[title].items.push(card);\n          }\n        } else {\n          // A normal job, show it without any extras\n          runs.push({ data: run, element: card });\n        }\n      }\n    }\n\n    // Groups are all stored in the 'groups' map, so add them to the list of runs\n    // as cards\n    runs = runs.concat(this.renderGroups(groups));\n\n    let loading = null;\n    if (this.state.error_message) {\n      loading = <p style={{ color: \"red\" }}> {this.state.error_message}</p>;\n    } else if (!this.state.commit) {\n      loading = <p>Loading... (make sure you are signed in)</p>;\n    }\n\n    if (this.state.statuses) {\n      for (const status of this.state.statuses) {\n        if (!status.targetUrl.includes(\"https://circleci.com\")) {\n          continue;\n        }\n        runs.push({\n          data: {\n            status: status.state,\n          },\n          element: <CircleCICard key={status.context} status={status} />,\n        });\n      }\n    }\n\n    let displayRuns = [];\n    function add(type) {\n      for (const run of runs) {\n        if (run.data.status === type) {\n          run.used = true;\n          displayRuns.push(\n            <div key={run.data.databaseId} style={{ marginBottom: \"4px\" }}>\n              {run.element}\n            </div>\n          );\n        }\n      }\n    }\n    add(\"FAILURE\");\n    add(\"PENDING\");\n    add(\"SUCCESS\");\n    add(\"GROUP\");\n    add(\"SKIPPED\");\n\n    for (const run of runs) {\n      if (!run.used) {\n        console.error(\"Unused run with state\", run.data.status);\n      }\n    }\n\n    if (this.state.runs && displayRuns.length == 0) {\n      displayRuns = <p style={{ fontWeight: \"bold\" }}>No jobs found</p>;\n    }\n\n    return (\n      <div>\n        {this.renderTitle()}\n        {this.renderDiff()}\n        {this.renderBody()}\n        {loading}\n\n        {this.renderDocPreviewButton()}\n        <div>{displayRuns}</div>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport \"@toast-ui/chart/dist/toastui-chart.css\";\nimport Chart from \"@toast-ui/chart\";\n\nexport default class JobCorrelationHeatmap extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    this.update();\n  }\n\n  correlateJobs(all_jobs) {\n    let passes = [\"success\", \"skipped\", \"pending\", \"queued\"];\n    const seen_names = {};\n    const correlationMatrix = {};\n\n    const addFailure = (failure1, failure2) => {\n      seen_names[failure1] = true;\n      seen_names[failure2] = true;\n      if (!correlationMatrix[failure1]) {\n        correlationMatrix[failure1] = [];\n      }\n      if (!correlationMatrix[failure1][failure2]) {\n        correlationMatrix[failure1][failure2] = 0;\n      }\n      correlationMatrix[failure1][failure2] += 1;\n    };\n\n    for (const jobs of all_jobs) {\n      let failures = [];\n      for (const job_name in jobs.value) {\n        const job = jobs.value[job_name];\n        if (job.status && passes.indexOf(job.status) === -1) {\n          failures.push(job_name);\n        }\n      }\n\n      for (const failure1 of failures) {\n        for (const failure2 of failures) {\n          addFailure(failure1, failure2);\n        }\n      }\n    }\n\n    const job_names = Object.keys(seen_names).sort();\n\n    const fullMatrix = [];\n    for (const name1 of job_names) {\n      const row = [];\n      for (const name2 of job_names) {\n        if (correlationMatrix[name1] && correlationMatrix[name1][name2]) {\n          row.push(correlationMatrix[name1][name2]);\n        } else {\n          row.push(0);\n        }\n      }\n      fullMatrix.push(row);\n    }\n\n    return [job_names, fullMatrix];\n  }\n\n  async update() {\n    const base = \"https://ossci-job-status.s3.amazonaws.com/master\";\n    const data = {\n      job_index: JSON.parse(\n        await fetch(`${base}/index.json`, { cache: \"no-cache\" }).then((a) =>\n          a.text()\n        )\n      ),\n    };\n    const promises = data.job_index.map((job) => {\n      return fetch(`${base}/${job.id}.json`).then((r) => r.json());\n    });\n    this.state.correlations = this.correlateJobs(\n      await Promise.allSettled(promises)\n    );\n    this.setState(data);\n  }\n\n  tooltipTemplate(model, defaultTooltipTemplate, theme) {\n    const { background } = theme;\n    let [a, b] = model.data[0].label.split(\", \");\n    return `\n        <div\n        style=\"\n    background: ${background};\n    padding: 0 5px;\n    text-align: center;\n    color: white;\">\n        <div\n        class=\"toastui-chart-tooltip-category\"\n        style=\"font-weight: bold; font-family: Arial, sans-serif; font-size: 13px; color: #ffffff;\">\n            ${a}\n            <br />\n            ${b}\n        </div>\n        <div\n        class=\"toastui-chart-tooltip-series-wrapper\"\n        style=\"font-weight: normal; font-family: Arial, sans-serif; font-size: 12px; color: #ffffff;\">\n            <div class=\"toastui-chart-tooltip-series\">\n                <span class=\"toastui-chart-series-name\">\n                <i class=\"toastui-chart-icon\" style=\"background: ${model.data[0].color}\"></i>\n                <span class=\"toastui-chart-name\">${model.data[0].value}</span>\n                </span>\n            </div>\n        </div>\n    </div>\n    `;\n  }\n\n  componentDidUpdate() {\n    if (!this.state.correlations) {\n      return;\n    }\n\n    const el = document.getElementById(\"job-correlations\");\n    let [job_names, correlationMatrix] = this.state.correlations;\n    el.innerHTML = \"\";\n    const options = {\n      usageStatistics: false,\n      xAxis: {\n        label: {\n          formatter: (a, b) => \"\",\n        },\n      },\n      yAxis: {\n        label: {\n          formatter: (a, b) => \"\",\n        },\n      },\n      tooltip: {\n        template: this.tooltipTemplate,\n      },\n    };\n    let data = {\n      categories: {\n        x: job_names,\n        y: job_names,\n      },\n      series: correlationMatrix,\n    };\n    Chart.heatmapChart({ el, data, options });\n  }\n\n  render() {\n    return (\n      <div>\n        <h2>CI Job Correlations</h2>\n        <div\n          id=\"job-correlations\"\n          style={{ width: \"550px\", height: \"550px\" }}\n        ></div>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport \"@toast-ui/chart/dist/toastui-chart.css\";\nimport Chart from \"@toast-ui/chart\";\n\nexport default class GitHubActionsDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n  componentDidMount() {\n    this.update();\n  }\n  async update() {\n    const data = {\n      actions_statuses: JSON.parse(\n        await fetch(\n          \"https://ossci-checks-status.s3.amazonaws.com/status.json\",\n          { cache: \"no-cache\" }\n        ).then((a) => a.text())\n      ),\n    };\n    this.setState(data);\n  }\n\n  componentDidUpdate() {\n    if (!this.state.actions_statuses) {\n      return;\n    }\n    const series = {\n      dates: [],\n    };\n    let keys = [\"in_progress\", \"queued\", \"pending\"];\n    for (const key of keys) {\n      series[key] = [];\n    }\n    this.state.actions_statuses.sort((a, b) => {\n      return a.last_updated - b.last_updated;\n    });\n    for (const item of this.state.actions_statuses) {\n      series.dates.push(new Date(item.last_updated * 1000).toLocaleString());\n      for (const key of keys) {\n        series[key].push(item[key] || 0);\n      }\n    }\n    const data_series = [];\n    for (const key of keys) {\n      data_series.push({\n        name: key,\n        data: series[key],\n      });\n    }\n    const data = {\n      categories: series.dates,\n      series: data_series,\n    };\n\n    const el = document.getElementById(\"chart\");\n    el.innerHTML = \"\";\n    const options = {};\n    Chart.lineChart({ el, data, options });\n  }\n\n  render() {\n    return (\n      <div>\n        <h2>GitHub Actions Status</h2>\n        <div id=\"chart\" style={{ width: \"600px\", height: \"400px\" }}></div>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component } from \"react\";\nimport { s3 } from \"./utils.js\";\nimport Card from \"react-bootstrap/Card\";\nimport { BsFillQuestionCircleFill } from \"react-icons/all\";\nimport Tooltip from \"rc-tooltip\";\n\nconst COLORS = {\n  green: \"#58c157\",\n  yellow: \"#e2b325\",\n  red: \"#ff0504\",\n  grey: \"#a3a3a3\",\n  blank: \"rgba(0, 0, 0, 0)\",\n};\n\nclass BranchDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n    };\n    this.canvas = React.createRef();\n  }\n\n  componentDidMount() {\n    this.update();\n  }\n\n  componentDidUpdate() {\n    const ref = this.canvas.current;\n    /** @type {CanvasRenderingContext2D} */\n    const ctx = ref.getContext(\"2d\");\n    ctx.beginPath();\n    const colors = {\n      success: COLORS.green,\n      failure: COLORS.red,\n      error: COLORS.red,\n      neutral: COLORS.grey,\n      cancelled: COLORS.red,\n      pending: COLORS.yellow,\n      queued: COLORS.yellow,\n      unknown: COLORS.blank,\n    };\n    for (const [x, statuses] of this.state.statuses.entries()) {\n      for (const [y, status] of statuses.entries()) {\n        const fill = colors[status];\n        if (!fill) {\n          console.error(\"Unknown\", status);\n        }\n        ctx.fillStyle = fill;\n        ctx.fillRect(y, x, 1, 1);\n      }\n    }\n  }\n\n  async update() {\n    const url = `https://s3.amazonaws.com/ossci-job-status/v5/${this.props.user}/${this.props.repo}/${this.props.json}`;\n    const resp = await fetch(url);\n    const data = await resp.json();\n    let jobNames = {};\n    let byName = [];\n    for (const commit of data) {\n      let jobsByName = {};\n      for (const job of commit.jobs) {\n        jobNames[job.name] = true;\n        jobsByName[job.name] = job;\n      }\n      byName.push(jobsByName);\n    }\n    jobNames = Object.keys(jobNames);\n    jobNames.sort();\n    let statuses = [];\n    for (const commit of byName) {\n      let commitStatuses = [];\n      for (const jobName of jobNames) {\n        let status = \"unknown\";\n        if (commit[jobName]) {\n          status = commit[jobName].status;\n        }\n        commitStatuses.push(status);\n      }\n      statuses.push(commitStatuses);\n    }\n    this.setState({ statuses: statuses });\n  }\n\n  render() {\n    let canvas = null;\n    if (this.state.statuses && this.state.statuses.length > 0) {\n      canvas = (\n        <canvas\n          height=\"100\"\n          width={this.state.statuses[0].length}\n          ref={this.canvas}\n        ></canvas>\n      );\n    }\n    return (\n      <div\n        style={{\n          border: \"1px solid #d2d2d2\",\n          borderRadius: \"5px\",\n          padding: \"10px\",\n          margin: \"5px\",\n          display: \"grid\",\n          gridTemplateRows: \"3em auto\",\n          textAlign: \"center\",\n        }}\n      >\n        <span>\n          <a href={`https://github.com/${this.props.user}/${this.props.repo}`}>\n            {this.props.user}/{this.props.repo}\n          </a>\n          <a\n            style={{ marginLeft: \"5px\" }}\n            href={`/ci/${this.props.user}/${this.props.repo}/${this.props.branch}`}\n          >\n            {this.props.branch}\n          </a>\n        </span>\n        <div>\n          <a\n            href={`/ci/${this.props.user}/${this.props.repo}/${this.props.branch}`}\n          >\n            {canvas}\n          </a>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default class GitHubOverview extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n    };\n  }\n\n  componentDidMount() {\n    this.update();\n  }\n\n  async s3ListBucket(prefix) {\n    let result = await s3(prefix, \"ossci-job-status\");\n    let items = [];\n    if (result.ListBucketResult.CommonPrefixes) {\n      let folders = result.ListBucketResult.CommonPrefixes;\n      if (Array.isArray(folders)) {\n        items = items.concat(folders.map((item) => item.Prefix.textContent));\n      } else {\n        items.push(folders.Prefix.textContent);\n      }\n    }\n    if (result.ListBucketResult.Contents) {\n      let files = result.ListBucketResult.Contents;\n      if (Array.isArray(files)) {\n        items = items.concat(files.map((item) => item.Key.textContent));\n      } else {\n        // Only 1 item in the folder\n        items.push(files.Key.textContent);\n      }\n    }\n    return items;\n  }\n\n  async update() {\n    // List users with a folder\n    const users = await this.s3ListBucket(\"v5/\");\n    const promises = users.map((user) => {\n      return (async () => {\n        const prefixes = await this.s3ListBucket(user);\n        // List repos in a folder\n        return await Promise.all(\n          prefixes.map((repo) => this.s3ListBucket(repo))\n        );\n      })();\n    });\n    let repos = await Promise.all(promises);\n    this.setState({ repos: repos.flat() });\n  }\n\n  render() {\n    let cards = [];\n    let branches = [];\n    for (const repo of this.state.repos) {\n      const match = repo[0].match(/v5\\/(.*)\\/(.*)\\//);\n      const user = match[1];\n      const repoName = match[2];\n      for (const branch of repo) {\n        const branchMatch = branch.match(/v5\\/.*\\/.*\\/(.*)/);\n        const branchName = branchMatch[1]\n          .replace(\"_\", \"/\")\n          .replace(\".json\", \"\");\n        branches.push(\n          <BranchDisplay\n            key={`branch-${repoName}-${branchName}`}\n            user={user}\n            repo={repoName}\n            branch={branchName}\n            json={branchMatch[1]}\n          />\n        );\n      }\n    }\n    return (\n      <div>\n        <h4>PyTorch Org CI Overview</h4>\n        <p>\n          Status roll up for PyTorch and domain libraries{\" \"}\n          <Tooltip\n            key=\"help\"\n            overlay=\"Each CI job for each branch in each repo corresponds to 1 pixel in the visualizations below\"\n            mouseLeaveDelay={0}\n            placement=\"rightTop\"\n            destroyTooltipOnHide={{ keepParent: false }}\n          >\n            <span style={{ color: \"#a1a1a1\", cursor: \"pointer\" }}>\n              <BsFillQuestionCircleFill />\n            </span>\n          </Tooltip>\n        </p>\n        <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>{branches}</div>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport { Component } from \"react\";\nimport AuthorizeGitHub from \"./AuthorizeGitHub.js\";\n\nimport { github } from \"./utils.js\";\n\nfunction getIssuesQuery() {\n  return `\n      {\n        search(type:ISSUE,first:100,query:\"is:open is:issue label:\\\\\\\"ci: sev\\\\\\\"\") {\n          nodes {\n            ... on Issue {\n              number\n              title\n              body\n              url\n            }\n          }\n        }\n      }\n    `;\n}\n\nexport default class PrDisplay extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      sevs: [],\n    };\n  }\n\n  componentDidMount() {\n    this.update();\n  }\n\n  async update() {\n    if (!localStorage.getItem(\"gh_pat\")) {\n      // Not logged in, can't search GitHub\n      // TODO: Show login option\n      console.log(\"not logged in, can't fetch sevs\");\n      return;\n    }\n    const response = await github.graphql_raw(getIssuesQuery());\n    if (response.errors) {\n      console.error(\"failed to fetch sevs\");\n      console.error(response);\n      return;\n    }\n    this.state.sevs = response.data.search.nodes;\n\n    this.setState(this.state);\n  }\n\n  renderSev(issue) {\n    return (\n      <div className=\"sevbox\">\n        <a href=\"https://github.com/pytorch/pytorch/wiki/%5BWIP%5D-What-is-a-SEV\">\n          SEV:\n        </a>{\" \"}\n        {issue.title} (<a href={issue.url}>#{issue.number}</a>)\n      </div>\n    );\n  }\n\n  render() {\n    if (!window.location.href.includes(\"pytorch/pytorch\")) {\n      return null;\n    }\n    const existingSevs = this.state.sevs;\n    const renderedSevs = [];\n    for (const [index, sev] of existingSevs.entries()) {\n      renderedSevs.push(<div key={`sev-${index}`}>{this.renderSev(sev)}</div>);\n    }\n\n    return <div>{renderedSevs}</div>;\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Component, Fragment } from \"react\";\nimport { AiFillGithub } from \"react-icons/ai\";\nimport { BiHelpCircle } from \"react-icons/bi\";\nimport { Link } from \"react-router-dom\";\nimport AuthorizeGitHub from \"./AuthorizeGitHub\";\n\nconst AUTH_SERVER = \"https://auth.pytorch.org\";\n\nexport default class Links extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showMore: false,\n    };\n  }\n\n  render() {\n    let more = null;\n    if (this.state.showMore) {\n      more = (\n        <div>\n          <ul className=\"menu\">\n            <li>Libraries:</li>\n            <li>\n              <Link to=\"/ci/pytorch/audio/main\">audio</Link>\n            </li>\n            <li>\n              <Link to=\"/ci/pytorch/vision/main\">vision</Link>\n            </li>\n            <li>\n              <Link to=\"/ci/pytorch/text/main\">text</Link>\n            </li>\n            <li>\n              <Link to=\"/torchbench-v0-nightly\">torchbench</Link>\n            </li>\n            <li>\n              <Link to=\"/ci/PyTorchLightning/pytorch-lightning/master\">\n                pytorch-lightning\n              </Link>\n            </li>\n          </ul>\n          <ul className=\"deprecated-menu\">\n            <li>Old-style:</li>\n            {[\n              \"pytorch\",\n              // \"tensorcomp\",\n              // \"translate\",\n              \"rocm-pytorch\",\n            ].map((e) => (\n              <Fragment key={e}>\n                {[\"master\", \"pull-request\"].map((trigger) => (\n                  <li key={e + \"-\" + trigger}>\n                    <Link to={\"/build1/\" + e + \"-\" + trigger}>\n                      {e}-{trigger}\n                    </Link>\n                    &nbsp; (\n                    <Link to={\"/build1/\" + e + \"-\" + trigger + \"?mode=perf\"}>\n                      perf\n                    </Link>\n                    /\n                    <Link to={\"/build1/\" + e + \"-\" + trigger + \"?mode=cost\"}>\n                      cost\n                    </Link>\n                    {e === \"pytorch\" && trigger === \"master\" ? (\n                      <Fragment>\n                        /\n                        <Link\n                          to={\"/build1/\" + e + \"-\" + trigger + \"?mode=binary\"}\n                        >\n                          binary\n                        </Link>\n                      </Fragment>\n                    ) : (\n                      <Fragment />\n                    )}\n                    )\n                  </li>\n                ))}\n              </Fragment>\n            ))}\n            <Fragment key=\"nightlies-uploaded\">\n              <li>\n                <Link to={\"/build1/nightlies-uploaded\"}>\n                  nightlies-uploaded\n                </Link>\n              </li>\n            </Fragment>\n          </ul>\n          <ul className=\"menu\">\n            <li>\n              <Link to=\"/status\">status</Link>\n            </li>\n          </ul>\n        </div>\n      );\n    }\n    return (\n      <div className=\"links-container\">\n        <div className=\"Links\">\n          <div style={{ display: \"inline\" }}>\n            <a style={{ fontWeight: \"bold\" }} href=\"https://hud.pytorch.org\">\n              PyTorch CI HUD\n            </a>\n            <ul style={{ display: \"inline\" }} className=\"menu\">\n              {[\"pytorch\"].map((e) => (\n                <Fragment key={e}>\n                  {[\"master\", \"viable/strict\", \"nightly\", \"release/1.10\"].map(\n                    (branch) => (\n                      <li key={`${branch}`}>\n                        <Link to={`/ci/pytorch/pytorch/${branch}`}>\n                          {branch}\n                        </Link>\n                      </li>\n                    )\n                  )}\n                </Fragment>\n              ))}\n              <li>\n                <a href=\"https://metrics.pytorch.org\">metrics</a>\n              </li>\n              <li>\n                <a href=\"/overview\">overview</a>\n              </li>\n              <li>\n                <a\n                  href=\"more\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    this.state.showMore = !this.state.showMore;\n                    this.setState(this.state);\n                    return false;\n                  }}\n                >\n                  {this.state.showMore ? \"less\" : \"more\"}\n                </a>\n              </li>\n            </ul>\n          </div>\n          <div\n            style={{\n              display: \"inline\",\n              marginLeft: \"auto\",\n              marginRight: \"0px\",\n            }}\n          >\n            <ul style={{ marginBottom: \"0\" }} className=\"menu\">\n              <li>\n                <a href=\"https://github.com/pytorch/pytorch/wiki/Using-hud.pytorch.org\">\n                  help\n                </a>\n              </li>\n              <li>\n                <a href=\"https://github.com/pytorch/ci-hud/issues/new?assignees=&labels=&template=feature_request.yaml&title=%5Bfeature%5D%3A+\">\n                  requests\n                </a>\n              </li>\n              <li>\n                <AuthorizeGitHub />\n              </li>\n              <li>\n                <a\n                  style={{ color: \"black\" }}\n                  href=\"https://github.com/pytorch/pytorch-ci-hud\"\n                >\n                  <AiFillGithub />\n                </a>\n              </li>\n            </ul>\n          </div>\n        </div>\n        {more}\n      </div>\n    );\n  }\n}\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React, { Fragment } from \"react\";\nimport \"./App.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport ComputerDisplay from \"./ComputerDisplay.js\";\nimport QueueDisplay from \"./QueueDisplay.js\";\nimport BuildHistoryDisplay from \"./BuildHistoryDisplay.js\";\nimport GitHubStatusDisplay from \"./GitHubStatusDisplay.js\";\nimport PerfHistoryDisplay from \"./PerfHistoryDisplay.js\";\nimport PrDisplay from \"./PrDisplay.js\";\nimport JobCorrelationHeatmap from \"./JobCorrelationHeatmap.js\";\nimport GitHubActionsDisplay from \"./GitHubActionsDisplay.js\";\nimport GitHubOverview from \"./GitHubOverview.js\";\nimport AuthorizeGitHub from \"./AuthorizeGitHub.js\";\nimport SevReporter from \"./SevReporter.js\";\nimport Links from \"./Links.js\";\nimport {\n  BrowserRouter as Router,\n  Route,\n  Link,\n  Redirect,\n  Switch,\n} from \"react-router-dom\";\n\nconst App = () => (\n  <Router basename={process.env.PUBLIC_URL + \"/\"}>\n    <div className=\"App\">\n      <Links />\n      <div style={{ margin: \"0\" }} className=\"container\">\n        <SevReporter />\n        <Switch>\n          <Route path=\"/build\" component={BuildRoute} />\n          <Route path=\"/build1\" component={Build1Route} />\n          <Route\n            path=\"/pytorch/pytorch/pull/:segment\"\n            render={(props) => {\n              return <Redirect to={`/pr/${props.match.params.segment}`} />;\n            }}\n          ></Route>\n          <Route\n            path=\"/pytorch/pytorch/pull/*/commits/:segment\"\n            render={(props) => {\n              return <Redirect to={`/commit/${props.match.params.segment}`} />;\n            }}\n          ></Route>\n          <Route\n            path=\"/pytorch/pytorch/commit/:segment\"\n            render={(props) => {\n              return <Redirect to={`/commit/${props.match.params.segment}`} />;\n            }}\n          ></Route>\n          <Route\n            path=\"/ci/:user/:repo/:branch+\"\n            render={(props) => {\n              const query = new URLSearchParams(window.location.search);\n              const params = props.match.params;\n              return (\n                <GitHubStatusDisplay\n                  interval={60000}\n                  repo={params.repo}\n                  user={params.user}\n                  branch={params.branch}\n                  jobNameFilter={query.get(\"name_filter\")}\n                />\n              );\n            }}\n          ></Route>\n          <Route\n            path=\"/overview\"\n            render={() => {\n              return <GitHubOverview />;\n            }}\n          />\n          <Route\n            path=\"/pr/:user/:repo/:number\"\n            render={(props) => {\n              const params = props.match.params;\n              return (\n                <PrDisplay\n                  pr_number={params.number}\n                  user={params.user}\n                  repo={params.repo}\n                />\n              );\n            }}\n          />\n          <Route\n            path=\"/pr/:number\"\n            render={(props) => {\n              return (\n                <Redirect\n                  to={`/pr/pytorch/pytorch/${props.match.params.number}`}\n                />\n              );\n            }}\n          />\n          <Route\n            path=\"/commit/:user/:repo/:commit\"\n            render={(props) => {\n              const params = props.match.params;\n              return (\n                <PrDisplay\n                  commit_hash={params.commit}\n                  user={params.user}\n                  repo={params.repo}\n                />\n              );\n            }}\n          />\n          <Route\n            path=\"/commit/:commit\"\n            render={(props) => {\n              return (\n                <Redirect\n                  to={`/commit/pytorch/pytorch/${props.match.params.commit}`}\n                />\n              );\n            }}\n          />\n          <Route\n            path=\"/build2/:segment\"\n            render={(props) => {\n              const branch = props.match.params.segment.replace(\"pytorch-\", \"\");\n              return <Redirect to={`/ci/pytorch/pytorch/${branch}`} />;\n            }}\n          />\n          <Route\n            path=\"/build3/:segment\"\n            render={(props) => {\n              const branch = props.match.params.segment.replace(\"pytorch-\", \"\");\n              return <Redirect to={`/ci/pytorch/pytorch/${branch}`} />;\n            }}\n          />\n          <Route path=\"/torchbench-v0-nightly\" component={TorchBenchRoute} />\n          <Route path=\"/github_logout\" component={LogoutGitHub} />\n          <Route path=\"/authorize_github\" component={AuthorizeGithubRoute} />\n          <Route path=\"/status\" component={Status} />\n          <Route exact path=\"/\">\n            <Redirect to=\"/build2/pytorch-master\" />\n          </Route>\n          <Route path=\"*\" exact={true} component={RouteNotFound} />\n        </Switch>\n      </div>\n    </div>\n  </Router>\n);\n\n//    <ul className=\"menu\">\n//      {[\n//       \"linux-trusty-py2.7-trigger\",\n//       \"linux-trusty-py2.7.9-trigger\",\n//       \"linux-trusty-py3.5-trigger\",\n//       \"linux-trusty-py3.6-gcc4.8-trigger\",\n//       \"linux-trusty-py3.6-gcc5.4-trigger\",\n//       \"linux-trusty-py3.6-gcc7.2-trigger\",\n//       \"linux-trusty-pynightly-trigger\",\n//       \"linux-xenial-cuda8-cudnn6-py3-trigger\",\n//       \"linux-xenial-cuda9-cudnn7-py2-trigger\",\n//       \"linux-xenial-cuda9-cudnn7-py3-trigger\",\n//       \"linux-xenial-py3-clang5-asan-trigger\",\n//       \"win-ws2016-cuda9-cudnn7-py3-trigger\",\n//      ].map((e) => <li key={e}><Link to={\"/build/pytorch-builds/job/pytorch-\" + e}>{e}</Link></li>)}\n//    </ul>\n\nconst Status = () => (\n  <div>\n    <GitHubActionsDisplay />\n    <JobCorrelationHeatmap />\n    <QueueDisplay interval={1000} />\n    <ComputerDisplay interval={1000} />\n  </div>\n);\n\nconst AuthorizeGithubRoute = () => {\n  return <AuthorizeGitHub />;\n};\n\nconst LogoutGitHub = () => {\n  localStorage.removeItem(\"gh_pat\");\n  console.log(\"logged out\");\n  return <Redirect to=\"/\"></Redirect>;\n};\n\nconst Build = ({ match }) => {\n  // Uhhh, am I really supposed to rob window.location here?\n  const query = new URLSearchParams(window.location.search);\n  return (\n    <BuildHistoryDisplay\n      interval={60000}\n      job={match.url.replace(/^\\/build\\//, \"\")}\n      mode={query.get(\"mode\")}\n    />\n  );\n};\n\nconst Build1 = ({ match }) => {\n  // Uhhh, am I really supposed to rob window.location here?\n  const query = new URLSearchParams(window.location.search);\n  return (\n    <BuildHistoryDisplay\n      interval={60000}\n      job={match.url.replace(/^\\/build1\\//, \"\")}\n      mode={query.get(\"mode\")}\n    />\n  );\n};\n\nconst Build2 = ({ match }) => {\n  // Uhhh, am I really supposed to rob window.location here?\n  const query = new URLSearchParams(window.location.search);\n  return (\n    <GitHubStatusDisplay\n      interval={60000}\n      job={match.url.replace(/^\\/build2\\//, \"\")}\n      mode={query.get(\"mode\")}\n      jobNameFilter={query.get(\"name_filter\")}\n    />\n  );\n};\n\nconst RouteNotFound = ({ match }) => {\n  return <p>Route not found: {match.url}</p>;\n};\n\nconst BuildRoute = ({ match }) => (\n  <Fragment>\n    <Route exact path={match.url} component={Build} />\n    <Route path={`${match.url}/:segment`} component={BuildRoute} />\n  </Fragment>\n);\n\nconst Build1Route = ({ match }) => (\n  <Fragment>\n    <Route exact path={match.url} component={Build1} />\n    <Route path={`${match.url}/:segment`} component={Build1Route} />\n  </Fragment>\n);\n\nconst Build2Route = ({ match }) => (\n  <Fragment>\n    <Route exact path={match.url} component={Build2} />\n    <Route path={`${match.url}/:segment`} component={Build2Route} />\n  </Fragment>\n);\n\nconst TorchBenchRoute = ({ match }) => (\n  <Fragment>\n    <Route exact path={match.url} component={PerfHistoryDisplay} />\n  </Fragment>\n);\n\nexport default App;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n//\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}